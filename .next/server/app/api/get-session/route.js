/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/get-session/route";
exports.ids = ["app/api/get-session/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_zainulaabaidin_Downloads_FinalProject_main_FinalProject_main_src_app_api_get_session_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/get-session/route.ts */ \"(rsc)/./src/app/api/get-session/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/get-session/route\",\n        pathname: \"/api/get-session\",\n        filename: \"route\",\n        bundlePath: \"app/api/get-session/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\zainulaabaidin\\\\Downloads\\\\FinalProject-main\\\\FinalProject-main\\\\src\\\\app\\\\api\\\\get-session\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_zainulaabaidin_Downloads_FinalProject_main_FinalProject_main_src_app_api_get_session_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZnZXQtc2Vzc2lvbiUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZ2V0LXNlc3Npb24lMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZnZXQtc2Vzc2lvbiUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUN6YWludWxhYWJhaWRpbiU1Q0Rvd25sb2FkcyU1Q0ZpbmFsUHJvamVjdC1tYWluJTVDRmluYWxQcm9qZWN0LW1haW4lNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3phaW51bGFhYmFpZGluJTVDRG93bmxvYWRzJTVDRmluYWxQcm9qZWN0LW1haW4lNUNGaW5hbFByb2plY3QtbWFpbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDZ0U7QUFDN0k7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXHphaW51bGFhYmFpZGluXFxcXERvd25sb2Fkc1xcXFxGaW5hbFByb2plY3QtbWFpblxcXFxGaW5hbFByb2plY3QtbWFpblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxnZXQtc2Vzc2lvblxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZ2V0LXNlc3Npb24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9nZXQtc2Vzc2lvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZ2V0LXNlc3Npb24vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFx6YWludWxhYWJhaWRpblxcXFxEb3dubG9hZHNcXFxcRmluYWxQcm9qZWN0LW1haW5cXFxcRmluYWxQcm9qZWN0LW1haW5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZ2V0LXNlc3Npb25cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/get-session/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/get-session/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/auth */ \"(rsc)/./src/utils/auth.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_try_catch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/try-catch */ \"(rsc)/./src/lib/try-catch.ts\");\n/* harmony import */ var _flags__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/flags */ \"(rsc)/./src/flags.ts\");\n\n\n\n\n// ====== GET: Return session + config ======\nasync function GET() {\n    const { data: session, error } = await (0,_lib_try_catch__WEBPACK_IMPORTED_MODULE_2__.tryCatch)((0,_utils_auth__WEBPACK_IMPORTED_MODULE_0__.getSessionFromCookie)());\n    const config = await (0,_flags__WEBPACK_IMPORTED_MODULE_3__.getConfig)();\n    const headers = new Headers();\n    headers.set(\"Cache-Control\", \"no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0\");\n    headers.set(\"Pragma\", \"no-cache\");\n    headers.set(\"Expires\", \"0\");\n    if (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            session: null,\n            config\n        }, {\n            headers\n        });\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n        session,\n        config\n    }, {\n        headers\n    });\n}\n// ====== POST: Generate Ad ======\nasync function POST(req) {\n    try {\n        const body = await req.json();\n        const { adType, prompt } = body;\n        if (!adType || ![\n            \"image\",\n            \"video\"\n        ].includes(adType)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                error: \"Invalid ad type\"\n            }, {\n                status: 400\n            });\n        }\n        // Example: Call Cloudflare Workers AI / LLaVA / custom model\n        if (adType === \"image\") {\n            console.log('CLOUDFLARE_API_TOKEN:', process.env.CLOUDFLARE_API_TOKEN ? 'Loaded' : 'Missing');\n            console.log('CLOUDFLARE_ACCOUNT_ID:', process.env.CLOUDFLARE_ACCOUNT_ID ? 'Loaded' : 'Missing');\n            const inputs = {\n                prompt: prompt || 'A beautiful landscape'\n            };\n            console.log('AI Inputs:', inputs);\n            const model = '@cf/stabilityai/stable-diffusion-xl-base-1.0';\n            const url = `https://api.cloudflare.com/client/v4/accounts/${process.env.CLOUDFLARE_ACCOUNT_ID}/ai/run/${model}`;\n            const cfRes = await fetch(url, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${process.env.CLOUDFLARE_API_TOKEN}`,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(inputs)\n            });\n            if (!cfRes.ok) {\n                const errText = await cfRes.text();\n                throw new Error(`Cloudflare AI HTTP error ${cfRes.status}: ${errText}`);\n            }\n            const contentType = cfRes.headers.get('content-type') || '';\n            if (contentType.startsWith('image/')) {\n                const arrayBuf = await cfRes.arrayBuffer();\n                // Convert to base64 to keep the API response JSON-friendly for the client\n                const base64 = Buffer.from(arrayBuf).toString('base64');\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                    image: base64,\n                    contentType\n                });\n            } else {\n                const response = await cfRes.json();\n                return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json(response);\n            }\n        } else {\n            // Video generation still uses a placeholder\n            const videoUrl = await generateVideoAd({\n                prompt\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n                success: true,\n                adUrl: videoUrl\n            });\n        }\n    } catch (error) {\n        console.error(\"Ad generation failed:\", error);\n        const errorMessage = error instanceof Error ? error.message : \"An unknown error occurred\";\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            success: false,\n            error: `Ad generation failed: ${errorMessage}`\n        }, {\n            status: 500\n        });\n    }\n}\n// Placeholder for video generation\nasync function generateVideoAd(data) {\n    console.log(\"Generating video ad with data:\", data);\n    return \"https://www.w3schools.com/html/mov_bbb.mp4\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzVDLE1BQU1DLFdBQVcsTUFBTUMsZ0JBQWdCO2dCQUFFakM7WUFBTztZQUNoRCxPQUFPaEIscURBQVlBLENBQUNXLElBQUksQ0FBQztnQkFBRXVDLFNBQVM7Z0JBQU1DLE9BQU9IO1lBQVM7UUFDNUQ7SUFDRixFQUFFLE9BQU8xQyxPQUFPO1FBQ2RhLFFBQVFiLEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE1BQU04QyxlQUFlOUMsaUJBQWlCOEIsUUFBUTlCLE1BQU0rQyxPQUFPLEdBQUc7UUFDOUQsT0FBT3JELHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7WUFBRXVDLFNBQVM7WUFBTzVDLE9BQU8sQ0FBQyxzQkFBc0IsRUFBRThDLGNBQWM7UUFBQyxHQUFHO1lBQUVsQyxRQUFRO1FBQUk7SUFDN0c7QUFDRjtBQUVBLG1DQUFtQztBQUNuQyxlQUFlK0IsZ0JBQWdCN0MsSUFBNEI7SUFDekRlLFFBQVFDLEdBQUcsQ0FBQyxrQ0FBa0NoQjtJQUM5QyxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXGFwcFxcYXBpXFxnZXQtc2Vzc2lvblxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2Vzc2lvbkZyb21Db29raWUgfSBmcm9tIFwiQC91dGlscy9hdXRoXCI7XG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHRyeUNhdGNoIH0gZnJvbSBcIkAvbGliL3RyeS1jYXRjaFwiO1xuaW1wb3J0IHsgZ2V0Q29uZmlnIH0gZnJvbSBcIkAvZmxhZ3NcIjtcblxuXG50eXBlIEFkUmVxdWVzdEJvZHkgPSB7XG4gIGFkVHlwZTogXCJpbWFnZVwiIHwgXCJ2aWRlb1wiO1xuICBwcm9tcHQ/OiBzdHJpbmc7XG4gIHNsb2dhbj86IHN0cmluZztcbiAgd2Vic2l0ZT86IHN0cmluZztcbiAgc29jaWFscz86IHtcbiAgICBpbnN0YWdyYW0/OiBzdHJpbmc7XG4gICAgZmFjZWJvb2s/OiBzdHJpbmc7XG4gICAgdHdpdHRlcj86IHN0cmluZztcbiAgfTtcbiAgLy8gRmlsZSBjYW5ub3QgYmUgc2VudCB2aWEgSlNPTjsgdXNlIGFuIHVwbG9hZCBlbmRwb2ludC4gS2VlcCBwbGFjZWhvbGRlciBhcyB1bmtub3dufG51bGwuXG4gIGxvZ29GaWxlPzogdW5rbm93biB8IG51bGw7XG4gIGdlbmVyYXRlTWlzc2luZ0Fzc2V0czogYm9vbGVhbjtcbn07XG5cbi8vID09PT09PSBHRVQ6IFJldHVybiBzZXNzaW9uICsgY29uZmlnID09PT09PVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpOiBQcm9taXNlPE5leHRSZXNwb25zZT4ge1xuICBjb25zdCB7IGRhdGE6IHNlc3Npb24sIGVycm9yIH0gPSBhd2FpdCB0cnlDYXRjaChnZXRTZXNzaW9uRnJvbUNvb2tpZSgpKTtcbiAgY29uc3QgY29uZmlnID0gYXdhaXQgZ2V0Q29uZmlnKCk7XG5cbiAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gIGhlYWRlcnMuc2V0KFwiQ2FjaGUtQ29udHJvbFwiLCBcIm5vLXN0b3JlLCBuby1jYWNoZSwgbXVzdC1yZXZhbGlkYXRlLCBwcm94eS1yZXZhbGlkYXRlLCBtYXgtYWdlPTBcIik7XG4gIGhlYWRlcnMuc2V0KFwiUHJhZ21hXCIsIFwibm8tY2FjaGVcIik7XG4gIGhlYWRlcnMuc2V0KFwiRXhwaXJlc1wiLCBcIjBcIik7XG5cbiAgaWYgKGVycm9yKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc2Vzc2lvbjogbnVsbCwgY29uZmlnIH0sIHsgaGVhZGVycyB9KTtcbiAgfVxuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHNlc3Npb24sIGNvbmZpZyB9LCB7IGhlYWRlcnMgfSk7XG59XG5cbi8vID09PT09PSBQT1NUOiBHZW5lcmF0ZSBBZCA9PT09PT1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCk6IFByb21pc2U8TmV4dFJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keTogQWRSZXF1ZXN0Qm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgeyBhZFR5cGUsIHByb21wdCB9ID0gYm9keTtcblxuICAgIGlmICghYWRUeXBlIHx8ICFbXCJpbWFnZVwiLCBcInZpZGVvXCJdLmluY2x1ZGVzKGFkVHlwZSkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkludmFsaWQgYWQgdHlwZVwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gRXhhbXBsZTogQ2FsbCBDbG91ZGZsYXJlIFdvcmtlcnMgQUkgLyBMTGFWQSAvIGN1c3RvbSBtb2RlbFxuXG5cbiAgICAgICAgaWYgKGFkVHlwZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ0xPVURGTEFSRV9BUElfVE9LRU46JywgcHJvY2Vzcy5lbnYuQ0xPVURGTEFSRV9BUElfVE9LRU4gPyAnTG9hZGVkJyA6ICdNaXNzaW5nJyk7XG4gICAgICBjb25zb2xlLmxvZygnQ0xPVURGTEFSRV9BQ0NPVU5UX0lEOicsIHByb2Nlc3MuZW52LkNMT1VERkxBUkVfQUNDT1VOVF9JRCA/ICdMb2FkZWQnIDogJ01pc3NpbmcnKTtcblxuXG5cbiAgICAgIGNvbnN0IGlucHV0cyA9IHtcbiAgICAgICAgcHJvbXB0OiBwcm9tcHQgfHwgJ0EgYmVhdXRpZnVsIGxhbmRzY2FwZScsXG4gICAgICB9O1xuICAgICAgY29uc29sZS5sb2coJ0FJIElucHV0czonLCBpbnB1dHMpO1xuXG4gICAgICBjb25zdCBtb2RlbCA9ICdAY2Yvc3RhYmlsaXR5YWkvc3RhYmxlLWRpZmZ1c2lvbi14bC1iYXNlLTEuMCc7XG4gICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9hcGkuY2xvdWRmbGFyZS5jb20vY2xpZW50L3Y0L2FjY291bnRzLyR7cHJvY2Vzcy5lbnYuQ0xPVURGTEFSRV9BQ0NPVU5UX0lEfS9haS9ydW4vJHttb2RlbH1gO1xuICAgICAgY29uc3QgY2ZSZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtwcm9jZXNzLmVudi5DTE9VREZMQVJFX0FQSV9UT0tFTn1gLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGlucHV0cyksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjZlJlcy5vaykge1xuICAgICAgICBjb25zdCBlcnJUZXh0ID0gYXdhaXQgY2ZSZXMudGV4dCgpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENsb3VkZmxhcmUgQUkgSFRUUCBlcnJvciAke2NmUmVzLnN0YXR1c306ICR7ZXJyVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY29udGVudFR5cGUgPSBjZlJlcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgfHwgJyc7XG4gICAgICBpZiAoY29udGVudFR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJykpIHtcbiAgICAgICAgY29uc3QgYXJyYXlCdWYgPSBhd2FpdCBjZlJlcy5hcnJheUJ1ZmZlcigpO1xuICAgICAgICAvLyBDb252ZXJ0IHRvIGJhc2U2NCB0byBrZWVwIHRoZSBBUEkgcmVzcG9uc2UgSlNPTi1mcmllbmRseSBmb3IgdGhlIGNsaWVudFxuICAgICAgICBjb25zdCBiYXNlNjQgPSBCdWZmZXIuZnJvbShhcnJheUJ1ZikudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBpbWFnZTogYmFzZTY0LCBjb250ZW50VHlwZSB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2ZSZXMuanNvbigpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UpO1xuICAgICAgfVxuXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFZpZGVvIGdlbmVyYXRpb24gc3RpbGwgdXNlcyBhIHBsYWNlaG9sZGVyXG4gICAgICBjb25zdCB2aWRlb1VybCA9IGF3YWl0IGdlbmVyYXRlVmlkZW9BZCh7IHByb21wdCB9KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGFkVXJsOiB2aWRlb1VybCB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkFkIGdlbmVyYXRpb24gZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIkFuIHVua25vd24gZXJyb3Igb2NjdXJyZWRcIjtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGBBZCBnZW5lcmF0aW9uIGZhaWxlZDogJHtlcnJvck1lc3NhZ2V9YCB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbi8vIFBsYWNlaG9sZGVyIGZvciB2aWRlbyBnZW5lcmF0aW9uXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVZpZGVvQWQoZGF0YTogUGFydGlhbDxBZFJlcXVlc3RCb2R5Pik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnNvbGUubG9nKFwiR2VuZXJhdGluZyB2aWRlbyBhZCB3aXRoIGRhdGE6XCIsIGRhdGEpO1xuICByZXR1cm4gXCJodHRwczovL3d3dy53M3NjaG9vbHMuY29tL2h0bWwvbW92X2JiYi5tcDRcIjtcbn1cbiJdLCJuYW1lcyI6WyJnZXRTZXNzaW9uRnJvbUNvb2tpZSIsIk5leHRSZXNwb25zZSIsInRyeUNhdGNoIiwiZ2V0Q29uZmlnIiwiR0VUIiwiZGF0YSIsInNlc3Npb24iLCJlcnJvciIsImNvbmZpZyIsImhlYWRlcnMiLCJIZWFkZXJzIiwic2V0IiwianNvbiIsIlBPU1QiLCJyZXEiLCJib2R5IiwiYWRUeXBlIiwicHJvbXB0IiwiaW5jbHVkZXMiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwicHJvY2VzcyIsImVudiIsIkNMT1VERkxBUkVfQVBJX1RPS0VOIiwiQ0xPVURGTEFSRV9BQ0NPVU5UX0lEIiwiaW5wdXRzIiwibW9kZWwiLCJ1cmwiLCJjZlJlcyIsImZldGNoIiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9rIiwiZXJyVGV4dCIsInRleHQiLCJFcnJvciIsImNvbnRlbnRUeXBlIiwiZ2V0Iiwic3RhcnRzV2l0aCIsImFycmF5QnVmIiwiYXJyYXlCdWZmZXIiLCJiYXNlNjQiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJpbWFnZSIsInJlc3BvbnNlIiwidmlkZW9VcmwiLCJnZW5lcmF0ZVZpZGVvQWQiLCJzdWNjZXNzIiwiYWRVcmwiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/get-session/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/constants.ts":
/*!**************************!*\
  !*** ./src/constants.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CREDITS_EXPIRATION_YEARS: () => (/* binding */ CREDITS_EXPIRATION_YEARS),\n/* harmony export */   CREDIT_PACKAGES: () => (/* binding */ CREDIT_PACKAGES),\n/* harmony export */   EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS: () => (/* binding */ EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS),\n/* harmony export */   FREE_MONTHLY_CREDITS: () => (/* binding */ FREE_MONTHLY_CREDITS),\n/* harmony export */   GITHUB_REPO_URL: () => (/* binding */ GITHUB_REPO_URL),\n/* harmony export */   GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME: () => (/* binding */ GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME),\n/* harmony export */   GOOGLE_OAUTH_STATE_COOKIE_NAME: () => (/* binding */ GOOGLE_OAUTH_STATE_COOKIE_NAME),\n/* harmony export */   MAX_SESSIONS_PER_USER: () => (/* binding */ MAX_SESSIONS_PER_USER),\n/* harmony export */   MAX_TEAMS_CREATED_PER_USER: () => (/* binding */ MAX_TEAMS_CREATED_PER_USER),\n/* harmony export */   MAX_TEAMS_JOINED_PER_USER: () => (/* binding */ MAX_TEAMS_JOINED_PER_USER),\n/* harmony export */   MAX_TRANSACTIONS_PER_PAGE: () => (/* binding */ MAX_TRANSACTIONS_PER_PAGE),\n/* harmony export */   PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS: () => (/* binding */ PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS),\n/* harmony export */   REDIRECT_AFTER_SIGN_IN: () => (/* binding */ REDIRECT_AFTER_SIGN_IN),\n/* harmony export */   SESSION_COOKIE_NAME: () => (/* binding */ SESSION_COOKIE_NAME),\n/* harmony export */   SITE_DESCRIPTION: () => (/* binding */ SITE_DESCRIPTION),\n/* harmony export */   SITE_DOMAIN: () => (/* binding */ SITE_DOMAIN),\n/* harmony export */   SITE_NAME: () => (/* binding */ SITE_NAME),\n/* harmony export */   SITE_URL: () => (/* binding */ SITE_URL)\n/* harmony export */ });\nconst SITE_NAME = \"Trilent\";\nconst SITE_DESCRIPTION = \"Trilent is an AI Call Agent that answers, routes, and automates phone conversations with human‑like voice, real‑time intelligence, and CRM integrations.\";\nconst SITE_URL =  true ? \"http://localhost:3000\" : 0;\nconst GITHUB_REPO_URL = \"https://github.com/Zaynulaabaidin/FinalProject-main\";\nconst SITE_DOMAIN = new URL(SITE_URL).hostname;\nconst PASSWORD_RESET_TOKEN_EXPIRATION_SECONDS = 24 * 60 * 60 // 24 hours\n;\nconst EMAIL_VERIFICATION_TOKEN_EXPIRATION_SECONDS = 24 * 60 * 60 // 24 hours\n;\nconst MAX_SESSIONS_PER_USER = 5;\nconst MAX_TEAMS_CREATED_PER_USER = 3;\nconst MAX_TEAMS_JOINED_PER_USER = 10;\nconst SESSION_COOKIE_NAME = \"session\";\nconst GOOGLE_OAUTH_STATE_COOKIE_NAME = \"google-oauth-state\";\nconst GOOGLE_OAUTH_CODE_VERIFIER_COOKIE_NAME = \"google-oauth-code-verifier\";\nconst CREDIT_PACKAGES = [\n    {\n        id: \"package-1\",\n        credits: 500,\n        price: 5\n    },\n    {\n        id: \"package-2\",\n        credits: 1200,\n        price: 10\n    },\n    {\n        id: \"package-3\",\n        credits: 3000,\n        price: 20\n    }\n];\nconst CREDITS_EXPIRATION_YEARS = 2;\nconst FREE_MONTHLY_CREDITS = CREDIT_PACKAGES[0].credits * 0.1;\nconst MAX_TRANSACTIONS_PER_PAGE = 10;\nconst REDIRECT_AFTER_SIGN_IN = \"/dashboard\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvY29uc3RhbnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVPLE1BQU1BLFlBQVksVUFBUztBQUMzQixNQUFNQyxtQkFBbUIsMkpBQTBKO0FBQ25MLE1BQU1DLFdBQVdDLEtBQXNDLEdBQUcsMEJBQTBCLENBQWdEO0FBQ3BJLE1BQU1DLGtCQUFrQixzREFBcUQ7QUFFN0UsTUFBTUMsY0FBYyxJQUFJQyxJQUFJSixVQUFVSyxRQUFRO0FBQzlDLE1BQU1DLDBDQUEwQyxLQUFLLEtBQUssR0FBRyxXQUFXO0NBQVo7QUFDNUQsTUFBTUMsOENBQThDLEtBQUssS0FBSyxHQUFHLFdBQVc7Q0FBWjtBQUNoRSxNQUFNQyx3QkFBd0IsRUFBRTtBQUNoQyxNQUFNQyw2QkFBNkIsRUFBRTtBQUNyQyxNQUFNQyw0QkFBNEIsR0FBRztBQUNyQyxNQUFNQyxzQkFBc0IsVUFBVTtBQUN0QyxNQUFNQyxpQ0FBaUMscUJBQXFCO0FBQzVELE1BQU1DLHlDQUF5Qyw2QkFBNkI7QUFFNUUsTUFBTUMsa0JBQWtCO0lBQzdCO1FBQUVDLElBQUk7UUFBYUMsU0FBUztRQUFLQyxPQUFPO0lBQUU7SUFDMUM7UUFBRUYsSUFBSTtRQUFhQyxTQUFTO1FBQU1DLE9BQU87SUFBRztJQUM1QztRQUFFRixJQUFJO1FBQWFDLFNBQVM7UUFBTUMsT0FBTztJQUFHO0NBQzdDLENBQVU7QUFFSixNQUFNQywyQkFBMkIsRUFBRTtBQUVuQyxNQUFNQyx1QkFBdUJMLGVBQWUsQ0FBQyxFQUFFLENBQUNFLE9BQU8sR0FBRyxJQUFJO0FBQzlELE1BQU1JLDRCQUE0QixHQUFHO0FBQ3JDLE1BQU1DLHlCQUF5QixhQUFzQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx6YWludWxhYWJhaWRpblxcRG93bmxvYWRzXFxGaW5hbFByb2plY3QtbWFpblxcRmluYWxQcm9qZWN0LW1haW5cXHNyY1xcY29uc3RhbnRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUm91dGUgfSBmcm9tIFwibmV4dFwiXG5cbmV4cG9ydCBjb25zdCBTSVRFX05BTUUgPSBcIlRyaWxlbnRcIlxuZXhwb3J0IGNvbnN0IFNJVEVfREVTQ1JJUFRJT04gPSBcIlRyaWxlbnQgaXMgYW4gQUkgQ2FsbCBBZ2VudCB0aGF0IGFuc3dlcnMsIHJvdXRlcywgYW5kIGF1dG9tYXRlcyBwaG9uZSBjb252ZXJzYXRpb25zIHdpdGggaHVtYW7igJFsaWtlIHZvaWNlLCByZWFs4oCRdGltZSBpbnRlbGxpZ2VuY2UsIGFuZCBDUk0gaW50ZWdyYXRpb25zLlwiXG5leHBvcnQgY29uc3QgU0lURV9VUkwgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiID8gXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIiA6IFwiaHR0cHM6Ly9uZXh0anMtc2Fhcy10ZW1wbGF0ZS5hZ2VudGljZGV2LmFnZW5jeVwiXG5leHBvcnQgY29uc3QgR0lUSFVCX1JFUE9fVVJMID0gXCJodHRwczovL2dpdGh1Yi5jb20vWmF5bnVsYWFiYWlkaW4vRmluYWxQcm9qZWN0LW1haW5cIlxuXG5leHBvcnQgY29uc3QgU0lURV9ET01BSU4gPSBuZXcgVVJMKFNJVEVfVVJMKS5ob3N0bmFtZVxuZXhwb3J0IGNvbnN0IFBBU1NXT1JEX1JFU0VUX1RPS0VOX0VYUElSQVRJT05fU0VDT05EUyA9IDI0ICogNjAgKiA2MCAvLyAyNCBob3Vyc1xuZXhwb3J0IGNvbnN0IEVNQUlMX1ZFUklGSUNBVElPTl9UT0tFTl9FWFBJUkFUSU9OX1NFQ09ORFMgPSAyNCAqIDYwICogNjAgLy8gMjQgaG91cnNcbmV4cG9ydCBjb25zdCBNQVhfU0VTU0lPTlNfUEVSX1VTRVIgPSA1O1xuZXhwb3J0IGNvbnN0IE1BWF9URUFNU19DUkVBVEVEX1BFUl9VU0VSID0gMztcbmV4cG9ydCBjb25zdCBNQVhfVEVBTVNfSk9JTkVEX1BFUl9VU0VSID0gMTA7XG5leHBvcnQgY29uc3QgU0VTU0lPTl9DT09LSUVfTkFNRSA9IFwic2Vzc2lvblwiO1xuZXhwb3J0IGNvbnN0IEdPT0dMRV9PQVVUSF9TVEFURV9DT09LSUVfTkFNRSA9IFwiZ29vZ2xlLW9hdXRoLXN0YXRlXCI7XG5leHBvcnQgY29uc3QgR09PR0xFX09BVVRIX0NPREVfVkVSSUZJRVJfQ09PS0lFX05BTUUgPSBcImdvb2dsZS1vYXV0aC1jb2RlLXZlcmlmaWVyXCI7XG5cbmV4cG9ydCBjb25zdCBDUkVESVRfUEFDS0FHRVMgPSBbXG4gIHsgaWQ6IFwicGFja2FnZS0xXCIsIGNyZWRpdHM6IDUwMCwgcHJpY2U6IDUgfSxcbiAgeyBpZDogXCJwYWNrYWdlLTJcIiwgY3JlZGl0czogMTIwMCwgcHJpY2U6IDEwIH0sXG4gIHsgaWQ6IFwicGFja2FnZS0zXCIsIGNyZWRpdHM6IDMwMDAsIHByaWNlOiAyMCB9LFxuXSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IENSRURJVFNfRVhQSVJBVElPTl9ZRUFSUyA9IDI7XG5cbmV4cG9ydCBjb25zdCBGUkVFX01PTlRITFlfQ1JFRElUUyA9IENSRURJVF9QQUNLQUdFU1swXS5jcmVkaXRzICogMC4xO1xuZXhwb3J0IGNvbnN0IE1BWF9UUkFOU0FDVElPTlNfUEVSX1BBR0UgPSAxMDtcbmV4cG9ydCBjb25zdCBSRURJUkVDVF9BRlRFUl9TSUdOX0lOID0gXCIvZGFzaGJvYXJkXCIgYXMgUm91dGU7XG4iXSwibmFtZXMiOlsiU0lURV9OQU1FIiwiU0lURV9ERVNDUklQVElPTiIsIlNJVEVfVVJMIiwicHJvY2VzcyIsIkdJVEhVQl9SRVBPX1VSTCIsIlNJVEVfRE9NQUlOIiwiVVJMIiwiaG9zdG5hbWUiLCJQQVNTV09SRF9SRVNFVF9UT0tFTl9FWFBJUkFUSU9OX1NFQ09ORFMiLCJFTUFJTF9WRVJJRklDQVRJT05fVE9LRU5fRVhQSVJBVElPTl9TRUNPTkRTIiwiTUFYX1NFU1NJT05TX1BFUl9VU0VSIiwiTUFYX1RFQU1TX0NSRUFURURfUEVSX1VTRVIiLCJNQVhfVEVBTVNfSk9JTkVEX1BFUl9VU0VSIiwiU0VTU0lPTl9DT09LSUVfTkFNRSIsIkdPT0dMRV9PQVVUSF9TVEFURV9DT09LSUVfTkFNRSIsIkdPT0dMRV9PQVVUSF9DT0RFX1ZFUklGSUVSX0NPT0tJRV9OQU1FIiwiQ1JFRElUX1BBQ0tBR0VTIiwiaWQiLCJjcmVkaXRzIiwicHJpY2UiLCJDUkVESVRTX0VYUElSQVRJT05fWUVBUlMiLCJGUkVFX01PTlRITFlfQ1JFRElUUyIsIk1BWF9UUkFOU0FDVElPTlNfUEVSX1BBR0UiLCJSRURJUkVDVF9BRlRFUl9TSUdOX0lOIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/constants.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/index.ts":
/*!*************************!*\
  !*** ./src/db/index.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getDB: () => (/* binding */ getDB)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_d1__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/d1 */ \"(rsc)/./node_modules/drizzle-orm/d1/driver.js\");\n/* harmony import */ var _opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @opennextjs/cloudflare */ \"(rsc)/./node_modules/@opennextjs/cloudflare/dist/api/index.js\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./schema */ \"(rsc)/./src/db/schema.ts\");\n\n\n\nlet db = null;\nconst getDB = ()=>{\n    if (db) {\n        return db;\n    }\n    const { env } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_0__.getCloudflareContext)();\n    if (!env.NEXT_TAG_CACHE_D1) {\n        throw new Error(\"D1 database not found\");\n    }\n    db = (0,drizzle_orm_d1__WEBPACK_IMPORTED_MODULE_2__.drizzle)(env.NEXT_TAG_CACHE_D1, {\n        schema: _schema__WEBPACK_IMPORTED_MODULE_1__,\n        logger: true\n    });\n    return db;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZGIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBeUM7QUFDcUI7QUFHM0I7QUFFNUIsSUFBSUcsS0FBOEMsS0FBSztBQUV2RCxNQUFNQyxRQUFRO0lBQ25CLElBQUlELElBQUk7UUFDTixPQUFPQTtJQUNUO0lBRUEsTUFBTSxFQUFFRSxHQUFHLEVBQUUsR0FBR0osNEVBQW9CQTtJQUVwQyxJQUFJLENBQUNJLElBQUlDLGlCQUFpQixFQUFFO1FBQzFCLE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUVBSixLQUFLSCx1REFBT0EsQ0FBQ0ssSUFBSUMsaUJBQWlCLEVBQUU7UUFBRUosTUFBTUEsc0NBQUFBO1FBQUVNLFFBQVE7SUFBSztJQUUzRCxPQUFPTDtBQUNULEVBQUUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXGRiXFxpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkcml6emxlIH0gZnJvbSBcImRyaXp6bGUtb3JtL2QxXCI7XG5pbXBvcnQgeyBnZXRDbG91ZGZsYXJlQ29udGV4dCB9IGZyb20gXCJAb3Blbm5leHRqcy9jbG91ZGZsYXJlXCI7XG5pbXBvcnQgdHlwZSB7IERyaXp6bGVEMURhdGFiYXNlIH0gZnJvbSBcImRyaXp6bGUtb3JtL2QxXCI7XG5cbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiLi9zY2hlbWFcIjtcblxuZXhwb3J0IGxldCBkYjogRHJpenpsZUQxRGF0YWJhc2U8dHlwZW9mIHNjaGVtYT4gfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGNvbnN0IGdldERCID0gKCkgPT4ge1xuICBpZiAoZGIpIHtcbiAgICByZXR1cm4gZGI7XG4gIH1cblxuICBjb25zdCB7IGVudiB9ID0gZ2V0Q2xvdWRmbGFyZUNvbnRleHQoKTtcblxuICBpZiAoIWVudi5ORVhUX1RBR19DQUNIRV9EMSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkQxIGRhdGFiYXNlIG5vdCBmb3VuZFwiKTtcbiAgfVxuXG4gIGRiID0gZHJpenpsZShlbnYuTkVYVF9UQUdfQ0FDSEVfRDEsIHsgc2NoZW1hLCBsb2dnZXI6IHRydWUgfSk7XG5cbiAgcmV0dXJuIGRiO1xufTtcbiJdLCJuYW1lcyI6WyJkcml6emxlIiwiZ2V0Q2xvdWRmbGFyZUNvbnRleHQiLCJzY2hlbWEiLCJkYiIsImdldERCIiwiZW52IiwiTkVYVF9UQUdfQ0FDSEVfRDEiLCJFcnJvciIsImxvZ2dlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/db/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/db/schema.ts":
/*!**************************!*\
  !*** ./src/db/schema.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CREDIT_TRANSACTION_TYPE: () => (/* binding */ CREDIT_TRANSACTION_TYPE),\n/* harmony export */   PURCHASABLE_ITEM_TYPE: () => (/* binding */ PURCHASABLE_ITEM_TYPE),\n/* harmony export */   ROLES_ENUM: () => (/* binding */ ROLES_ENUM),\n/* harmony export */   SYSTEM_ROLES_ENUM: () => (/* binding */ SYSTEM_ROLES_ENUM),\n/* harmony export */   TEAM_PERMISSIONS: () => (/* binding */ TEAM_PERMISSIONS),\n/* harmony export */   creditTransactionRelations: () => (/* binding */ creditTransactionRelations),\n/* harmony export */   creditTransactionTable: () => (/* binding */ creditTransactionTable),\n/* harmony export */   creditTransactionTypeTuple: () => (/* binding */ creditTransactionTypeTuple),\n/* harmony export */   passKeyCredentialRelations: () => (/* binding */ passKeyCredentialRelations),\n/* harmony export */   passKeyCredentialTable: () => (/* binding */ passKeyCredentialTable),\n/* harmony export */   purchasableItemTypeTuple: () => (/* binding */ purchasableItemTypeTuple),\n/* harmony export */   purchasedItemsRelations: () => (/* binding */ purchasedItemsRelations),\n/* harmony export */   purchasedItemsTable: () => (/* binding */ purchasedItemsTable),\n/* harmony export */   systemRoleTuple: () => (/* binding */ systemRoleTuple),\n/* harmony export */   teamInvitationRelations: () => (/* binding */ teamInvitationRelations),\n/* harmony export */   teamInvitationTable: () => (/* binding */ teamInvitationTable),\n/* harmony export */   teamMembershipRelations: () => (/* binding */ teamMembershipRelations),\n/* harmony export */   teamMembershipTable: () => (/* binding */ teamMembershipTable),\n/* harmony export */   teamRelations: () => (/* binding */ teamRelations),\n/* harmony export */   teamRoleRelations: () => (/* binding */ teamRoleRelations),\n/* harmony export */   teamRoleTable: () => (/* binding */ teamRoleTable),\n/* harmony export */   teamTable: () => (/* binding */ teamTable),\n/* harmony export */   userRelations: () => (/* binding */ userRelations),\n/* harmony export */   userTable: () => (/* binding */ userTable)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/drizzle-orm/sqlite-core/columns/integer.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/drizzle-orm/sqlite-core/table.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/drizzle-orm/sqlite-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/sqlite-core */ \"(rsc)/./node_modules/drizzle-orm/sqlite-core/indexes.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/relations.js\");\n/* harmony import */ var _paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @paralleldrive/cuid2 */ \"(rsc)/./node_modules/@paralleldrive/cuid2/index.js\");\n\n\n\nconst ROLES_ENUM = {\n    ADMIN: 'admin',\n    USER: 'user'\n};\nconst roleTuple = Object.values(ROLES_ENUM);\nconst commonColumns = {\n    createdAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$defaultFn(()=>new Date()).notNull(),\n    updatedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$onUpdateFn(()=>new Date()).notNull(),\n    updateCounter: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).$onUpdate(()=>(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.sql)`updateCounter + 1`)\n};\nconst userTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"user\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`usr_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    firstName: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    lastName: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    email: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).unique(),\n    passwordHash: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)(),\n    role: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: roleTuple\n    }).default(ROLES_ENUM.USER).notNull(),\n    emailVerified: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    signUpIpAddress: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    }),\n    googleAccountId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    /**\n   * This can either be an absolute or relative path to an image\n   */ avatar: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 600\n    }),\n    // Credit system fields\n    currentCredits: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull(),\n    lastCreditRefreshAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('email_idx').on(table.email),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('google_account_id_idx').on(table.googleAccountId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('role_idx').on(table.role)\n    ]);\nconst passKeyCredentialTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"passkey_credential\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`pkey_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    credentialId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    credentialPublicKey: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    counter: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().notNull(),\n    // Optional array of AuthenticatorTransport as JSON string\n    transports: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // Authenticator Attestation GUID. We use this to identify the device/authenticator app that created the passkey\n    aaguid: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // The user agent of the device that created the passkey\n    userAgent: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    // The IP address that created the passkey\n    ipAddress: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credential_id_idx').on(table.credentialId)\n    ]);\n// Credit transaction types\nconst CREDIT_TRANSACTION_TYPE = {\n    PURCHASE: 'PURCHASE',\n    USAGE: 'USAGE',\n    MONTHLY_REFRESH: 'MONTHLY_REFRESH'\n};\nconst creditTransactionTypeTuple = Object.values(CREDIT_TRANSACTION_TYPE);\nconst creditTransactionTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"credit_transaction\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`ctxn_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    amount: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().notNull(),\n    // Track how many credits are still available from this transaction\n    remainingAmount: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull(),\n    type: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: creditTransactionTypeTuple\n    }).notNull(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    expirationDate: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    expirationDateProcessedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    paymentIntentId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    })\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_type_idx').on(table.type),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_created_at_idx').on(table.createdAt),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_expiration_date_idx').on(table.expirationDate),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('credit_transaction_payment_intent_id_idx').on(table.paymentIntentId)\n    ]);\n// Define item types that can be purchased\nconst PURCHASABLE_ITEM_TYPE = {\n    COMPONENT: 'COMPONENT'\n};\nconst purchasableItemTypeTuple = Object.values(PURCHASABLE_ITEM_TYPE);\nconst purchasedItemsTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"purchased_item\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`pitem_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    // The type of item (e.g., COMPONENT, TEMPLATE, etc.)\n    itemType: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        enum: purchasableItemTypeTuple\n    }).notNull(),\n    // The ID of the item within its type (e.g., componentId)\n    itemId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    purchasedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).$defaultFn(()=>new Date()).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_user_id_idx').on(table.userId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_type_idx').on(table.itemType),\n        // Composite index for checking if a user owns a specific item of a specific type\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('purchased_item_user_item_idx').on(table.userId, table.itemType, table.itemId)\n    ]);\n// System-defined roles - these are always available\nconst SYSTEM_ROLES_ENUM = {\n    OWNER: 'owner',\n    ADMIN: 'admin',\n    MEMBER: 'member',\n    GUEST: 'guest'\n};\nconst systemRoleTuple = Object.values(SYSTEM_ROLES_ENUM);\n// Define available permissions\nconst TEAM_PERMISSIONS = {\n    // Resource access\n    ACCESS_DASHBOARD: 'access_dashboard',\n    ACCESS_BILLING: 'access_billing',\n    // User management\n    INVITE_MEMBERS: 'invite_members',\n    REMOVE_MEMBERS: 'remove_members',\n    CHANGE_MEMBER_ROLES: 'change_member_roles',\n    // Team management\n    EDIT_TEAM_SETTINGS: 'edit_team_settings',\n    DELETE_TEAM: 'delete_team',\n    // Role management\n    CREATE_ROLES: 'create_roles',\n    EDIT_ROLES: 'edit_roles',\n    DELETE_ROLES: 'delete_roles',\n    ASSIGN_ROLES: 'assign_roles',\n    // Content permissions\n    CREATE_COMPONENTS: 'create_components',\n    EDIT_COMPONENTS: 'edit_components',\n    DELETE_COMPONENTS: 'delete_components'\n};\n// Team table\nconst teamTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`team_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    name: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    slug: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 1000\n    }),\n    avatarUrl: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 600\n    }),\n    // Settings could be stored as JSON\n    settings: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 10000\n    }),\n    // Optional billing-related fields\n    billingEmail: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }),\n    planId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 100\n    }),\n    planExpiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    creditBalance: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(0).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_slug_idx').on(table.slug)\n    ]);\n// Team membership table\nconst teamMembershipTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_membership\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`tmem_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    userId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    // This can be either a system role or a custom role ID\n    roleId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    // Flag to indicate if this is a system role\n    isSystemRole: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull(),\n    invitedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().references(()=>userTable.id),\n    invitedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    joinedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    expiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    isActive: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_team_id_idx').on(table.teamId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_user_id_idx').on(table.userId),\n        // Instead of unique() which causes linter errors, we'll create a unique constraint on columns\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_membership_unique_idx').on(table.teamId, table.userId)\n    ]);\n// Team role table\nconst teamRoleTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_role\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`trole_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    name: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    description: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 1000\n    }),\n    // Store permissions as a JSON array of permission keys\n    permissions: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        mode: 'json'\n    }).notNull().$type(),\n    // A JSON field for storing UI-specific settings like color, icon, etc.\n    metadata: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 5000\n    }),\n    // Optional flag to mark some roles as non-editable\n    isEditable: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull()\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_role_team_id_idx').on(table.teamId),\n        // Instead of unique() which causes linter errors, we'll create a unique constraint on columns\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_role_name_unique_idx').on(table.teamId, table.name)\n    ]);\n// Team invitation table\nconst teamInvitationTable = (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_3__.sqliteTable)(\"team_invitation\", {\n    ...commonColumns,\n    id: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().primaryKey().$defaultFn(()=>`tinv_${(0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_0__.createId)()}`).notNull(),\n    teamId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>teamTable.id),\n    email: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull(),\n    // This can be either a system role or a custom role ID\n    roleId: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull(),\n    // Flag to indicate if this is a system role\n    isSystemRole: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)().default(1).notNull(),\n    token: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)({\n        length: 255\n    }).notNull().unique(),\n    invitedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().notNull().references(()=>userTable.id),\n    expiresAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }).notNull(),\n    acceptedAt: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_1__.integer)({\n        mode: \"timestamp\"\n    }),\n    acceptedBy: (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_4__.text)().references(()=>userTable.id)\n}, (table)=>[\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_team_id_idx').on(table.teamId),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_email_idx').on(table.email),\n        (0,drizzle_orm_sqlite_core__WEBPACK_IMPORTED_MODULE_5__.index)('team_invitation_token_idx').on(table.token)\n    ]);\nconst teamRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamTable, ({ many })=>({\n        memberships: many(teamMembershipTable),\n        invitations: many(teamInvitationTable),\n        roles: many(teamRoleTable)\n    }));\nconst teamRoleRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamRoleTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamRoleTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        })\n    }));\nconst teamMembershipRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamMembershipTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamMembershipTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        }),\n        user: one(userTable, {\n            fields: [\n                teamMembershipTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        }),\n        invitedByUser: one(userTable, {\n            fields: [\n                teamMembershipTable.invitedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst teamInvitationRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(teamInvitationTable, ({ one })=>({\n        team: one(teamTable, {\n            fields: [\n                teamInvitationTable.teamId\n            ],\n            references: [\n                teamTable.id\n            ]\n        }),\n        invitedByUser: one(userTable, {\n            fields: [\n                teamInvitationTable.invitedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        }),\n        acceptedByUser: one(userTable, {\n            fields: [\n                teamInvitationTable.acceptedBy\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst creditTransactionRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(creditTransactionTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                creditTransactionTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst purchasedItemsRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(purchasedItemsTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                purchasedItemsTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\nconst userRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(userTable, ({ many })=>({\n        passkeys: many(passKeyCredentialTable),\n        creditTransactions: many(creditTransactionTable),\n        purchasedItems: many(purchasedItemsTable),\n        teamMemberships: many(teamMembershipTable)\n    }));\nconst passKeyCredentialRelations = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.relations)(passKeyCredentialTable, ({ one })=>({\n        user: one(userTable, {\n            fields: [\n                passKeyCredentialTable.userId\n            ],\n            references: [\n                userTable.id\n            ]\n        })\n    }));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDeEIsSUFBSTtBQUVHLE1BQU11Qyw2QkFBNkJ6SSxzREFBU0EsQ0FBQ3VDLHdCQUF3QixDQUFDLEVBQUVtRixHQUFHLEVBQUUsR0FBTTtRQUN4RkksTUFBTUosSUFBSXRHLFdBQVc7WUFDbkJ3RyxRQUFRO2dCQUFDckYsdUJBQXVCQyxNQUFNO2FBQUM7WUFDdkNDLFlBQVk7Z0JBQUNyQixVQUFVQyxFQUFFO2FBQUM7UUFDNUI7SUFDRixJQUFJIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHphaW51bGFhYmFpZGluXFxEb3dubG9hZHNcXEZpbmFsUHJvamVjdC1tYWluXFxGaW5hbFByb2plY3QtbWFpblxcc3JjXFxkYlxcc2NoZW1hLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNxbGl0ZVRhYmxlLCBpbnRlZ2VyLCB0ZXh0LCBpbmRleCB9IGZyb20gXCJkcml6emxlLW9ybS9zcWxpdGUtY29yZVwiO1xuaW1wb3J0IHsgcmVsYXRpb25zLCBzcWwgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcbmltcG9ydCB7IHR5cGUgSW5mZXJTZWxlY3RNb2RlbCB9IGZyb20gXCJkcml6emxlLW9ybVwiO1xuXG5pbXBvcnQgeyBjcmVhdGVJZCB9IGZyb20gJ0BwYXJhbGxlbGRyaXZlL2N1aWQyJ1xuXG5leHBvcnQgY29uc3QgUk9MRVNfRU5VTSA9IHtcbiAgQURNSU46ICdhZG1pbicsXG4gIFVTRVI6ICd1c2VyJyxcbn0gYXMgY29uc3Q7XG5cbmNvbnN0IHJvbGVUdXBsZSA9IE9iamVjdC52YWx1ZXMoUk9MRVNfRU5VTSkgYXMgW3N0cmluZywgLi4uc3RyaW5nW11dO1xuXG5jb25zdCBjb21tb25Db2x1bW5zID0ge1xuICBjcmVhdGVkQXQ6IGludGVnZXIoe1xuICAgIG1vZGU6IFwidGltZXN0YW1wXCIsXG4gIH0pLiRkZWZhdWx0Rm4oKCkgPT4gbmV3IERhdGUoKSkubm90TnVsbCgpLFxuICB1cGRhdGVkQXQ6IGludGVnZXIoe1xuICAgIG1vZGU6IFwidGltZXN0YW1wXCIsXG4gIH0pLiRvblVwZGF0ZUZuKCgpID0+IG5ldyBEYXRlKCkpLm5vdE51bGwoKSxcbiAgdXBkYXRlQ291bnRlcjogaW50ZWdlcigpLmRlZmF1bHQoMCkuJG9uVXBkYXRlKCgpID0+IHNxbGB1cGRhdGVDb3VudGVyICsgMWApLFxufVxuXG5leHBvcnQgY29uc3QgdXNlclRhYmxlID0gc3FsaXRlVGFibGUoXCJ1c2VyXCIsIHtcbiAgLi4uY29tbW9uQ29sdW1ucyxcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgdXNyXyR7Y3JlYXRlSWQoKX1gKS5ub3ROdWxsKCksXG4gIGZpcnN0TmFtZTogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLFxuICBsYXN0TmFtZTogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLFxuICBlbWFpbDogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLnVuaXF1ZSgpLFxuICBwYXNzd29yZEhhc2g6IHRleHQoKSxcbiAgcm9sZTogdGV4dCh7XG4gICAgZW51bTogcm9sZVR1cGxlLFxuICB9KS5kZWZhdWx0KFJPTEVTX0VOVU0uVVNFUikubm90TnVsbCgpLFxuICBlbWFpbFZlcmlmaWVkOiBpbnRlZ2VyKHtcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxuICB9KSxcbiAgc2lnblVwSXBBZGRyZXNzOiB0ZXh0KHtcbiAgICBsZW5ndGg6IDEwMCxcbiAgfSksXG4gIGdvb2dsZUFjY291bnRJZDogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLFxuICAvKipcbiAgICogVGhpcyBjYW4gZWl0aGVyIGJlIGFuIGFic29sdXRlIG9yIHJlbGF0aXZlIHBhdGggdG8gYW4gaW1hZ2VcbiAgICovXG4gIGF2YXRhcjogdGV4dCh7XG4gICAgbGVuZ3RoOiA2MDAsXG4gIH0pLFxuICAvLyBDcmVkaXQgc3lzdGVtIGZpZWxkc1xuICBjdXJyZW50Q3JlZGl0czogaW50ZWdlcigpLmRlZmF1bHQoMCkubm90TnVsbCgpLFxuICBsYXN0Q3JlZGl0UmVmcmVzaEF0OiBpbnRlZ2VyKHtcbiAgICBtb2RlOiBcInRpbWVzdGFtcFwiLFxuICB9KSxcbn0sICh0YWJsZSkgPT4gKFtcbiAgaW5kZXgoJ2VtYWlsX2lkeCcpLm9uKHRhYmxlLmVtYWlsKSxcbiAgaW5kZXgoJ2dvb2dsZV9hY2NvdW50X2lkX2lkeCcpLm9uKHRhYmxlLmdvb2dsZUFjY291bnRJZCksXG4gIGluZGV4KCdyb2xlX2lkeCcpLm9uKHRhYmxlLnJvbGUpLFxuXSkpO1xuXG5leHBvcnQgY29uc3QgcGFzc0tleUNyZWRlbnRpYWxUYWJsZSA9IHNxbGl0ZVRhYmxlKFwicGFzc2tleV9jcmVkZW50aWFsXCIsIHtcbiAgLi4uY29tbW9uQ29sdW1ucyxcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgcGtleV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxuICB1c2VySWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2VyVGFibGUuaWQpLFxuICBjcmVkZW50aWFsSWQ6IHRleHQoe1xuICAgIGxlbmd0aDogMjU1LFxuICB9KS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIGNyZWRlbnRpYWxQdWJsaWNLZXk6IHRleHQoe1xuICAgIGxlbmd0aDogMjU1LFxuICB9KS5ub3ROdWxsKCksXG4gIGNvdW50ZXI6IGludGVnZXIoKS5ub3ROdWxsKCksXG4gIC8vIE9wdGlvbmFsIGFycmF5IG9mIEF1dGhlbnRpY2F0b3JUcmFuc3BvcnQgYXMgSlNPTiBzdHJpbmdcbiAgdHJhbnNwb3J0czogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLFxuICAvLyBBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uIEdVSUQuIFdlIHVzZSB0aGlzIHRvIGlkZW50aWZ5IHRoZSBkZXZpY2UvYXV0aGVudGljYXRvciBhcHAgdGhhdCBjcmVhdGVkIHRoZSBwYXNza2V5XG4gIGFhZ3VpZDogdGV4dCh7XG4gICAgbGVuZ3RoOiAyNTUsXG4gIH0pLFxuICAvLyBUaGUgdXNlciBhZ2VudCBvZiB0aGUgZGV2aWNlIHRoYXQgY3JlYXRlZCB0aGUgcGFzc2tleVxuICB1c2VyQWdlbnQ6IHRleHQoe1xuICAgIGxlbmd0aDogMjU1LFxuICB9KSxcbiAgLy8gVGhlIElQIGFkZHJlc3MgdGhhdCBjcmVhdGVkIHRoZSBwYXNza2V5XG4gIGlwQWRkcmVzczogdGV4dCh7XG4gICAgbGVuZ3RoOiAxMDAsXG4gIH0pLFxufSwgKHRhYmxlKSA9PiAoW1xuICBpbmRleCgndXNlcl9pZF9pZHgnKS5vbih0YWJsZS51c2VySWQpLFxuICBpbmRleCgnY3JlZGVudGlhbF9pZF9pZHgnKS5vbih0YWJsZS5jcmVkZW50aWFsSWQpLFxuXSkpO1xuXG4vLyBDcmVkaXQgdHJhbnNhY3Rpb24gdHlwZXNcbmV4cG9ydCBjb25zdCBDUkVESVRfVFJBTlNBQ1RJT05fVFlQRSA9IHtcbiAgUFVSQ0hBU0U6ICdQVVJDSEFTRScsXG4gIFVTQUdFOiAnVVNBR0UnLFxuICBNT05USExZX1JFRlJFU0g6ICdNT05USExZX1JFRlJFU0gnLFxufSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IGNyZWRpdFRyYW5zYWN0aW9uVHlwZVR1cGxlID0gT2JqZWN0LnZhbHVlcyhDUkVESVRfVFJBTlNBQ1RJT05fVFlQRSkgYXMgW3N0cmluZywgLi4uc3RyaW5nW11dO1xuXG5leHBvcnQgY29uc3QgY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSA9IHNxbGl0ZVRhYmxlKFwiY3JlZGl0X3RyYW5zYWN0aW9uXCIsIHtcbiAgLi4uY29tbW9uQ29sdW1ucyxcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgY3R4bl8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxuICB1c2VySWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2VyVGFibGUuaWQpLFxuICBhbW91bnQ6IGludGVnZXIoKS5ub3ROdWxsKCksXG4gIC8vIFRyYWNrIGhvdyBtYW55IGNyZWRpdHMgYXJlIHN0aWxsIGF2YWlsYWJsZSBmcm9tIHRoaXMgdHJhbnNhY3Rpb25cbiAgcmVtYWluaW5nQW1vdW50OiBpbnRlZ2VyKCkuZGVmYXVsdCgwKS5ub3ROdWxsKCksXG4gIHR5cGU6IHRleHQoe1xuICAgIGVudW06IGNyZWRpdFRyYW5zYWN0aW9uVHlwZVR1cGxlLFxuICB9KS5ub3ROdWxsKCksXG4gIGRlc2NyaXB0aW9uOiB0ZXh0KHtcbiAgICBsZW5ndGg6IDI1NSxcbiAgfSkubm90TnVsbCgpLFxuICBleHBpcmF0aW9uRGF0ZTogaW50ZWdlcih7XG4gICAgbW9kZTogXCJ0aW1lc3RhbXBcIixcbiAgfSksXG4gIGV4cGlyYXRpb25EYXRlUHJvY2Vzc2VkQXQ6IGludGVnZXIoe1xuICAgIG1vZGU6IFwidGltZXN0YW1wXCIsXG4gIH0pLFxuICBwYXltZW50SW50ZW50SWQ6IHRleHQoe1xuICAgIGxlbmd0aDogMjU1LFxuICB9KSxcbn0sICh0YWJsZSkgPT4gKFtcbiAgaW5kZXgoJ2NyZWRpdF90cmFuc2FjdGlvbl91c2VyX2lkX2lkeCcpLm9uKHRhYmxlLnVzZXJJZCksXG4gIGluZGV4KCdjcmVkaXRfdHJhbnNhY3Rpb25fdHlwZV9pZHgnKS5vbih0YWJsZS50eXBlKSxcbiAgaW5kZXgoJ2NyZWRpdF90cmFuc2FjdGlvbl9jcmVhdGVkX2F0X2lkeCcpLm9uKHRhYmxlLmNyZWF0ZWRBdCksXG4gIGluZGV4KCdjcmVkaXRfdHJhbnNhY3Rpb25fZXhwaXJhdGlvbl9kYXRlX2lkeCcpLm9uKHRhYmxlLmV4cGlyYXRpb25EYXRlKSxcbiAgaW5kZXgoJ2NyZWRpdF90cmFuc2FjdGlvbl9wYXltZW50X2ludGVudF9pZF9pZHgnKS5vbih0YWJsZS5wYXltZW50SW50ZW50SWQpLFxuXSkpO1xuXG4vLyBEZWZpbmUgaXRlbSB0eXBlcyB0aGF0IGNhbiBiZSBwdXJjaGFzZWRcbmV4cG9ydCBjb25zdCBQVVJDSEFTQUJMRV9JVEVNX1RZUEUgPSB7XG4gIENPTVBPTkVOVDogJ0NPTVBPTkVOVCcsXG4gIC8vIEFkZCBtb3JlIHR5cGVzIGluIHRoZSBmdXR1cmUgKGUuZy4sIFRFTVBMQVRFLCBQTFVHSU4sIGV0Yy4pXG59IGFzIGNvbnN0O1xuXG5leHBvcnQgY29uc3QgcHVyY2hhc2FibGVJdGVtVHlwZVR1cGxlID0gT2JqZWN0LnZhbHVlcyhQVVJDSEFTQUJMRV9JVEVNX1RZUEUpIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXTtcblxuZXhwb3J0IGNvbnN0IHB1cmNoYXNlZEl0ZW1zVGFibGUgPSBzcWxpdGVUYWJsZShcInB1cmNoYXNlZF9pdGVtXCIsIHtcbiAgLi4uY29tbW9uQ29sdW1ucyxcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgcGl0ZW1fJHtjcmVhdGVJZCgpfWApLm5vdE51bGwoKSxcbiAgdXNlcklkOiB0ZXh0KCkubm90TnVsbCgpLnJlZmVyZW5jZXMoKCkgPT4gdXNlclRhYmxlLmlkKSxcbiAgLy8gVGhlIHR5cGUgb2YgaXRlbSAoZS5nLiwgQ09NUE9ORU5ULCBURU1QTEFURSwgZXRjLilcbiAgaXRlbVR5cGU6IHRleHQoe1xuICAgIGVudW06IHB1cmNoYXNhYmxlSXRlbVR5cGVUdXBsZSxcbiAgfSkubm90TnVsbCgpLFxuICAvLyBUaGUgSUQgb2YgdGhlIGl0ZW0gd2l0aGluIGl0cyB0eXBlIChlLmcuLCBjb21wb25lbnRJZClcbiAgaXRlbUlkOiB0ZXh0KCkubm90TnVsbCgpLFxuICBwdXJjaGFzZWRBdDogaW50ZWdlcih7XG4gICAgbW9kZTogXCJ0aW1lc3RhbXBcIixcbiAgfSkuJGRlZmF1bHRGbigoKSA9PiBuZXcgRGF0ZSgpKS5ub3ROdWxsKCksXG59LCAodGFibGUpID0+IChbXG4gIGluZGV4KCdwdXJjaGFzZWRfaXRlbV91c2VyX2lkX2lkeCcpLm9uKHRhYmxlLnVzZXJJZCksXG4gIGluZGV4KCdwdXJjaGFzZWRfaXRlbV90eXBlX2lkeCcpLm9uKHRhYmxlLml0ZW1UeXBlKSxcbiAgLy8gQ29tcG9zaXRlIGluZGV4IGZvciBjaGVja2luZyBpZiBhIHVzZXIgb3ducyBhIHNwZWNpZmljIGl0ZW0gb2YgYSBzcGVjaWZpYyB0eXBlXG4gIGluZGV4KCdwdXJjaGFzZWRfaXRlbV91c2VyX2l0ZW1faWR4Jykub24odGFibGUudXNlcklkLCB0YWJsZS5pdGVtVHlwZSwgdGFibGUuaXRlbUlkKSxcbl0pKTtcblxuLy8gU3lzdGVtLWRlZmluZWQgcm9sZXMgLSB0aGVzZSBhcmUgYWx3YXlzIGF2YWlsYWJsZVxuZXhwb3J0IGNvbnN0IFNZU1RFTV9ST0xFU19FTlVNID0ge1xuICBPV05FUjogJ293bmVyJyxcbiAgQURNSU46ICdhZG1pbicsXG4gIE1FTUJFUjogJ21lbWJlcicsXG4gIEdVRVNUOiAnZ3Vlc3QnLFxufSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IHN5c3RlbVJvbGVUdXBsZSA9IE9iamVjdC52YWx1ZXMoU1lTVEVNX1JPTEVTX0VOVU0pIGFzIFtzdHJpbmcsIC4uLnN0cmluZ1tdXTtcblxuLy8gRGVmaW5lIGF2YWlsYWJsZSBwZXJtaXNzaW9uc1xuZXhwb3J0IGNvbnN0IFRFQU1fUEVSTUlTU0lPTlMgPSB7XG4gIC8vIFJlc291cmNlIGFjY2Vzc1xuICBBQ0NFU1NfREFTSEJPQVJEOiAnYWNjZXNzX2Rhc2hib2FyZCcsXG4gIEFDQ0VTU19CSUxMSU5HOiAnYWNjZXNzX2JpbGxpbmcnLFxuXG4gIC8vIFVzZXIgbWFuYWdlbWVudFxuICBJTlZJVEVfTUVNQkVSUzogJ2ludml0ZV9tZW1iZXJzJyxcbiAgUkVNT1ZFX01FTUJFUlM6ICdyZW1vdmVfbWVtYmVycycsXG4gIENIQU5HRV9NRU1CRVJfUk9MRVM6ICdjaGFuZ2VfbWVtYmVyX3JvbGVzJyxcblxuICAvLyBUZWFtIG1hbmFnZW1lbnRcbiAgRURJVF9URUFNX1NFVFRJTkdTOiAnZWRpdF90ZWFtX3NldHRpbmdzJyxcbiAgREVMRVRFX1RFQU06ICdkZWxldGVfdGVhbScsXG5cbiAgLy8gUm9sZSBtYW5hZ2VtZW50XG4gIENSRUFURV9ST0xFUzogJ2NyZWF0ZV9yb2xlcycsXG4gIEVESVRfUk9MRVM6ICdlZGl0X3JvbGVzJyxcbiAgREVMRVRFX1JPTEVTOiAnZGVsZXRlX3JvbGVzJyxcbiAgQVNTSUdOX1JPTEVTOiAnYXNzaWduX3JvbGVzJyxcblxuICAvLyBDb250ZW50IHBlcm1pc3Npb25zXG4gIENSRUFURV9DT01QT05FTlRTOiAnY3JlYXRlX2NvbXBvbmVudHMnLFxuICBFRElUX0NPTVBPTkVOVFM6ICdlZGl0X2NvbXBvbmVudHMnLFxuICBERUxFVEVfQ09NUE9ORU5UUzogJ2RlbGV0ZV9jb21wb25lbnRzJyxcblxuICAvLyBBZGQgbW9yZSBhcyBuZWVkZWRcbn0gYXMgY29uc3Q7XG5cbi8vIFRlYW0gdGFibGVcbmV4cG9ydCBjb25zdCB0ZWFtVGFibGUgPSBzcWxpdGVUYWJsZShcInRlYW1cIiwge1xuICAuLi5jb21tb25Db2x1bW5zLFxuICBpZDogdGV4dCgpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGB0ZWFtXyR7Y3JlYXRlSWQoKX1gKS5ub3ROdWxsKCksXG4gIG5hbWU6IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCksXG4gIHNsdWc6IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIGRlc2NyaXB0aW9uOiB0ZXh0KHsgbGVuZ3RoOiAxMDAwIH0pLFxuICBhdmF0YXJVcmw6IHRleHQoeyBsZW5ndGg6IDYwMCB9KSxcbiAgLy8gU2V0dGluZ3MgY291bGQgYmUgc3RvcmVkIGFzIEpTT05cbiAgc2V0dGluZ3M6IHRleHQoeyBsZW5ndGg6IDEwMDAwIH0pLFxuICAvLyBPcHRpb25hbCBiaWxsaW5nLXJlbGF0ZWQgZmllbGRzXG4gIGJpbGxpbmdFbWFpbDogdGV4dCh7IGxlbmd0aDogMjU1IH0pLFxuICBwbGFuSWQ6IHRleHQoeyBsZW5ndGg6IDEwMCB9KSxcbiAgcGxhbkV4cGlyZXNBdDogaW50ZWdlcih7IG1vZGU6IFwidGltZXN0YW1wXCIgfSksXG4gIGNyZWRpdEJhbGFuY2U6IGludGVnZXIoKS5kZWZhdWx0KDApLm5vdE51bGwoKSxcbn0sICh0YWJsZSkgPT4gKFtcbiAgaW5kZXgoJ3RlYW1fc2x1Z19pZHgnKS5vbih0YWJsZS5zbHVnKSxcbl0pKTtcblxuLy8gVGVhbSBtZW1iZXJzaGlwIHRhYmxlXG5leHBvcnQgY29uc3QgdGVhbU1lbWJlcnNoaXBUYWJsZSA9IHNxbGl0ZVRhYmxlKFwidGVhbV9tZW1iZXJzaGlwXCIsIHtcbiAgLi4uY29tbW9uQ29sdW1ucyxcbiAgaWQ6IHRleHQoKS5wcmltYXJ5S2V5KCkuJGRlZmF1bHRGbigoKSA9PiBgdG1lbV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxuICB0ZWFtSWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB0ZWFtVGFibGUuaWQpLFxuICB1c2VySWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2VyVGFibGUuaWQpLFxuICAvLyBUaGlzIGNhbiBiZSBlaXRoZXIgYSBzeXN0ZW0gcm9sZSBvciBhIGN1c3RvbSByb2xlIElEXG4gIHJvbGVJZDogdGV4dCgpLm5vdE51bGwoKSxcbiAgLy8gRmxhZyB0byBpbmRpY2F0ZSBpZiB0aGlzIGlzIGEgc3lzdGVtIHJvbGVcbiAgaXNTeXN0ZW1Sb2xlOiBpbnRlZ2VyKCkuZGVmYXVsdCgxKS5ub3ROdWxsKCksXG4gIGludml0ZWRCeTogdGV4dCgpLnJlZmVyZW5jZXMoKCkgPT4gdXNlclRhYmxlLmlkKSxcbiAgaW52aXRlZEF0OiBpbnRlZ2VyKHsgbW9kZTogXCJ0aW1lc3RhbXBcIiB9KSxcbiAgam9pbmVkQXQ6IGludGVnZXIoeyBtb2RlOiBcInRpbWVzdGFtcFwiIH0pLFxuICBleHBpcmVzQXQ6IGludGVnZXIoeyBtb2RlOiBcInRpbWVzdGFtcFwiIH0pLFxuICBpc0FjdGl2ZTogaW50ZWdlcigpLmRlZmF1bHQoMSkubm90TnVsbCgpLFxufSwgKHRhYmxlKSA9PiAoW1xuICBpbmRleCgndGVhbV9tZW1iZXJzaGlwX3RlYW1faWRfaWR4Jykub24odGFibGUudGVhbUlkKSxcbiAgaW5kZXgoJ3RlYW1fbWVtYmVyc2hpcF91c2VyX2lkX2lkeCcpLm9uKHRhYmxlLnVzZXJJZCksXG4gIC8vIEluc3RlYWQgb2YgdW5pcXVlKCkgd2hpY2ggY2F1c2VzIGxpbnRlciBlcnJvcnMsIHdlJ2xsIGNyZWF0ZSBhIHVuaXF1ZSBjb25zdHJhaW50IG9uIGNvbHVtbnNcbiAgaW5kZXgoJ3RlYW1fbWVtYmVyc2hpcF91bmlxdWVfaWR4Jykub24odGFibGUudGVhbUlkLCB0YWJsZS51c2VySWQpLFxuXSkpO1xuXG4vLyBUZWFtIHJvbGUgdGFibGVcbmV4cG9ydCBjb25zdCB0ZWFtUm9sZVRhYmxlID0gc3FsaXRlVGFibGUoXCJ0ZWFtX3JvbGVcIiwge1xuICAuLi5jb21tb25Db2x1bW5zLFxuICBpZDogdGV4dCgpLnByaW1hcnlLZXkoKS4kZGVmYXVsdEZuKCgpID0+IGB0cm9sZV8ke2NyZWF0ZUlkKCl9YCkubm90TnVsbCgpLFxuICB0ZWFtSWQ6IHRleHQoKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB0ZWFtVGFibGUuaWQpLFxuICBuYW1lOiB0ZXh0KHsgbGVuZ3RoOiAyNTUgfSkubm90TnVsbCgpLFxuICBkZXNjcmlwdGlvbjogdGV4dCh7IGxlbmd0aDogMTAwMCB9KSxcbiAgLy8gU3RvcmUgcGVybWlzc2lvbnMgYXMgYSBKU09OIGFycmF5IG9mIHBlcm1pc3Npb24ga2V5c1xuICBwZXJtaXNzaW9uczogdGV4dCh7IG1vZGU6ICdqc29uJyB9KS5ub3ROdWxsKCkuJHR5cGU8c3RyaW5nW10+KCksXG4gIC8vIEEgSlNPTiBmaWVsZCBmb3Igc3RvcmluZyBVSS1zcGVjaWZpYyBzZXR0aW5ncyBsaWtlIGNvbG9yLCBpY29uLCBldGMuXG4gIG1ldGFkYXRhOiB0ZXh0KHsgbGVuZ3RoOiA1MDAwIH0pLFxuICAvLyBPcHRpb25hbCBmbGFnIHRvIG1hcmsgc29tZSByb2xlcyBhcyBub24tZWRpdGFibGVcbiAgaXNFZGl0YWJsZTogaW50ZWdlcigpLmRlZmF1bHQoMSkubm90TnVsbCgpLFxufSwgKHRhYmxlKSA9PiAoW1xuICBpbmRleCgndGVhbV9yb2xlX3RlYW1faWRfaWR4Jykub24odGFibGUudGVhbUlkKSxcbiAgLy8gSW5zdGVhZCBvZiB1bmlxdWUoKSB3aGljaCBjYXVzZXMgbGludGVyIGVycm9ycywgd2UnbGwgY3JlYXRlIGEgdW5pcXVlIGNvbnN0cmFpbnQgb24gY29sdW1uc1xuICBpbmRleCgndGVhbV9yb2xlX25hbWVfdW5pcXVlX2lkeCcpLm9uKHRhYmxlLnRlYW1JZCwgdGFibGUubmFtZSksXG5dKSk7XG5cbi8vIFRlYW0gaW52aXRhdGlvbiB0YWJsZVxuZXhwb3J0IGNvbnN0IHRlYW1JbnZpdGF0aW9uVGFibGUgPSBzcWxpdGVUYWJsZShcInRlYW1faW52aXRhdGlvblwiLCB7XG4gIC4uLmNvbW1vbkNvbHVtbnMsXG4gIGlkOiB0ZXh0KCkucHJpbWFyeUtleSgpLiRkZWZhdWx0Rm4oKCkgPT4gYHRpbnZfJHtjcmVhdGVJZCgpfWApLm5vdE51bGwoKSxcbiAgdGVhbUlkOiB0ZXh0KCkubm90TnVsbCgpLnJlZmVyZW5jZXMoKCkgPT4gdGVhbVRhYmxlLmlkKSxcbiAgZW1haWw6IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCksXG4gIC8vIFRoaXMgY2FuIGJlIGVpdGhlciBhIHN5c3RlbSByb2xlIG9yIGEgY3VzdG9tIHJvbGUgSURcbiAgcm9sZUlkOiB0ZXh0KCkubm90TnVsbCgpLFxuICAvLyBGbGFnIHRvIGluZGljYXRlIGlmIHRoaXMgaXMgYSBzeXN0ZW0gcm9sZVxuICBpc1N5c3RlbVJvbGU6IGludGVnZXIoKS5kZWZhdWx0KDEpLm5vdE51bGwoKSxcbiAgdG9rZW46IHRleHQoeyBsZW5ndGg6IDI1NSB9KS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIGludml0ZWRCeTogdGV4dCgpLm5vdE51bGwoKS5yZWZlcmVuY2VzKCgpID0+IHVzZXJUYWJsZS5pZCksXG4gIGV4cGlyZXNBdDogaW50ZWdlcih7IG1vZGU6IFwidGltZXN0YW1wXCIgfSkubm90TnVsbCgpLFxuICBhY2NlcHRlZEF0OiBpbnRlZ2VyKHsgbW9kZTogXCJ0aW1lc3RhbXBcIiB9KSxcbiAgYWNjZXB0ZWRCeTogdGV4dCgpLnJlZmVyZW5jZXMoKCkgPT4gdXNlclRhYmxlLmlkKSxcbn0sICh0YWJsZSkgPT4gKFtcbiAgaW5kZXgoJ3RlYW1faW52aXRhdGlvbl90ZWFtX2lkX2lkeCcpLm9uKHRhYmxlLnRlYW1JZCksXG4gIGluZGV4KCd0ZWFtX2ludml0YXRpb25fZW1haWxfaWR4Jykub24odGFibGUuZW1haWwpLFxuICBpbmRleCgndGVhbV9pbnZpdGF0aW9uX3Rva2VuX2lkeCcpLm9uKHRhYmxlLnRva2VuKSxcbl0pKTtcblxuZXhwb3J0IGNvbnN0IHRlYW1SZWxhdGlvbnMgPSByZWxhdGlvbnModGVhbVRhYmxlLCAoeyBtYW55IH0pID0+ICh7XG4gIG1lbWJlcnNoaXBzOiBtYW55KHRlYW1NZW1iZXJzaGlwVGFibGUpLFxuICBpbnZpdGF0aW9uczogbWFueSh0ZWFtSW52aXRhdGlvblRhYmxlKSxcbiAgcm9sZXM6IG1hbnkodGVhbVJvbGVUYWJsZSksXG59KSk7XG5cbmV4cG9ydCBjb25zdCB0ZWFtUm9sZVJlbGF0aW9ucyA9IHJlbGF0aW9ucyh0ZWFtUm9sZVRhYmxlLCAoeyBvbmUgfSkgPT4gKHtcbiAgdGVhbTogb25lKHRlYW1UYWJsZSwge1xuICAgIGZpZWxkczogW3RlYW1Sb2xlVGFibGUudGVhbUlkXSxcbiAgICByZWZlcmVuY2VzOiBbdGVhbVRhYmxlLmlkXSxcbiAgfSksXG59KSk7XG5cbmV4cG9ydCBjb25zdCB0ZWFtTWVtYmVyc2hpcFJlbGF0aW9ucyA9IHJlbGF0aW9ucyh0ZWFtTWVtYmVyc2hpcFRhYmxlLCAoeyBvbmUgfSkgPT4gKHtcbiAgdGVhbTogb25lKHRlYW1UYWJsZSwge1xuICAgIGZpZWxkczogW3RlYW1NZW1iZXJzaGlwVGFibGUudGVhbUlkXSxcbiAgICByZWZlcmVuY2VzOiBbdGVhbVRhYmxlLmlkXSxcbiAgfSksXG4gIHVzZXI6IG9uZSh1c2VyVGFibGUsIHtcbiAgICBmaWVsZHM6IFt0ZWFtTWVtYmVyc2hpcFRhYmxlLnVzZXJJZF0sXG4gICAgcmVmZXJlbmNlczogW3VzZXJUYWJsZS5pZF0sXG4gIH0pLFxuICBpbnZpdGVkQnlVc2VyOiBvbmUodXNlclRhYmxlLCB7XG4gICAgZmllbGRzOiBbdGVhbU1lbWJlcnNoaXBUYWJsZS5pbnZpdGVkQnldLFxuICAgIHJlZmVyZW5jZXM6IFt1c2VyVGFibGUuaWRdLFxuICB9KSxcbn0pKTtcblxuZXhwb3J0IGNvbnN0IHRlYW1JbnZpdGF0aW9uUmVsYXRpb25zID0gcmVsYXRpb25zKHRlYW1JbnZpdGF0aW9uVGFibGUsICh7IG9uZSB9KSA9PiAoe1xuICB0ZWFtOiBvbmUodGVhbVRhYmxlLCB7XG4gICAgZmllbGRzOiBbdGVhbUludml0YXRpb25UYWJsZS50ZWFtSWRdLFxuICAgIHJlZmVyZW5jZXM6IFt0ZWFtVGFibGUuaWRdLFxuICB9KSxcbiAgaW52aXRlZEJ5VXNlcjogb25lKHVzZXJUYWJsZSwge1xuICAgIGZpZWxkczogW3RlYW1JbnZpdGF0aW9uVGFibGUuaW52aXRlZEJ5XSxcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcbiAgfSksXG4gIGFjY2VwdGVkQnlVc2VyOiBvbmUodXNlclRhYmxlLCB7XG4gICAgZmllbGRzOiBbdGVhbUludml0YXRpb25UYWJsZS5hY2NlcHRlZEJ5XSxcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcbiAgfSksXG59KSk7XG5cbmV4cG9ydCBjb25zdCBjcmVkaXRUcmFuc2FjdGlvblJlbGF0aW9ucyA9IHJlbGF0aW9ucyhjcmVkaXRUcmFuc2FjdGlvblRhYmxlLCAoeyBvbmUgfSkgPT4gKHtcbiAgdXNlcjogb25lKHVzZXJUYWJsZSwge1xuICAgIGZpZWxkczogW2NyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkXSxcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcbiAgfSksXG59KSk7XG5cbmV4cG9ydCBjb25zdCBwdXJjaGFzZWRJdGVtc1JlbGF0aW9ucyA9IHJlbGF0aW9ucyhwdXJjaGFzZWRJdGVtc1RhYmxlLCAoeyBvbmUgfSkgPT4gKHtcbiAgdXNlcjogb25lKHVzZXJUYWJsZSwge1xuICAgIGZpZWxkczogW3B1cmNoYXNlZEl0ZW1zVGFibGUudXNlcklkXSxcbiAgICByZWZlcmVuY2VzOiBbdXNlclRhYmxlLmlkXSxcbiAgfSksXG59KSk7XG5cbmV4cG9ydCBjb25zdCB1c2VyUmVsYXRpb25zID0gcmVsYXRpb25zKHVzZXJUYWJsZSwgKHsgbWFueSB9KSA9PiAoe1xuICBwYXNza2V5czogbWFueShwYXNzS2V5Q3JlZGVudGlhbFRhYmxlKSxcbiAgY3JlZGl0VHJhbnNhY3Rpb25zOiBtYW55KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUpLFxuICBwdXJjaGFzZWRJdGVtczogbWFueShwdXJjaGFzZWRJdGVtc1RhYmxlKSxcbiAgdGVhbU1lbWJlcnNoaXBzOiBtYW55KHRlYW1NZW1iZXJzaGlwVGFibGUpLFxufSkpO1xuXG5leHBvcnQgY29uc3QgcGFzc0tleUNyZWRlbnRpYWxSZWxhdGlvbnMgPSByZWxhdGlvbnMocGFzc0tleUNyZWRlbnRpYWxUYWJsZSwgKHsgb25lIH0pID0+ICh7XG4gIHVzZXI6IG9uZSh1c2VyVGFibGUsIHtcbiAgICBmaWVsZHM6IFtwYXNzS2V5Q3JlZGVudGlhbFRhYmxlLnVzZXJJZF0sXG4gICAgcmVmZXJlbmNlczogW3VzZXJUYWJsZS5pZF0sXG4gIH0pLFxufSkpO1xuXG5leHBvcnQgdHlwZSBVc2VyID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgdXNlclRhYmxlPjtcbmV4cG9ydCB0eXBlIFBhc3NLZXlDcmVkZW50aWFsID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgcGFzc0tleUNyZWRlbnRpYWxUYWJsZT47XG5leHBvcnQgdHlwZSBDcmVkaXRUcmFuc2FjdGlvbiA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIGNyZWRpdFRyYW5zYWN0aW9uVGFibGU+O1xuZXhwb3J0IHR5cGUgUHVyY2hhc2VkSXRlbSA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIHB1cmNoYXNlZEl0ZW1zVGFibGU+O1xuZXhwb3J0IHR5cGUgVGVhbSA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIHRlYW1UYWJsZT47XG5leHBvcnQgdHlwZSBUZWFtTWVtYmVyc2hpcCA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIHRlYW1NZW1iZXJzaGlwVGFibGU+O1xuZXhwb3J0IHR5cGUgVGVhbVJvbGUgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiB0ZWFtUm9sZVRhYmxlPjtcbmV4cG9ydCB0eXBlIFRlYW1JbnZpdGF0aW9uID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgdGVhbUludml0YXRpb25UYWJsZT47XG4iXSwibmFtZXMiOlsic3FsaXRlVGFibGUiLCJpbnRlZ2VyIiwidGV4dCIsImluZGV4IiwicmVsYXRpb25zIiwic3FsIiwiY3JlYXRlSWQiLCJST0xFU19FTlVNIiwiQURNSU4iLCJVU0VSIiwicm9sZVR1cGxlIiwiT2JqZWN0IiwidmFsdWVzIiwiY29tbW9uQ29sdW1ucyIsImNyZWF0ZWRBdCIsIm1vZGUiLCIkZGVmYXVsdEZuIiwiRGF0ZSIsIm5vdE51bGwiLCJ1cGRhdGVkQXQiLCIkb25VcGRhdGVGbiIsInVwZGF0ZUNvdW50ZXIiLCJkZWZhdWx0IiwiJG9uVXBkYXRlIiwidXNlclRhYmxlIiwiaWQiLCJwcmltYXJ5S2V5IiwiZmlyc3ROYW1lIiwibGVuZ3RoIiwibGFzdE5hbWUiLCJlbWFpbCIsInVuaXF1ZSIsInBhc3N3b3JkSGFzaCIsInJvbGUiLCJlbnVtIiwiZW1haWxWZXJpZmllZCIsInNpZ25VcElwQWRkcmVzcyIsImdvb2dsZUFjY291bnRJZCIsImF2YXRhciIsImN1cnJlbnRDcmVkaXRzIiwibGFzdENyZWRpdFJlZnJlc2hBdCIsInRhYmxlIiwib24iLCJwYXNzS2V5Q3JlZGVudGlhbFRhYmxlIiwidXNlcklkIiwicmVmZXJlbmNlcyIsImNyZWRlbnRpYWxJZCIsImNyZWRlbnRpYWxQdWJsaWNLZXkiLCJjb3VudGVyIiwidHJhbnNwb3J0cyIsImFhZ3VpZCIsInVzZXJBZ2VudCIsImlwQWRkcmVzcyIsIkNSRURJVF9UUkFOU0FDVElPTl9UWVBFIiwiUFVSQ0hBU0UiLCJVU0FHRSIsIk1PTlRITFlfUkVGUkVTSCIsImNyZWRpdFRyYW5zYWN0aW9uVHlwZVR1cGxlIiwiY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSIsImFtb3VudCIsInJlbWFpbmluZ0Ftb3VudCIsInR5cGUiLCJkZXNjcmlwdGlvbiIsImV4cGlyYXRpb25EYXRlIiwiZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdCIsInBheW1lbnRJbnRlbnRJZCIsIlBVUkNIQVNBQkxFX0lURU1fVFlQRSIsIkNPTVBPTkVOVCIsInB1cmNoYXNhYmxlSXRlbVR5cGVUdXBsZSIsInB1cmNoYXNlZEl0ZW1zVGFibGUiLCJpdGVtVHlwZSIsIml0ZW1JZCIsInB1cmNoYXNlZEF0IiwiU1lTVEVNX1JPTEVTX0VOVU0iLCJPV05FUiIsIk1FTUJFUiIsIkdVRVNUIiwic3lzdGVtUm9sZVR1cGxlIiwiVEVBTV9QRVJNSVNTSU9OUyIsIkFDQ0VTU19EQVNIQk9BUkQiLCJBQ0NFU1NfQklMTElORyIsIklOVklURV9NRU1CRVJTIiwiUkVNT1ZFX01FTUJFUlMiLCJDSEFOR0VfTUVNQkVSX1JPTEVTIiwiRURJVF9URUFNX1NFVFRJTkdTIiwiREVMRVRFX1RFQU0iLCJDUkVBVEVfUk9MRVMiLCJFRElUX1JPTEVTIiwiREVMRVRFX1JPTEVTIiwiQVNTSUdOX1JPTEVTIiwiQ1JFQVRFX0NPTVBPTkVOVFMiLCJFRElUX0NPTVBPTkVOVFMiLCJERUxFVEVfQ09NUE9ORU5UUyIsInRlYW1UYWJsZSIsIm5hbWUiLCJzbHVnIiwiYXZhdGFyVXJsIiwic2V0dGluZ3MiLCJiaWxsaW5nRW1haWwiLCJwbGFuSWQiLCJwbGFuRXhwaXJlc0F0IiwiY3JlZGl0QmFsYW5jZSIsInRlYW1NZW1iZXJzaGlwVGFibGUiLCJ0ZWFtSWQiLCJyb2xlSWQiLCJpc1N5c3RlbVJvbGUiLCJpbnZpdGVkQnkiLCJpbnZpdGVkQXQiLCJqb2luZWRBdCIsImV4cGlyZXNBdCIsImlzQWN0aXZlIiwidGVhbVJvbGVUYWJsZSIsInBlcm1pc3Npb25zIiwiJHR5cGUiLCJtZXRhZGF0YSIsImlzRWRpdGFibGUiLCJ0ZWFtSW52aXRhdGlvblRhYmxlIiwidG9rZW4iLCJhY2NlcHRlZEF0IiwiYWNjZXB0ZWRCeSIsInRlYW1SZWxhdGlvbnMiLCJtYW55IiwibWVtYmVyc2hpcHMiLCJpbnZpdGF0aW9ucyIsInJvbGVzIiwidGVhbVJvbGVSZWxhdGlvbnMiLCJvbmUiLCJ0ZWFtIiwiZmllbGRzIiwidGVhbU1lbWJlcnNoaXBSZWxhdGlvbnMiLCJ1c2VyIiwiaW52aXRlZEJ5VXNlciIsInRlYW1JbnZpdGF0aW9uUmVsYXRpb25zIiwiYWNjZXB0ZWRCeVVzZXIiLCJjcmVkaXRUcmFuc2FjdGlvblJlbGF0aW9ucyIsInB1cmNoYXNlZEl0ZW1zUmVsYXRpb25zIiwidXNlclJlbGF0aW9ucyIsInBhc3NrZXlzIiwiY3JlZGl0VHJhbnNhY3Rpb25zIiwicHVyY2hhc2VkSXRlbXMiLCJ0ZWFtTWVtYmVyc2hpcHMiLCJwYXNzS2V5Q3JlZGVudGlhbFJlbGF0aW9ucyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./src/flags.ts":
/*!**********************!*\
  !*** ./src/flags.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getConfig: () => (/* binding */ getConfig),\n/* harmony export */   isGoogleSSOEnabled: () => (/* binding */ isGoogleSSOEnabled),\n/* harmony export */   isTurnstileEnabled: () => (/* binding */ isTurnstileEnabled)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function isGoogleSSOEnabled() {\n    return Boolean(process.env.GOOGLE_CLIENT_ID && process.env.GOOGLE_CLIENT_SECRET);\n}\nasync function isTurnstileEnabled() {\n    return Boolean(process.env.TURNSTILE_SECRET_KEY);\n}\nconst getConfig = (0,react__WEBPACK_IMPORTED_MODULE_1__.cache)(async ()=>{\n    return {\n        isGoogleSSOEnabled: await isGoogleSSOEnabled(),\n        isTurnstileEnabled: await isTurnstileEnabled()\n    };\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZmxhZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFvQjtBQUVTO0FBRXRCLGVBQWVDO0lBQ3BCLE9BQU9DLFFBQVFDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCLElBQUlGLFFBQVFDLEdBQUcsQ0FBQ0Usb0JBQW9CO0FBQ2pGO0FBRU8sZUFBZUM7SUFDcEIsT0FBT0wsUUFBUUMsUUFBUUMsR0FBRyxDQUFDSSxvQkFBb0I7QUFDakQ7QUFFTyxNQUFNQyxZQUFZVCw0Q0FBS0EsQ0FBQztJQUM3QixPQUFPO1FBQ0xDLG9CQUFvQixNQUFNQTtRQUMxQk0sb0JBQW9CLE1BQU1BO0lBQzVCO0FBQ0YsR0FBRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx6YWludWxhYWJhaWRpblxcRG93bmxvYWRzXFxGaW5hbFByb2plY3QtbWFpblxcRmluYWxQcm9qZWN0LW1haW5cXHNyY1xcZmxhZ3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwic2VydmVyLW9ubHlcIlxuXG5pbXBvcnQgeyBjYWNoZSB9IGZyb20gXCJyZWFjdFwiXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0dvb2dsZVNTT0VuYWJsZWQoKSB7XG4gIHJldHVybiBCb29sZWFuKHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQgJiYgcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc1R1cm5zdGlsZUVuYWJsZWQoKSB7XG4gIHJldHVybiBCb29sZWFuKHByb2Nlc3MuZW52LlRVUk5TVElMRV9TRUNSRVRfS0VZKVxufVxuXG5leHBvcnQgY29uc3QgZ2V0Q29uZmlnID0gY2FjaGUoYXN5bmMgKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGlzR29vZ2xlU1NPRW5hYmxlZDogYXdhaXQgaXNHb29nbGVTU09FbmFibGVkKCksXG4gICAgaXNUdXJuc3RpbGVFbmFibGVkOiBhd2FpdCBpc1R1cm5zdGlsZUVuYWJsZWQoKSxcbiAgfVxufSlcbiJdLCJuYW1lcyI6WyJjYWNoZSIsImlzR29vZ2xlU1NPRW5hYmxlZCIsIkJvb2xlYW4iLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0NMSUVOVF9JRCIsIkdPT0dMRV9DTElFTlRfU0VDUkVUIiwiaXNUdXJuc3RpbGVFbmFibGVkIiwiVFVSTlNUSUxFX1NFQ1JFVF9LRVkiLCJnZXRDb25maWciXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/flags.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/try-catch.ts":
/*!******************************!*\
  !*** ./src/lib/try-catch.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   tryCatch: () => (/* binding */ tryCatch)\n/* harmony export */ });\n// Taken from https://gist.github.com/t3dotgg/a486c4ae66d32bf17c09c73609dacc5b\nasync function tryCatch(promise) {\n    try {\n        const data = await promise;\n        return {\n            data,\n            error: null\n        };\n    } catch (error) {\n        return {\n            data: null,\n            error: error\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3RyeS1jYXRjaC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBWUEsOEVBQThFO0FBQ3ZFLGVBQWVBLFNBQ3BCQyxPQUFtQjtJQUVuQixJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRDtRQUNuQixPQUFPO1lBQUVDO1lBQU1DLE9BQU87UUFBSztJQUM3QixFQUFFLE9BQU9BLE9BQU87UUFDZCxPQUFPO1lBQUVELE1BQU07WUFBTUMsT0FBT0E7UUFBVztJQUN6QztBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHphaW51bGFhYmFpZGluXFxEb3dubG9hZHNcXEZpbmFsUHJvamVjdC1tYWluXFxGaW5hbFByb2plY3QtbWFpblxcc3JjXFxsaWJcXHRyeS1jYXRjaC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIFN1Y2Nlc3M8VD4gPSB7XG4gIGRhdGE6IFQ7XG4gIGVycm9yOiBudWxsO1xufTtcblxudHlwZSBGYWlsdXJlPEU+ID0ge1xuICBkYXRhOiBudWxsO1xuICBlcnJvcjogRTtcbn07XG5cbnR5cGUgUmVzdWx0PFQsIEUgPSBFcnJvcj4gPSBTdWNjZXNzPFQ+IHwgRmFpbHVyZTxFPjtcblxuLy8gVGFrZW4gZnJvbSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS90M2RvdGdnL2E0ODZjNGFlNjZkMzJiZjE3YzA5YzczNjA5ZGFjYzViXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJ5Q2F0Y2g8VCwgRSA9IEVycm9yPihcbiAgcHJvbWlzZTogUHJvbWlzZTxUPixcbik6IFByb21pc2U8UmVzdWx0PFQsIEU+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHByb21pc2U7XG4gICAgcmV0dXJuIHsgZGF0YSwgZXJyb3I6IG51bGwgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvcjogZXJyb3IgYXMgRSB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsidHJ5Q2F0Y2giLCJwcm9taXNlIiwiZGF0YSIsImVycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/try-catch.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/auth.ts":
/*!***************************!*\
  !*** ./src/utils/auth.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   canSignUp: () => (/* binding */ canSignUp),\n/* harmony export */   createAndStoreSession: () => (/* binding */ createAndStoreSession),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   deleteSessionTokenCookie: () => (/* binding */ deleteSessionTokenCookie),\n/* harmony export */   generateSessionToken: () => (/* binding */ generateSessionToken),\n/* harmony export */   getSessionFromCookie: () => (/* binding */ getSessionFromCookie),\n/* harmony export */   getUserFromDB: () => (/* binding */ getUserFromDB),\n/* harmony export */   getUserTeamsWithPermissions: () => (/* binding */ getUserTeamsWithPermissions),\n/* harmony export */   invalidateSession: () => (/* binding */ invalidateSession),\n/* harmony export */   requireAdmin: () => (/* binding */ requireAdmin),\n/* harmony export */   requireVerifiedEmail: () => (/* binding */ requireVerifiedEmail),\n/* harmony export */   setSessionTokenCookie: () => (/* binding */ setSessionTokenCookie)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/db/schema */ \"(rsc)/./src/db/schema.ts\");\n/* harmony import */ var _paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @paralleldrive/cuid2 */ \"(rsc)/./node_modules/@paralleldrive/cuid2/index.js\");\n/* harmony import */ var _oslojs_encoding__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @oslojs/encoding */ \"(rsc)/./node_modules/@oslojs/encoding/dist/index.js\");\n/* harmony import */ var ms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ms */ \"(rsc)/./node_modules/ms/index.js\");\n/* harmony import */ var ms__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ms__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/db */ \"(rsc)/./src/db/index.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/is-prod */ \"(rsc)/./src/utils/is-prod.ts\");\n/* harmony import */ var _kv_session__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./kv-session */ \"(rsc)/./src/utils/kv-session.ts\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n/* harmony import */ var zsa__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! zsa */ \"(rsc)/./node_modules/zsa/dist/index.mjs\");\n/* harmony import */ var _credits__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./credits */ \"(rsc)/./src/utils/credits.ts\");\n/* harmony import */ var _name_initials__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./name-initials */ \"(rsc)/./src/utils/name-initials.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst getSessionLength = ()=>{\n    return ms__WEBPACK_IMPORTED_MODULE_4___default()(\"30d\");\n};\n/**\n * This file is based on https://lucia-auth.com\n */ async function getUserFromDB(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_5__.getDB)();\n    return await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.userTable.id, userId),\n        columns: {\n            id: true,\n            email: true,\n            firstName: true,\n            lastName: true,\n            role: true,\n            emailVerified: true,\n            avatar: true,\n            createdAt: true,\n            updatedAt: true,\n            currentCredits: true,\n            lastCreditRefreshAt: true\n        }\n    });\n}\nconst createId = (0,_paralleldrive_cuid2__WEBPACK_IMPORTED_MODULE_2__.init)({\n    length: 32\n});\nfunction generateSessionToken() {\n    return createId();\n}\nasync function generateSessionId(token) {\n    const hashBuffer = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(token));\n    return (0,_oslojs_encoding__WEBPACK_IMPORTED_MODULE_3__.encodeHexLowerCase)(new Uint8Array(hashBuffer));\n}\nfunction encodeSessionCookie(userId, token) {\n    return `${userId}:${token}`;\n}\nfunction decodeSessionCookie(cookie) {\n    const parts = cookie.split(':');\n    if (parts.length !== 2) return null;\n    return {\n        userId: parts[0],\n        token: parts[1]\n    };\n}\nasync function getUserTeamsWithPermissions(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_5__.getDB)();\n    // Get user's team memberships\n    const userTeamMemberships = await db.query.teamMembershipTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.teamMembershipTable.userId, userId),\n        with: {\n            team: true\n        }\n    });\n    // Fetch permissions for each membership\n    return Promise.all(userTeamMemberships.map(async (membership)=>{\n        let roleName = '';\n        let permissions = [];\n        // Handle system roles\n        if (membership.isSystemRole) {\n            roleName = membership.roleId; // For system roles, roleId contains the role name\n            // For system roles, get permissions based on role\n            if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.OWNER || membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.ADMIN) {\n                // Owners and admins have all permissions\n                permissions = Object.values(_db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS);\n            } else if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.MEMBER) {\n                // Default permissions for members\n                permissions = [\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.ACCESS_DASHBOARD,\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.CREATE_COMPONENTS,\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.EDIT_COMPONENTS\n                ];\n            } else if (membership.roleId === _db_schema__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_ROLES_ENUM.GUEST) {\n                // Guest permissions are limited\n                permissions = [\n                    _db_schema__WEBPACK_IMPORTED_MODULE_1__.TEAM_PERMISSIONS.ACCESS_DASHBOARD\n                ];\n            }\n        } else {\n            // Handle custom roles\n            const role = await db.query.teamRoleTable.findFirst({\n                where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_13__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_1__.teamRoleTable.id, membership.roleId)\n            });\n            if (role) {\n                roleName = role.name;\n                // Parse the stored JSON permissions\n                permissions = role.permissions;\n            }\n        }\n        return {\n            id: membership.teamId,\n            name: membership.team.name,\n            slug: membership.team.slug,\n            role: {\n                id: membership.roleId,\n                name: roleName,\n                isSystemRole: !!membership.isSystemRole\n            },\n            permissions\n        };\n    }));\n}\nasync function createSession({ token, userId, authenticationType, passkeyCredentialId }) {\n    const sessionId = await generateSessionId(token);\n    const expiresAt = new Date(Date.now() + getSessionLength());\n    const user = await getUserFromDB(userId);\n    if (!user) {\n        throw new Error(\"User not found\");\n    }\n    const teamsWithPermissions = await getUserTeamsWithPermissions(userId);\n    return (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.createKVSession)({\n        sessionId,\n        userId,\n        expiresAt,\n        user,\n        authenticationType,\n        passkeyCredentialId,\n        teams: teamsWithPermissions\n    });\n}\nasync function createAndStoreSession(userId, authenticationType, passkeyCredentialId) {\n    const sessionToken = generateSessionToken();\n    const session = await createSession({\n        token: sessionToken,\n        userId,\n        authenticationType,\n        passkeyCredentialId\n    });\n    await setSessionTokenCookie({\n        token: sessionToken,\n        userId,\n        expiresAt: new Date(session.expiresAt)\n    });\n}\nasync function validateSessionToken(token, userId) {\n    const sessionId = await generateSessionId(token);\n    const session = await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.getKVSession)(sessionId, userId);\n    if (!session) return null;\n    // If the session has expired, delete it and return null\n    if (Date.now() >= session.expiresAt) {\n        await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.deleteKVSession)(sessionId, userId);\n        return null;\n    }\n    // Check if session version needs to be updated\n    if (!session.version || session.version !== _kv_session__WEBPACK_IMPORTED_MODULE_8__.CURRENT_SESSION_VERSION) {\n        const updatedSession = await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.updateKVSession)(sessionId, userId, new Date(session.expiresAt));\n        if (!updatedSession) {\n            return null;\n        }\n        // Update the user initials\n        updatedSession.user.initials = (0,_name_initials__WEBPACK_IMPORTED_MODULE_12__.getInitials)(`${updatedSession.user.firstName} ${updatedSession.user.lastName}`);\n        return updatedSession;\n    }\n    // Check and refresh credits if needed\n    const currentCredits = await (0,_credits__WEBPACK_IMPORTED_MODULE_11__.addFreeMonthlyCreditsIfNeeded)(session);\n    // If credits were refreshed, update the session\n    if (session?.user?.currentCredits && currentCredits !== session.user.currentCredits) {\n        session.user.currentCredits = currentCredits;\n    }\n    // Update the user initials\n    session.user.initials = (0,_name_initials__WEBPACK_IMPORTED_MODULE_12__.getInitials)(`${session.user.firstName} ${session.user.lastName}`);\n    // Return the user data directly from the session\n    return session;\n}\nasync function invalidateSession(sessionId, userId) {\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_8__.deleteKVSession)(sessionId, userId);\n}\nasync function setSessionTokenCookie({ token, userId, expiresAt }) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    cookieStore.set(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME, encodeSessionCookie(userId, token), {\n        httpOnly: true,\n        sameSite: _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"] ? \"strict\" : \"lax\",\n        secure: _utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"],\n        expires: expiresAt,\n        path: \"/\"\n    });\n}\nasync function deleteSessionTokenCookie() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    cookieStore.delete(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME);\n}\n/**\n * This function can only be called in a Server Components, Server Action or Route Handler\n */ const getSessionFromCookie = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ()=>{\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_6__.cookies)();\n    const sessionCookie = cookieStore.get(_constants__WEBPACK_IMPORTED_MODULE_10__.SESSION_COOKIE_NAME)?.value;\n    if (!sessionCookie) {\n        return null;\n    }\n    const decoded = decodeSessionCookie(sessionCookie);\n    if (!decoded || !decoded.token || !decoded.userId) {\n        return null;\n    }\n    return validateSessionToken(decoded.token, decoded.userId);\n});\nconst requireVerifiedEmail = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ({ doNotThrowError = false } = {})=>{\n    const session = await getSessionFromCookie();\n    if (!session) {\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"NOT_AUTHORIZED\", \"Not authenticated\");\n    }\n    if (!session?.user?.emailVerified) {\n        if (doNotThrowError) {\n            return null;\n        }\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"FORBIDDEN\", \"Please verify your email first\");\n    }\n    return session;\n});\nconst requireAdmin = (0,react__WEBPACK_IMPORTED_MODULE_9__.cache)(async ({ doNotThrowError = false } = {})=>{\n    const session = await getSessionFromCookie();\n    if (!session) {\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"NOT_AUTHORIZED\", \"Not authenticated\");\n    }\n    if (session.user.role !== _db_schema__WEBPACK_IMPORTED_MODULE_1__.ROLES_ENUM.ADMIN) {\n        if (doNotThrowError) {\n            return null;\n        }\n        throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"FORBIDDEN\", \"Not authorized\");\n    }\n    return session;\n});\n/**\n * Checks if an email is disposable using debounce.io\n */ async function checkWithDebounce(email) {\n    try {\n        const response = await fetch(`https://disposable.debounce.io/?email=${encodeURIComponent(email)}`);\n        if (!response.ok) {\n            console.error(\"Debounce.io API error:\", response.status);\n            return {\n                success: false,\n                isDisposable: false\n            };\n        }\n        const data = await response.json();\n        return {\n            success: true,\n            isDisposable: data.disposable === \"true\"\n        };\n    } catch (error) {\n        console.error(\"Failed to check disposable email with debounce.io:\", error);\n        return {\n            success: false,\n            isDisposable: false\n        };\n    }\n}\n/**\n * Checks if an email is disposable using mailcheck.ai\n */ async function checkWithMailcheck(email) {\n    try {\n        const response = await fetch(`https://api.mailcheck.ai/email/${encodeURIComponent(email)}`);\n        if (!response.ok) {\n            console.error(\"Mailcheck.ai API error:\", response.status);\n            return {\n                success: false,\n                isDisposable: false\n            };\n        }\n        const data = await response.json();\n        return {\n            success: true,\n            isDisposable: data.disposable\n        };\n    } catch (error) {\n        console.error(\"Failed to check disposable email with mailcheck.ai:\", error);\n        return {\n            success: false,\n            isDisposable: false\n        };\n    }\n}\n/**\n * Checks if an email is allowed for sign up by verifying it's not a disposable email\n * Uses multiple services in sequence for redundancy.\n *\n * @throws {ZSAError} If email is disposable or if all services fail\n */ async function canSignUp({ email }) {\n    // Skip disposable email check in development\n    if (!_utils_is_prod__WEBPACK_IMPORTED_MODULE_7__[\"default\"]) {\n        return;\n    }\n    const validators = [\n        checkWithDebounce,\n        checkWithMailcheck\n    ];\n    for (const validator of validators){\n        const result = await validator(email);\n        // If the validator failed (network error, rate limit, etc), try the next one\n        if (!result.success) {\n            continue;\n        }\n        // If we got a successful response and it's disposable, reject the signup\n        if (result.isDisposable) {\n            throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"PRECONDITION_FAILED\", \"Disposable email addresses are not allowed\");\n        }\n        // If we got a successful response and it's not disposable, allow the signup\n        return;\n    }\n    // If all validators failed, we can't verify the email\n    throw new zsa__WEBPACK_IMPORTED_MODULE_14__.ZSAError(\"PRECONDITION_FAILED\", \"Unable to verify email address at this time. Please try again later.\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxNQUFNRSxTQUFTLE1BQU1ELFVBQVV6RztRQUUvQiw2RUFBNkU7UUFDN0UsSUFBSSxDQUFDMEcsT0FBT1QsT0FBTyxFQUFFO1lBQ25CO1FBQ0Y7UUFFQSx5RUFBeUU7UUFDekUsSUFBSVMsT0FBT1IsWUFBWSxFQUFFO1lBQ3ZCLE1BQU0sSUFBSTlHLDBDQUFRQSxDQUNoQix1QkFDQTtRQUVKO1FBRUEsNEVBQTRFO1FBQzVFO0lBQ0Y7SUFFQSxzREFBc0Q7SUFDdEQsTUFBTSxJQUFJQSwwQ0FBUUEsQ0FDaEIsdUJBQ0E7QUFFSiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx6YWludWxhYWJhaWRpblxcRG93bmxvYWRzXFxGaW5hbFByb2plY3QtbWFpblxcRmluYWxQcm9qZWN0LW1haW5cXHNyY1xcdXRpbHNcXGF1dGgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwic2VydmVyLW9ubHlcIjtcblxuaW1wb3J0IHsgUk9MRVNfRU5VTSwgdXNlclRhYmxlLCB0ZWFtTWVtYmVyc2hpcFRhYmxlLCBTWVNURU1fUk9MRVNfRU5VTSwgdGVhbVJvbGVUYWJsZSwgVEVBTV9QRVJNSVNTSU9OUyB9IGZyb20gXCJAL2RiL3NjaGVtYVwiO1xuaW1wb3J0IHsgaW5pdCB9IGZyb20gXCJAcGFyYWxsZWxkcml2ZS9jdWlkMlwiO1xuaW1wb3J0IHsgZW5jb2RlSGV4TG93ZXJDYXNlIH0gZnJvbSBcIkBvc2xvanMvZW5jb2RpbmdcIlxuaW1wb3J0IG1zIGZyb20gXCJtc1wiXG5pbXBvcnQgeyBnZXREQiB9IGZyb20gXCJAL2RiXCI7XG5pbXBvcnQgeyBlcSB9IGZyb20gXCJkcml6emxlLW9ybVwiO1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcbmltcG9ydCBpc1Byb2QgZnJvbSBcIkAvdXRpbHMvaXMtcHJvZFwiO1xuaW1wb3J0IHtcbiAgY3JlYXRlS1ZTZXNzaW9uLFxuICBkZWxldGVLVlNlc3Npb24sXG4gIHR5cGUgS1ZTZXNzaW9uLFxuICB0eXBlIENyZWF0ZUtWU2Vzc2lvblBhcmFtcyxcbiAgZ2V0S1ZTZXNzaW9uLFxuICB1cGRhdGVLVlNlc3Npb24sXG4gIENVUlJFTlRfU0VTU0lPTl9WRVJTSU9OXG59IGZyb20gXCIuL2t2LXNlc3Npb25cIjtcbmltcG9ydCB7IGNhY2hlIH0gZnJvbSBcInJlYWN0XCJcbmltcG9ydCB0eXBlIHsgU2Vzc2lvblZhbGlkYXRpb25SZXN1bHQgfSBmcm9tIFwiQC90eXBlc1wiO1xuaW1wb3J0IHsgU0VTU0lPTl9DT09LSUVfTkFNRSB9IGZyb20gXCJAL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgWlNBRXJyb3IgfSBmcm9tIFwienNhXCI7XG5pbXBvcnQgeyBhZGRGcmVlTW9udGhseUNyZWRpdHNJZk5lZWRlZCB9IGZyb20gXCIuL2NyZWRpdHNcIjtcbmltcG9ydCB7IGdldEluaXRpYWxzIH0gZnJvbSBcIi4vbmFtZS1pbml0aWFsc1wiO1xuXG5jb25zdCBnZXRTZXNzaW9uTGVuZ3RoID0gKCkgPT4ge1xuICByZXR1cm4gbXMoXCIzMGRcIik7XG59XG5cbi8qKlxuICogVGhpcyBmaWxlIGlzIGJhc2VkIG9uIGh0dHBzOi8vbHVjaWEtYXV0aC5jb21cbiAqL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckZyb21EQih1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBkYiA9IGdldERCKCk7XG4gIHJldHVybiBhd2FpdCBkYi5xdWVyeS51c2VyVGFibGUuZmluZEZpcnN0KHtcbiAgICB3aGVyZTogZXEodXNlclRhYmxlLmlkLCB1c2VySWQpLFxuICAgIGNvbHVtbnM6IHtcbiAgICAgIGlkOiB0cnVlLFxuICAgICAgZW1haWw6IHRydWUsXG4gICAgICBmaXJzdE5hbWU6IHRydWUsXG4gICAgICBsYXN0TmFtZTogdHJ1ZSxcbiAgICAgIHJvbGU6IHRydWUsXG4gICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgYXZhdGFyOiB0cnVlLFxuICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgdXBkYXRlZEF0OiB0cnVlLFxuICAgICAgY3VycmVudENyZWRpdHM6IHRydWUsXG4gICAgICBsYXN0Q3JlZGl0UmVmcmVzaEF0OiB0cnVlLFxuICAgIH0sXG4gIH0pO1xufVxuXG5jb25zdCBjcmVhdGVJZCA9IGluaXQoe1xuICBsZW5ndGg6IDMyLFxufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNlc3Npb25Ub2tlbigpOiBzdHJpbmcge1xuICByZXR1cm4gY3JlYXRlSWQoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVTZXNzaW9uSWQodG9rZW46IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGhhc2hCdWZmZXIgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZSh0b2tlbikpO1xuICByZXR1cm4gZW5jb2RlSGV4TG93ZXJDYXNlKG5ldyBVaW50OEFycmF5KGhhc2hCdWZmZXIpKTtcbn1cblxuZnVuY3Rpb24gZW5jb2RlU2Vzc2lvbkNvb2tpZSh1c2VySWQ6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBgJHt1c2VySWR9OiR7dG9rZW59YDtcbn1cblxuZnVuY3Rpb24gZGVjb2RlU2Vzc2lvbkNvb2tpZShjb29raWU6IHN0cmluZyk6IHsgdXNlcklkOiBzdHJpbmc7IHRva2VuOiBzdHJpbmcgfSB8IG51bGwge1xuICBjb25zdCBwYXJ0cyA9IGNvb2tpZS5zcGxpdCgnOicpO1xuICBpZiAocGFydHMubGVuZ3RoICE9PSAyKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHsgdXNlcklkOiBwYXJ0c1swXSwgdG9rZW46IHBhcnRzWzFdIH07XG59XG5cbmludGVyZmFjZSBDcmVhdGVTZXNzaW9uUGFyYW1zIGV4dGVuZHMgUGljazxDcmVhdGVLVlNlc3Npb25QYXJhbXMsIFwiYXV0aGVudGljYXRpb25UeXBlXCIgfCBcInBhc3NrZXlDcmVkZW50aWFsSWRcIiB8IFwidXNlcklkXCI+IHtcbiAgdG9rZW46IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJUZWFtc1dpdGhQZXJtaXNzaW9ucyh1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBkYiA9IGdldERCKCk7XG5cbiAgLy8gR2V0IHVzZXIncyB0ZWFtIG1lbWJlcnNoaXBzXG4gIGNvbnN0IHVzZXJUZWFtTWVtYmVyc2hpcHMgPSBhd2FpdCBkYi5xdWVyeS50ZWFtTWVtYmVyc2hpcFRhYmxlLmZpbmRNYW55KHtcbiAgICB3aGVyZTogZXEodGVhbU1lbWJlcnNoaXBUYWJsZS51c2VySWQsIHVzZXJJZCksXG4gICAgd2l0aDoge1xuICAgICAgdGVhbTogdHJ1ZSxcbiAgICB9LFxuICB9KTtcblxuICAvLyBGZXRjaCBwZXJtaXNzaW9ucyBmb3IgZWFjaCBtZW1iZXJzaGlwXG4gIHJldHVybiBQcm9taXNlLmFsbChcbiAgICB1c2VyVGVhbU1lbWJlcnNoaXBzLm1hcChhc3luYyAobWVtYmVyc2hpcCkgPT4ge1xuICAgICAgbGV0IHJvbGVOYW1lID0gJyc7XG4gICAgICBsZXQgcGVybWlzc2lvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICAgIC8vIEhhbmRsZSBzeXN0ZW0gcm9sZXNcbiAgICAgIGlmIChtZW1iZXJzaGlwLmlzU3lzdGVtUm9sZSkge1xuICAgICAgICByb2xlTmFtZSA9IG1lbWJlcnNoaXAucm9sZUlkOyAvLyBGb3Igc3lzdGVtIHJvbGVzLCByb2xlSWQgY29udGFpbnMgdGhlIHJvbGUgbmFtZVxuXG4gICAgICAgIC8vIEZvciBzeXN0ZW0gcm9sZXMsIGdldCBwZXJtaXNzaW9ucyBiYXNlZCBvbiByb2xlXG4gICAgICAgIGlmIChtZW1iZXJzaGlwLnJvbGVJZCA9PT0gU1lTVEVNX1JPTEVTX0VOVU0uT1dORVIgfHwgbWVtYmVyc2hpcC5yb2xlSWQgPT09IFNZU1RFTV9ST0xFU19FTlVNLkFETUlOKSB7XG4gICAgICAgICAgLy8gT3duZXJzIGFuZCBhZG1pbnMgaGF2ZSBhbGwgcGVybWlzc2lvbnNcbiAgICAgICAgICBwZXJtaXNzaW9ucyA9IE9iamVjdC52YWx1ZXMoVEVBTV9QRVJNSVNTSU9OUyk7XG4gICAgICAgIH0gZWxzZSBpZiAobWVtYmVyc2hpcC5yb2xlSWQgPT09IFNZU1RFTV9ST0xFU19FTlVNLk1FTUJFUikge1xuICAgICAgICAgIC8vIERlZmF1bHQgcGVybWlzc2lvbnMgZm9yIG1lbWJlcnNcbiAgICAgICAgICBwZXJtaXNzaW9ucyA9IFtcbiAgICAgICAgICAgIFRFQU1fUEVSTUlTU0lPTlMuQUNDRVNTX0RBU0hCT0FSRCxcbiAgICAgICAgICAgIFRFQU1fUEVSTUlTU0lPTlMuQ1JFQVRFX0NPTVBPTkVOVFMsXG4gICAgICAgICAgICBURUFNX1BFUk1JU1NJT05TLkVESVRfQ09NUE9ORU5UUyxcbiAgICAgICAgICBdO1xuICAgICAgICB9IGVsc2UgaWYgKG1lbWJlcnNoaXAucm9sZUlkID09PSBTWVNURU1fUk9MRVNfRU5VTS5HVUVTVCkge1xuICAgICAgICAgIC8vIEd1ZXN0IHBlcm1pc3Npb25zIGFyZSBsaW1pdGVkXG4gICAgICAgICAgcGVybWlzc2lvbnMgPSBbXG4gICAgICAgICAgICBURUFNX1BFUk1JU1NJT05TLkFDQ0VTU19EQVNIQk9BUkQsXG4gICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSGFuZGxlIGN1c3RvbSByb2xlc1xuICAgICAgICBjb25zdCByb2xlID0gYXdhaXQgZGIucXVlcnkudGVhbVJvbGVUYWJsZS5maW5kRmlyc3Qoe1xuICAgICAgICAgIHdoZXJlOiBlcSh0ZWFtUm9sZVRhYmxlLmlkLCBtZW1iZXJzaGlwLnJvbGVJZCksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChyb2xlKSB7XG4gICAgICAgICAgcm9sZU5hbWUgPSByb2xlLm5hbWU7XG4gICAgICAgICAgLy8gUGFyc2UgdGhlIHN0b3JlZCBKU09OIHBlcm1pc3Npb25zXG4gICAgICAgICAgcGVybWlzc2lvbnMgPSByb2xlLnBlcm1pc3Npb25zIGFzIHN0cmluZ1tdO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBtZW1iZXJzaGlwLnRlYW1JZCxcbiAgICAgICAgbmFtZTogbWVtYmVyc2hpcC50ZWFtLm5hbWUsXG4gICAgICAgIHNsdWc6IG1lbWJlcnNoaXAudGVhbS5zbHVnLFxuICAgICAgICByb2xlOiB7XG4gICAgICAgICAgaWQ6IG1lbWJlcnNoaXAucm9sZUlkLFxuICAgICAgICAgIG5hbWU6IHJvbGVOYW1lLFxuICAgICAgICAgIGlzU3lzdGVtUm9sZTogISFtZW1iZXJzaGlwLmlzU3lzdGVtUm9sZSxcbiAgICAgICAgfSxcbiAgICAgICAgcGVybWlzc2lvbnMsXG4gICAgICB9O1xuICAgIH0pXG4gICk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTZXNzaW9uKHtcbiAgdG9rZW4sXG4gIHVzZXJJZCxcbiAgYXV0aGVudGljYXRpb25UeXBlLFxuICBwYXNza2V5Q3JlZGVudGlhbElkXG59OiBDcmVhdGVTZXNzaW9uUGFyYW1zKTogUHJvbWlzZTxLVlNlc3Npb24+IHtcbiAgY29uc3Qgc2Vzc2lvbklkID0gYXdhaXQgZ2VuZXJhdGVTZXNzaW9uSWQodG9rZW4pO1xuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgZ2V0U2Vzc2lvbkxlbmd0aCgpKTtcblxuICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckZyb21EQih1c2VySWQpO1xuXG4gIGlmICghdXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlVzZXIgbm90IGZvdW5kXCIpO1xuICB9XG5cbiAgY29uc3QgdGVhbXNXaXRoUGVybWlzc2lvbnMgPSBhd2FpdCBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkKTtcblxuICByZXR1cm4gY3JlYXRlS1ZTZXNzaW9uKHtcbiAgICBzZXNzaW9uSWQsXG4gICAgdXNlcklkLFxuICAgIGV4cGlyZXNBdCxcbiAgICB1c2VyLFxuICAgIGF1dGhlbnRpY2F0aW9uVHlwZSxcbiAgICBwYXNza2V5Q3JlZGVudGlhbElkLFxuICAgIHRlYW1zOiB0ZWFtc1dpdGhQZXJtaXNzaW9uc1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFuZFN0b3JlU2Vzc2lvbihcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGF1dGhlbnRpY2F0aW9uVHlwZT86IENyZWF0ZUtWU2Vzc2lvblBhcmFtc1tcImF1dGhlbnRpY2F0aW9uVHlwZVwiXSxcbiAgcGFzc2tleUNyZWRlbnRpYWxJZD86IENyZWF0ZUtWU2Vzc2lvblBhcmFtc1tcInBhc3NrZXlDcmVkZW50aWFsSWRcIl1cbikge1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBnZW5lcmF0ZVNlc3Npb25Ub2tlbigpO1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3JlYXRlU2Vzc2lvbih7XG4gICAgdG9rZW46IHNlc3Npb25Ub2tlbixcbiAgICB1c2VySWQsXG4gICAgYXV0aGVudGljYXRpb25UeXBlLFxuICAgIHBhc3NrZXlDcmVkZW50aWFsSWRcbiAgfSk7XG4gIGF3YWl0IHNldFNlc3Npb25Ub2tlbkNvb2tpZSh7XG4gICAgdG9rZW46IHNlc3Npb25Ub2tlbixcbiAgICB1c2VySWQsXG4gICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzZXNzaW9uLmV4cGlyZXNBdClcbiAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlU2Vzc2lvblRva2VuKHRva2VuOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTZXNzaW9uVmFsaWRhdGlvblJlc3VsdCB8IG51bGw+IHtcbiAgY29uc3Qgc2Vzc2lvbklkID0gYXdhaXQgZ2VuZXJhdGVTZXNzaW9uSWQodG9rZW4pO1xuXG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRLVlNlc3Npb24oc2Vzc2lvbklkLCB1c2VySWQpO1xuXG4gIGlmICghc2Vzc2lvbikgcmV0dXJuIG51bGw7XG5cbiAgLy8gSWYgdGhlIHNlc3Npb24gaGFzIGV4cGlyZWQsIGRlbGV0ZSBpdCBhbmQgcmV0dXJuIG51bGxcbiAgaWYgKERhdGUubm93KCkgPj0gc2Vzc2lvbi5leHBpcmVzQXQpIHtcbiAgICBhd2FpdCBkZWxldGVLVlNlc3Npb24oc2Vzc2lvbklkLCB1c2VySWQpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gQ2hlY2sgaWYgc2Vzc2lvbiB2ZXJzaW9uIG5lZWRzIHRvIGJlIHVwZGF0ZWRcbiAgaWYgKCFzZXNzaW9uLnZlcnNpb24gfHwgc2Vzc2lvbi52ZXJzaW9uICE9PSBDVVJSRU5UX1NFU1NJT05fVkVSU0lPTikge1xuICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uID0gYXdhaXQgdXBkYXRlS1ZTZXNzaW9uKHNlc3Npb25JZCwgdXNlcklkLCBuZXcgRGF0ZShzZXNzaW9uLmV4cGlyZXNBdCkpO1xuXG4gICAgaWYgKCF1cGRhdGVkU2Vzc2lvbikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSB1c2VyIGluaXRpYWxzXG4gICAgdXBkYXRlZFNlc3Npb24udXNlci5pbml0aWFscyA9IGdldEluaXRpYWxzKGAke3VwZGF0ZWRTZXNzaW9uLnVzZXIuZmlyc3ROYW1lfSAke3VwZGF0ZWRTZXNzaW9uLnVzZXIubGFzdE5hbWV9YCk7XG5cbiAgICByZXR1cm4gdXBkYXRlZFNlc3Npb247XG4gIH1cblxuICAvLyBDaGVjayBhbmQgcmVmcmVzaCBjcmVkaXRzIGlmIG5lZWRlZFxuICBjb25zdCBjdXJyZW50Q3JlZGl0cyA9IGF3YWl0IGFkZEZyZWVNb250aGx5Q3JlZGl0c0lmTmVlZGVkKHNlc3Npb24pO1xuXG4gIC8vIElmIGNyZWRpdHMgd2VyZSByZWZyZXNoZWQsIHVwZGF0ZSB0aGUgc2Vzc2lvblxuICBpZiAoXG4gICAgc2Vzc2lvbj8udXNlcj8uY3VycmVudENyZWRpdHMgJiZcbiAgICBjdXJyZW50Q3JlZGl0cyAhPT0gc2Vzc2lvbi51c2VyLmN1cnJlbnRDcmVkaXRzXG4gICkge1xuICAgIHNlc3Npb24udXNlci5jdXJyZW50Q3JlZGl0cyA9IGN1cnJlbnRDcmVkaXRzO1xuICB9XG5cbiAgLy8gVXBkYXRlIHRoZSB1c2VyIGluaXRpYWxzXG4gIHNlc3Npb24udXNlci5pbml0aWFscyA9IGdldEluaXRpYWxzKGAke3Nlc3Npb24udXNlci5maXJzdE5hbWV9ICR7c2Vzc2lvbi51c2VyLmxhc3ROYW1lfWApO1xuXG4gIC8vIFJldHVybiB0aGUgdXNlciBkYXRhIGRpcmVjdGx5IGZyb20gdGhlIHNlc3Npb25cbiAgcmV0dXJuIHNlc3Npb247XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnZhbGlkYXRlU2Vzc2lvbihzZXNzaW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgZGVsZXRlS1ZTZXNzaW9uKHNlc3Npb25JZCwgdXNlcklkKTtcbn1cblxuaW50ZXJmYWNlIFNldFNlc3Npb25Ub2tlbkNvb2tpZVBhcmFtcyB7XG4gIHRva2VuOiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBleHBpcmVzQXQ6IERhdGU7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uVG9rZW5Db29raWUoeyB0b2tlbiwgdXNlcklkLCBleHBpcmVzQXQgfTogU2V0U2Vzc2lvblRva2VuQ29va2llUGFyYW1zKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICBjb29raWVTdG9yZS5zZXQoU0VTU0lPTl9DT09LSUVfTkFNRSwgZW5jb2RlU2Vzc2lvbkNvb2tpZSh1c2VySWQsIHRva2VuKSwge1xuICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgIHNhbWVTaXRlOiBpc1Byb2QgPyBcInN0cmljdFwiIDogXCJsYXhcIixcbiAgICBzZWN1cmU6IGlzUHJvZCxcbiAgICBleHBpcmVzOiBleHBpcmVzQXQsXG4gICAgcGF0aDogXCIvXCIsXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2Vzc2lvblRva2VuQ29va2llKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcbiAgY29va2llU3RvcmUuZGVsZXRlKFNFU1NJT05fQ09PS0lFX05BTUUpO1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gY2FuIG9ubHkgYmUgY2FsbGVkIGluIGEgU2VydmVyIENvbXBvbmVudHMsIFNlcnZlciBBY3Rpb24gb3IgUm91dGUgSGFuZGxlclxuICovXG5leHBvcnQgY29uc3QgZ2V0U2Vzc2lvbkZyb21Db29raWUgPSBjYWNoZShhc3luYyAoKTogUHJvbWlzZTxTZXNzaW9uVmFsaWRhdGlvblJlc3VsdCB8IG51bGw+ID0+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG4gIGNvbnN0IHNlc3Npb25Db29raWUgPSBjb29raWVTdG9yZS5nZXQoU0VTU0lPTl9DT09LSUVfTkFNRSk/LnZhbHVlO1xuXG4gIGlmICghc2Vzc2lvbkNvb2tpZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgZGVjb2RlZCA9IGRlY29kZVNlc3Npb25Db29raWUoc2Vzc2lvbkNvb2tpZSk7XG5cbiAgaWYgKCFkZWNvZGVkIHx8ICFkZWNvZGVkLnRva2VuIHx8ICFkZWNvZGVkLnVzZXJJZCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIHZhbGlkYXRlU2Vzc2lvblRva2VuKGRlY29kZWQudG9rZW4sIGRlY29kZWQudXNlcklkKTtcbn0pXG5cbmV4cG9ydCBjb25zdCByZXF1aXJlVmVyaWZpZWRFbWFpbCA9IGNhY2hlKGFzeW5jICh7XG4gIGRvTm90VGhyb3dFcnJvciA9IGZhbHNlLFxufToge1xuICBkb05vdFRocm93RXJyb3I/OiBib29sZWFuO1xufSA9IHt9KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUNvb2tpZSgpO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHRocm93IG5ldyBaU0FFcnJvcihcIk5PVF9BVVRIT1JJWkVEXCIsIFwiTm90IGF1dGhlbnRpY2F0ZWRcIik7XG4gIH1cblxuICBpZiAoIXNlc3Npb24/LnVzZXI/LmVtYWlsVmVyaWZpZWQpIHtcbiAgICBpZiAoZG9Ob3RUaHJvd0Vycm9yKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgWlNBRXJyb3IoXCJGT1JCSURERU5cIiwgXCJQbGVhc2UgdmVyaWZ5IHlvdXIgZW1haWwgZmlyc3RcIik7XG4gIH1cblxuICByZXR1cm4gc2Vzc2lvbjtcbn0pO1xuXG5leHBvcnQgY29uc3QgcmVxdWlyZUFkbWluID0gY2FjaGUoYXN5bmMgKHtcbiAgZG9Ob3RUaHJvd0Vycm9yID0gZmFsc2UsXG59OiB7XG4gIGRvTm90VGhyb3dFcnJvcj86IGJvb2xlYW47XG59ID0ge30pID0+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ29va2llKCk7XG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IFpTQUVycm9yKFwiTk9UX0FVVEhPUklaRURcIiwgXCJOb3QgYXV0aGVudGljYXRlZFwiKTtcbiAgfVxuXG4gIGlmIChzZXNzaW9uLnVzZXIucm9sZSAhPT0gUk9MRVNfRU5VTS5BRE1JTikge1xuICAgIGlmIChkb05vdFRocm93RXJyb3IpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRocm93IG5ldyBaU0FFcnJvcihcIkZPUkJJRERFTlwiLCBcIk5vdCBhdXRob3JpemVkXCIpO1xuICB9XG5cbiAgcmV0dXJuIHNlc3Npb247XG59KTtcblxuaW50ZXJmYWNlIERpc3Bvc2FibGVFbWFpbFJlc3BvbnNlIHtcbiAgZGlzcG9zYWJsZTogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgTWFpbGNoZWNrUmVzcG9uc2Uge1xuICBzdGF0dXM6IG51bWJlcjtcbiAgZW1haWw6IHN0cmluZztcbiAgZG9tYWluOiBzdHJpbmc7XG4gIG14OiBib29sZWFuO1xuICBkaXNwb3NhYmxlOiBib29sZWFuO1xuICBwdWJsaWNfZG9tYWluOiBib29sZWFuO1xuICByZWxheV9kb21haW46IGJvb2xlYW47XG4gIGFsaWFzOiBib29sZWFuO1xuICByb2xlX2FjY291bnQ6IGJvb2xlYW47XG4gIGRpZF95b3VfbWVhbjogc3RyaW5nIHwgbnVsbDtcbn1cblxudHlwZSBWYWxpZGF0b3JSZXN1bHQgPSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGlzRGlzcG9zYWJsZTogYm9vbGVhbjtcbn07XG5cbi8qKlxuICogQ2hlY2tzIGlmIGFuIGVtYWlsIGlzIGRpc3Bvc2FibGUgdXNpbmcgZGVib3VuY2UuaW9cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY2hlY2tXaXRoRGVib3VuY2UoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VmFsaWRhdG9yUmVzdWx0PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9kaXNwb3NhYmxlLmRlYm91bmNlLmlvLz9lbWFpbD0ke2VuY29kZVVSSUNvbXBvbmVudChlbWFpbCl9YCk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRGVib3VuY2UuaW8gQVBJIGVycm9yOlwiLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGlzRGlzcG9zYWJsZTogZmFsc2UgfTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIERpc3Bvc2FibGVFbWFpbFJlc3BvbnNlO1xuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaXNEaXNwb3NhYmxlOiBkYXRhLmRpc3Bvc2FibGUgPT09IFwidHJ1ZVwiIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBjaGVjayBkaXNwb3NhYmxlIGVtYWlsIHdpdGggZGVib3VuY2UuaW86XCIsIGVycm9yKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgaXNEaXNwb3NhYmxlOiBmYWxzZSB9O1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGFuIGVtYWlsIGlzIGRpc3Bvc2FibGUgdXNpbmcgbWFpbGNoZWNrLmFpXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrV2l0aE1haWxjaGVjayhlbWFpbDogc3RyaW5nKTogUHJvbWlzZTxWYWxpZGF0b3JSZXN1bHQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5tYWlsY2hlY2suYWkvZW1haWwvJHtlbmNvZGVVUklDb21wb25lbnQoZW1haWwpfWApO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS5lcnJvcihcIk1haWxjaGVjay5haSBBUEkgZXJyb3I6XCIsIHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgaXNEaXNwb3NhYmxlOiBmYWxzZSB9O1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgTWFpbGNoZWNrUmVzcG9uc2U7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaXNEaXNwb3NhYmxlOiBkYXRhLmRpc3Bvc2FibGUgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNoZWNrIGRpc3Bvc2FibGUgZW1haWwgd2l0aCBtYWlsY2hlY2suYWk6XCIsIGVycm9yKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgaXNEaXNwb3NhYmxlOiBmYWxzZSB9O1xuICB9XG59XG5cblxuLyoqXG4gKiBDaGVja3MgaWYgYW4gZW1haWwgaXMgYWxsb3dlZCBmb3Igc2lnbiB1cCBieSB2ZXJpZnlpbmcgaXQncyBub3QgYSBkaXNwb3NhYmxlIGVtYWlsXG4gKiBVc2VzIG11bHRpcGxlIHNlcnZpY2VzIGluIHNlcXVlbmNlIGZvciByZWR1bmRhbmN5LlxuICpcbiAqIEB0aHJvd3Mge1pTQUVycm9yfSBJZiBlbWFpbCBpcyBkaXNwb3NhYmxlIG9yIGlmIGFsbCBzZXJ2aWNlcyBmYWlsXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYW5TaWduVXAoeyBlbWFpbCB9OiB7IGVtYWlsOiBzdHJpbmcgfSk6IFByb21pc2U8dm9pZD4ge1xuICAvLyBTa2lwIGRpc3Bvc2FibGUgZW1haWwgY2hlY2sgaW4gZGV2ZWxvcG1lbnRcbiAgaWYgKCFpc1Byb2QpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB2YWxpZGF0b3JzID0gW1xuICAgIGNoZWNrV2l0aERlYm91bmNlLFxuICAgIGNoZWNrV2l0aE1haWxjaGVjayxcbiAgXTtcblxuICBmb3IgKGNvbnN0IHZhbGlkYXRvciBvZiB2YWxpZGF0b3JzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdmFsaWRhdG9yKGVtYWlsKTtcblxuICAgIC8vIElmIHRoZSB2YWxpZGF0b3IgZmFpbGVkIChuZXR3b3JrIGVycm9yLCByYXRlIGxpbWl0LCBldGMpLCB0cnkgdGhlIG5leHQgb25lXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgZ290IGEgc3VjY2Vzc2Z1bCByZXNwb25zZSBhbmQgaXQncyBkaXNwb3NhYmxlLCByZWplY3QgdGhlIHNpZ251cFxuICAgIGlmIChyZXN1bHQuaXNEaXNwb3NhYmxlKSB7XG4gICAgICB0aHJvdyBuZXcgWlNBRXJyb3IoXG4gICAgICAgIFwiUFJFQ09ORElUSU9OX0ZBSUxFRFwiLFxuICAgICAgICBcIkRpc3Bvc2FibGUgZW1haWwgYWRkcmVzc2VzIGFyZSBub3QgYWxsb3dlZFwiXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIElmIHdlIGdvdCBhIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgYW5kIGl0J3Mgbm90IGRpc3Bvc2FibGUsIGFsbG93IHRoZSBzaWdudXBcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBJZiBhbGwgdmFsaWRhdG9ycyBmYWlsZWQsIHdlIGNhbid0IHZlcmlmeSB0aGUgZW1haWxcbiAgdGhyb3cgbmV3IFpTQUVycm9yKFxuICAgIFwiUFJFQ09ORElUSU9OX0ZBSUxFRFwiLFxuICAgIFwiVW5hYmxlIHRvIHZlcmlmeSBlbWFpbCBhZGRyZXNzIGF0IHRoaXMgdGltZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIlxuICApO1xufVxuIl0sIm5hbWVzIjpbIlJPTEVTX0VOVU0iLCJ1c2VyVGFibGUiLCJ0ZWFtTWVtYmVyc2hpcFRhYmxlIiwiU1lTVEVNX1JPTEVTX0VOVU0iLCJ0ZWFtUm9sZVRhYmxlIiwiVEVBTV9QRVJNSVNTSU9OUyIsImluaXQiLCJlbmNvZGVIZXhMb3dlckNhc2UiLCJtcyIsImdldERCIiwiZXEiLCJjb29raWVzIiwiaXNQcm9kIiwiY3JlYXRlS1ZTZXNzaW9uIiwiZGVsZXRlS1ZTZXNzaW9uIiwiZ2V0S1ZTZXNzaW9uIiwidXBkYXRlS1ZTZXNzaW9uIiwiQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT04iLCJjYWNoZSIsIlNFU1NJT05fQ09PS0lFX05BTUUiLCJaU0FFcnJvciIsImFkZEZyZWVNb250aGx5Q3JlZGl0c0lmTmVlZGVkIiwiZ2V0SW5pdGlhbHMiLCJnZXRTZXNzaW9uTGVuZ3RoIiwiZ2V0VXNlckZyb21EQiIsInVzZXJJZCIsImRiIiwicXVlcnkiLCJmaW5kRmlyc3QiLCJ3aGVyZSIsImlkIiwiY29sdW1ucyIsImVtYWlsIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJyb2xlIiwiZW1haWxWZXJpZmllZCIsImF2YXRhciIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImN1cnJlbnRDcmVkaXRzIiwibGFzdENyZWRpdFJlZnJlc2hBdCIsImNyZWF0ZUlkIiwibGVuZ3RoIiwiZ2VuZXJhdGVTZXNzaW9uVG9rZW4iLCJnZW5lcmF0ZVNlc3Npb25JZCIsInRva2VuIiwiaGFzaEJ1ZmZlciIsImNyeXB0byIsInN1YnRsZSIsImRpZ2VzdCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwiVWludDhBcnJheSIsImVuY29kZVNlc3Npb25Db29raWUiLCJkZWNvZGVTZXNzaW9uQ29va2llIiwiY29va2llIiwicGFydHMiLCJzcGxpdCIsImdldFVzZXJUZWFtc1dpdGhQZXJtaXNzaW9ucyIsInVzZXJUZWFtTWVtYmVyc2hpcHMiLCJmaW5kTWFueSIsIndpdGgiLCJ0ZWFtIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm1lbWJlcnNoaXAiLCJyb2xlTmFtZSIsInBlcm1pc3Npb25zIiwiaXNTeXN0ZW1Sb2xlIiwicm9sZUlkIiwiT1dORVIiLCJBRE1JTiIsIk9iamVjdCIsInZhbHVlcyIsIk1FTUJFUiIsIkFDQ0VTU19EQVNIQk9BUkQiLCJDUkVBVEVfQ09NUE9ORU5UUyIsIkVESVRfQ09NUE9ORU5UUyIsIkdVRVNUIiwibmFtZSIsInRlYW1JZCIsInNsdWciLCJjcmVhdGVTZXNzaW9uIiwiYXV0aGVudGljYXRpb25UeXBlIiwicGFzc2tleUNyZWRlbnRpYWxJZCIsInNlc3Npb25JZCIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJ1c2VyIiwiRXJyb3IiLCJ0ZWFtc1dpdGhQZXJtaXNzaW9ucyIsInRlYW1zIiwiY3JlYXRlQW5kU3RvcmVTZXNzaW9uIiwic2Vzc2lvblRva2VuIiwic2Vzc2lvbiIsInNldFNlc3Npb25Ub2tlbkNvb2tpZSIsInZhbGlkYXRlU2Vzc2lvblRva2VuIiwidmVyc2lvbiIsInVwZGF0ZWRTZXNzaW9uIiwiaW5pdGlhbHMiLCJpbnZhbGlkYXRlU2Vzc2lvbiIsImNvb2tpZVN0b3JlIiwic2V0IiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsInNlY3VyZSIsImV4cGlyZXMiLCJwYXRoIiwiZGVsZXRlU2Vzc2lvblRva2VuQ29va2llIiwiZGVsZXRlIiwiZ2V0U2Vzc2lvbkZyb21Db29raWUiLCJzZXNzaW9uQ29va2llIiwiZ2V0IiwidmFsdWUiLCJkZWNvZGVkIiwicmVxdWlyZVZlcmlmaWVkRW1haWwiLCJkb05vdFRocm93RXJyb3IiLCJyZXF1aXJlQWRtaW4iLCJjaGVja1dpdGhEZWJvdW5jZSIsInJlc3BvbnNlIiwiZmV0Y2giLCJlbmNvZGVVUklDb21wb25lbnQiLCJvayIsImNvbnNvbGUiLCJlcnJvciIsInN0YXR1cyIsInN1Y2Nlc3MiLCJpc0Rpc3Bvc2FibGUiLCJkYXRhIiwianNvbiIsImRpc3Bvc2FibGUiLCJjaGVja1dpdGhNYWlsY2hlY2siLCJjYW5TaWduVXAiLCJ2YWxpZGF0b3JzIiwidmFsaWRhdG9yIiwicmVzdWx0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/credits.ts":
/*!******************************!*\
  !*** ./src/utils/credits.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addFreeMonthlyCreditsIfNeeded: () => (/* binding */ addFreeMonthlyCreditsIfNeeded),\n/* harmony export */   consumeCredits: () => (/* binding */ consumeCredits),\n/* harmony export */   getCreditPackage: () => (/* binding */ getCreditPackage),\n/* harmony export */   getCreditTransactions: () => (/* binding */ getCreditTransactions),\n/* harmony export */   getUserPurchasedItems: () => (/* binding */ getUserPurchasedItems),\n/* harmony export */   hasEnoughCredits: () => (/* binding */ hasEnoughCredits),\n/* harmony export */   logTransaction: () => (/* binding */ logTransaction),\n/* harmony export */   updateUserCredits: () => (/* binding */ updateUserCredits)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/select.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/db */ \"(rsc)/./src/db/index.ts\");\n/* harmony import */ var _db_schema__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/db/schema */ \"(rsc)/./src/db/schema.ts\");\n/* harmony import */ var _kv_session__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kv-session */ \"(rsc)/./src/utils/kv-session.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n\n\n\n\n\n\nfunction getCreditPackage(packageId) {\n    return _constants__WEBPACK_IMPORTED_MODULE_4__.CREDIT_PACKAGES.find((pkg)=>pkg.id === packageId);\n}\nfunction shouldRefreshCredits(session, currentTime) {\n    // Check if it's been at least a month since last refresh\n    if (!session.user.lastCreditRefreshAt) {\n        return true;\n    }\n    // Calculate the date exactly one month after the last refresh\n    const oneMonthAfterLastRefresh = new Date(session.user.lastCreditRefreshAt);\n    oneMonthAfterLastRefresh.setMonth(oneMonthAfterLastRefresh.getMonth() + 1);\n    // Only refresh if we've passed the one month mark\n    return currentTime >= oneMonthAfterLastRefresh;\n}\nasync function processExpiredCredits(userId, currentTime) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    // Find all expired transactions that haven't been processed and have remaining credits\n    // Order by type to process MONTHLY_REFRESH first, then by creation date\n    const expiredTransactions = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.lt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate, currentTime), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDateProcessedAt), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.remainingAmount, 0)),\n        orderBy: [\n            // Process MONTHLY_REFRESH transactions first\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.desc)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`CASE WHEN ${_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.type} = ${_db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.MONTHLY_REFRESH} THEN 1 ELSE 0 END`),\n            // Then process by creation date (oldest first)\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.asc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ]\n    });\n    // Process each expired transaction\n    for (const transaction of expiredTransactions){\n        try {\n            // First, mark the transaction as processed to prevent double processing\n            await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).set({\n                expirationDateProcessedAt: currentTime,\n                remainingAmount: 0\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.id, transaction.id));\n            // Then deduct the expired credits from user's balance\n            await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n                currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} - ${transaction.remainingAmount}`\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n        } catch (error) {\n            console.error(`Failed to process expired credits for transaction ${transaction.id}:`, error);\n            continue;\n        }\n    }\n}\nasync function updateUserCredits(userId, creditsToAdd) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} + ${creditsToAdd}`\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n    // Update all KV sessions to reflect the new credit balance\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_3__.updateAllSessionsOfUser)(userId);\n}\nasync function updateLastRefreshDate(userId, date) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        lastCreditRefreshAt: date\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n}\nasync function logTransaction({ userId, amount, description, type, expirationDate, paymentIntentId }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    await db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).values({\n        userId,\n        amount,\n        remainingAmount: amount,\n        type,\n        description,\n        expirationDate,\n        paymentIntentId\n    });\n}\nasync function addFreeMonthlyCreditsIfNeeded(session) {\n    const currentTime = new Date();\n    // Check if it's been at least a month since last refresh\n    if (shouldRefreshCredits(session, currentTime)) {\n        // Double check the last refresh date from the database to prevent race conditions\n        const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n        const user = await db.query.userTable.findFirst({\n            where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, session.userId),\n            columns: {\n                lastCreditRefreshAt: true,\n                currentCredits: true\n            }\n        });\n        // This should prevent race conditions between multiple sessions\n        if (!shouldRefreshCredits({\n            ...session,\n            user: {\n                ...session.user,\n                lastCreditRefreshAt: user?.lastCreditRefreshAt ?? null\n            }\n        }, currentTime)) {\n            return user?.currentCredits ?? 0;\n        }\n        // Process any expired credits first\n        await processExpiredCredits(session.userId, currentTime);\n        // Add free monthly credits with 1 month expiration\n        const expirationDate = new Date(currentTime);\n        expirationDate.setMonth(expirationDate.getMonth() + 1);\n        await updateUserCredits(session.userId, _constants__WEBPACK_IMPORTED_MODULE_4__.FREE_MONTHLY_CREDITS);\n        await logTransaction({\n            userId: session.userId,\n            amount: _constants__WEBPACK_IMPORTED_MODULE_4__.FREE_MONTHLY_CREDITS,\n            description: 'Free monthly credits',\n            type: _db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.MONTHLY_REFRESH,\n            expirationDate\n        });\n        // Update last refresh date\n        await updateLastRefreshDate(session.userId, currentTime);\n        // Get the updated credit balance from the database\n        const updatedUser = await db.query.userTable.findFirst({\n            where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, session.userId),\n            columns: {\n                currentCredits: true\n            }\n        });\n        return updatedUser?.currentCredits ?? 0;\n    }\n    return session.user.currentCredits;\n}\nasync function hasEnoughCredits({ userId, requiredCredits }) {\n    const user = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)().query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    if (!user) return false;\n    return user.currentCredits >= requiredCredits;\n}\nasync function consumeCredits({ userId, amount, description }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    // First check if user has enough credits\n    const user = await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    if (!user || user.currentCredits < amount) {\n        throw new Error(\"Insufficient credits\");\n    }\n    // Get all non-expired transactions with remaining credits, ordered by creation date\n    const activeTransactionsWithBalance = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.remainingAmount, 0), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDateProcessedAt), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.or)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.isNull)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.gt)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.expirationDate, new Date()))),\n        orderBy: [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.asc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ]\n    });\n    let remainingToDeduct = amount;\n    // Deduct from each transaction until we've deducted the full amount\n    for (const transaction of activeTransactionsWithBalance){\n        if (remainingToDeduct <= 0) break;\n        const deductFromThis = Math.min(transaction.remainingAmount, remainingToDeduct);\n        await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).set({\n            remainingAmount: transaction.remainingAmount - deductFromThis\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.id, transaction.id));\n        remainingToDeduct -= deductFromThis;\n    }\n    // Update total credits\n    await db.update(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable).set({\n        currentCredits: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`${_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.currentCredits} - ${amount}`\n    }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId));\n    // Log the usage transaction\n    await db.insert(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).values({\n        userId,\n        amount: -amount,\n        remainingAmount: 0,\n        type: _db_schema__WEBPACK_IMPORTED_MODULE_2__.CREDIT_TRANSACTION_TYPE.USAGE,\n        description,\n        createdAt: new Date(),\n        updatedAt: new Date()\n    });\n    // Get updated credit balance\n    const updatedUser = await db.query.userTable.findFirst({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.userTable.id, userId),\n        columns: {\n            currentCredits: true\n        }\n    });\n    // Update all KV sessions to reflect the new credit balance\n    await (0,_kv_session__WEBPACK_IMPORTED_MODULE_3__.updateAllSessionsOfUser)(userId);\n    return updatedUser?.currentCredits ?? 0;\n}\nasync function getCreditTransactions({ userId, page = 1, limit = 10 }) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    const transactions = await db.query.creditTransactionTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId),\n        orderBy: [\n            (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_6__.desc)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.createdAt)\n        ],\n        limit,\n        offset: (page - 1) * limit,\n        columns: {\n            expirationDateProcessedAt: false,\n            remainingAmount: false,\n            userId: false\n        }\n    });\n    const total = await db.select({\n        count: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.sql)`count(*)`\n    }).from(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.creditTransactionTable.userId, userId)).then((result)=>result[0].count);\n    return {\n        transactions,\n        pagination: {\n            total,\n            pages: Math.ceil(total / limit),\n            current: page\n        }\n    };\n}\nasync function getUserPurchasedItems(userId) {\n    const db = (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDB)();\n    const purchasedItems = await db.query.purchasedItemsTable.findMany({\n        where: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_5__.eq)(_db_schema__WEBPACK_IMPORTED_MODULE_2__.purchasedItemsTable.userId, userId)\n    });\n    // Create a map of purchased items for easy lookup\n    return new Set(purchasedItems.map((item)=>`${item.itemType}:${item.itemId}`));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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REFBa0Q7SUFDbEQsT0FBTyxJQUFJNkQsSUFDVEQsZUFBZUUsR0FBRyxDQUFDQyxDQUFBQSxPQUFRLEdBQUdBLEtBQUtDLFFBQVEsQ0FBQyxDQUFDLEVBQUVELEtBQUtFLE1BQU0sRUFBRTtBQUVoRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx6YWludWxhYWJhaWRpblxcRG93bmxvYWRzXFxGaW5hbFByb2plY3QtbWFpblxcRmluYWxQcm9qZWN0LW1haW5cXHNyY1xcdXRpbHNcXGNyZWRpdHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwic2VydmVyLW9ubHlcIjtcbmltcG9ydCB7IGVxLCBzcWwsIGRlc2MsIGFuZCwgbHQsIGlzTnVsbCwgZ3QsIG9yLCBhc2MgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcbmltcG9ydCB7IGdldERCIH0gZnJvbSBcIkAvZGJcIjtcbmltcG9ydCB7IHVzZXJUYWJsZSwgY3JlZGl0VHJhbnNhY3Rpb25UYWJsZSwgQ1JFRElUX1RSQU5TQUNUSU9OX1RZUEUsIHB1cmNoYXNlZEl0ZW1zVGFibGUgfSBmcm9tIFwiQC9kYi9zY2hlbWFcIjtcbmltcG9ydCB7IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyLCBLVlNlc3Npb24gfSBmcm9tIFwiLi9rdi1zZXNzaW9uXCI7XG5pbXBvcnQgeyBDUkVESVRfUEFDS0FHRVMsIEZSRUVfTU9OVEhMWV9DUkVESVRTIH0gZnJvbSBcIkAvY29uc3RhbnRzXCI7XG5cbmV4cG9ydCB0eXBlIENyZWRpdFBhY2thZ2UgPSB0eXBlb2YgQ1JFRElUX1BBQ0tBR0VTW251bWJlcl07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDcmVkaXRQYWNrYWdlKHBhY2thZ2VJZDogc3RyaW5nKTogQ3JlZGl0UGFja2FnZSB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiBDUkVESVRfUEFDS0FHRVMuZmluZCgocGtnKSA9PiBwa2cuaWQgPT09IHBhY2thZ2VJZCk7XG59XG5cbmZ1bmN0aW9uIHNob3VsZFJlZnJlc2hDcmVkaXRzKHNlc3Npb246IEtWU2Vzc2lvbiwgY3VycmVudFRpbWU6IERhdGUpOiBib29sZWFuIHtcbiAgLy8gQ2hlY2sgaWYgaXQncyBiZWVuIGF0IGxlYXN0IGEgbW9udGggc2luY2UgbGFzdCByZWZyZXNoXG4gIGlmICghc2Vzc2lvbi51c2VyLmxhc3RDcmVkaXRSZWZyZXNoQXQpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSB0aGUgZGF0ZSBleGFjdGx5IG9uZSBtb250aCBhZnRlciB0aGUgbGFzdCByZWZyZXNoXG4gIGNvbnN0IG9uZU1vbnRoQWZ0ZXJMYXN0UmVmcmVzaCA9IG5ldyBEYXRlKHNlc3Npb24udXNlci5sYXN0Q3JlZGl0UmVmcmVzaEF0KTtcbiAgb25lTW9udGhBZnRlckxhc3RSZWZyZXNoLnNldE1vbnRoKG9uZU1vbnRoQWZ0ZXJMYXN0UmVmcmVzaC5nZXRNb250aCgpICsgMSk7XG5cbiAgLy8gT25seSByZWZyZXNoIGlmIHdlJ3ZlIHBhc3NlZCB0aGUgb25lIG1vbnRoIG1hcmtcbiAgcmV0dXJuIGN1cnJlbnRUaW1lID49IG9uZU1vbnRoQWZ0ZXJMYXN0UmVmcmVzaDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0V4cGlyZWRDcmVkaXRzKHVzZXJJZDogc3RyaW5nLCBjdXJyZW50VGltZTogRGF0ZSkge1xuICBjb25zdCBkYiA9IGdldERCKCk7XG4gIC8vIEZpbmQgYWxsIGV4cGlyZWQgdHJhbnNhY3Rpb25zIHRoYXQgaGF2ZW4ndCBiZWVuIHByb2Nlc3NlZCBhbmQgaGF2ZSByZW1haW5pbmcgY3JlZGl0c1xuICAvLyBPcmRlciBieSB0eXBlIHRvIHByb2Nlc3MgTU9OVEhMWV9SRUZSRVNIIGZpcnN0LCB0aGVuIGJ5IGNyZWF0aW9uIGRhdGVcbiAgY29uc3QgZXhwaXJlZFRyYW5zYWN0aW9ucyA9IGF3YWl0IGRiLnF1ZXJ5LmNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZmluZE1hbnkoe1xuICAgIHdoZXJlOiBhbmQoXG4gICAgICBlcShjcmVkaXRUcmFuc2FjdGlvblRhYmxlLnVzZXJJZCwgdXNlcklkKSxcbiAgICAgIGx0KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZXhwaXJhdGlvbkRhdGUsIGN1cnJlbnRUaW1lKSxcbiAgICAgIGlzTnVsbChjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmV4cGlyYXRpb25EYXRlUHJvY2Vzc2VkQXQpLFxuICAgICAgZ3QoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5yZW1haW5pbmdBbW91bnQsIDApLFxuICAgICksXG4gICAgb3JkZXJCeTogW1xuICAgICAgLy8gUHJvY2VzcyBNT05USExZX1JFRlJFU0ggdHJhbnNhY3Rpb25zIGZpcnN0XG4gICAgICBkZXNjKHNxbGBDQVNFIFdIRU4gJHtjcmVkaXRUcmFuc2FjdGlvblRhYmxlLnR5cGV9ID0gJHtDUkVESVRfVFJBTlNBQ1RJT05fVFlQRS5NT05USExZX1JFRlJFU0h9IFRIRU4gMSBFTFNFIDAgRU5EYCksXG4gICAgICAvLyBUaGVuIHByb2Nlc3MgYnkgY3JlYXRpb24gZGF0ZSAob2xkZXN0IGZpcnN0KVxuICAgICAgYXNjKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuY3JlYXRlZEF0KSxcbiAgICBdLFxuICB9KTtcblxuICAvLyBQcm9jZXNzIGVhY2ggZXhwaXJlZCB0cmFuc2FjdGlvblxuICBmb3IgKGNvbnN0IHRyYW5zYWN0aW9uIG9mIGV4cGlyZWRUcmFuc2FjdGlvbnMpIHtcbiAgICB0cnkge1xuICAgICAgLy8gRmlyc3QsIG1hcmsgdGhlIHRyYW5zYWN0aW9uIGFzIHByb2Nlc3NlZCB0byBwcmV2ZW50IGRvdWJsZSBwcm9jZXNzaW5nXG4gICAgICBhd2FpdCBkYlxuICAgICAgICAudXBkYXRlKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUpXG4gICAgICAgIC5zZXQoe1xuICAgICAgICAgIGV4cGlyYXRpb25EYXRlUHJvY2Vzc2VkQXQ6IGN1cnJlbnRUaW1lLFxuICAgICAgICAgIHJlbWFpbmluZ0Ftb3VudDogMCwgLy8gQWxsIHJlbWFpbmluZyBjcmVkaXRzIGFyZSBleHBpcmVkXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVyZShlcShjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmlkLCB0cmFuc2FjdGlvbi5pZCkpO1xuXG4gICAgICAvLyBUaGVuIGRlZHVjdCB0aGUgZXhwaXJlZCBjcmVkaXRzIGZyb20gdXNlcidzIGJhbGFuY2VcbiAgICAgIGF3YWl0IGRiXG4gICAgICAgIC51cGRhdGUodXNlclRhYmxlKVxuICAgICAgICAuc2V0KHtcbiAgICAgICAgICBjdXJyZW50Q3JlZGl0czogc3FsYCR7dXNlclRhYmxlLmN1cnJlbnRDcmVkaXRzfSAtICR7dHJhbnNhY3Rpb24ucmVtYWluaW5nQW1vdW50fWAsXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVyZShlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcHJvY2VzcyBleHBpcmVkIGNyZWRpdHMgZm9yIHRyYW5zYWN0aW9uICR7dHJhbnNhY3Rpb24uaWR9OmAsIGVycm9yKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlckNyZWRpdHModXNlcklkOiBzdHJpbmcsIGNyZWRpdHNUb0FkZDogbnVtYmVyKSB7XG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcbiAgYXdhaXQgZGJcbiAgICAudXBkYXRlKHVzZXJUYWJsZSlcbiAgICAuc2V0KHtcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiBzcWxgJHt1c2VyVGFibGUuY3VycmVudENyZWRpdHN9ICsgJHtjcmVkaXRzVG9BZGR9YCxcbiAgICB9KVxuICAgIC53aGVyZShlcSh1c2VyVGFibGUuaWQsIHVzZXJJZCkpO1xuXG4gIC8vIFVwZGF0ZSBhbGwgS1Ygc2Vzc2lvbnMgdG8gcmVmbGVjdCB0aGUgbmV3IGNyZWRpdCBiYWxhbmNlXG4gIGF3YWl0IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyKHVzZXJJZCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUxhc3RSZWZyZXNoRGF0ZSh1c2VySWQ6IHN0cmluZywgZGF0ZTogRGF0ZSkge1xuICBjb25zdCBkYiA9IGdldERCKCk7XG4gIGF3YWl0IGRiXG4gICAgLnVwZGF0ZSh1c2VyVGFibGUpXG4gICAgLnNldCh7XG4gICAgICBsYXN0Q3JlZGl0UmVmcmVzaEF0OiBkYXRlLFxuICAgIH0pXG4gICAgLndoZXJlKGVxKHVzZXJUYWJsZS5pZCwgdXNlcklkKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dUcmFuc2FjdGlvbih7XG4gIHVzZXJJZCxcbiAgYW1vdW50LFxuICBkZXNjcmlwdGlvbixcbiAgdHlwZSxcbiAgZXhwaXJhdGlvbkRhdGUsXG4gIHBheW1lbnRJbnRlbnRJZFxufToge1xuICB1c2VySWQ6IHN0cmluZztcbiAgYW1vdW50OiBudW1iZXI7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHR5cGU6IGtleW9mIHR5cGVvZiBDUkVESVRfVFJBTlNBQ1RJT05fVFlQRTtcbiAgZXhwaXJhdGlvbkRhdGU/OiBEYXRlO1xuICBwYXltZW50SW50ZW50SWQ/OiBzdHJpbmc7XG59KSB7XG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcbiAgYXdhaXQgZGIuaW5zZXJ0KGNyZWRpdFRyYW5zYWN0aW9uVGFibGUpLnZhbHVlcyh7XG4gICAgdXNlcklkLFxuICAgIGFtb3VudCxcbiAgICByZW1haW5pbmdBbW91bnQ6IGFtb3VudCwgLy8gSW5pdGlhbGl6ZSByZW1haW5pbmcgYW1vdW50IHRvIGJlIHRoZSBzYW1lIGFzIGFtb3VudFxuICAgIHR5cGUsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgZXhwaXJhdGlvbkRhdGUsXG4gICAgcGF5bWVudEludGVudElkXG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkRnJlZU1vbnRobHlDcmVkaXRzSWZOZWVkZWQoc2Vzc2lvbjogS1ZTZXNzaW9uKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpO1xuXG4gIC8vIENoZWNrIGlmIGl0J3MgYmVlbiBhdCBsZWFzdCBhIG1vbnRoIHNpbmNlIGxhc3QgcmVmcmVzaFxuICBpZiAoc2hvdWxkUmVmcmVzaENyZWRpdHMoc2Vzc2lvbiwgY3VycmVudFRpbWUpKSB7XG4gICAgLy8gRG91YmxlIGNoZWNrIHRoZSBsYXN0IHJlZnJlc2ggZGF0ZSBmcm9tIHRoZSBkYXRhYmFzZSB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuICAgIGNvbnN0IGRiID0gZ2V0REIoKTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZGIucXVlcnkudXNlclRhYmxlLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZTogZXEodXNlclRhYmxlLmlkLCBzZXNzaW9uLnVzZXJJZCksXG4gICAgICBjb2x1bW5zOiB7XG4gICAgICAgIGxhc3RDcmVkaXRSZWZyZXNoQXQ6IHRydWUsXG4gICAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFRoaXMgc2hvdWxkIHByZXZlbnQgcmFjZSBjb25kaXRpb25zIGJldHdlZW4gbXVsdGlwbGUgc2Vzc2lvbnNcbiAgICBpZiAoIXNob3VsZFJlZnJlc2hDcmVkaXRzKHsgLi4uc2Vzc2lvbiwgdXNlcjogeyAuLi5zZXNzaW9uLnVzZXIsIGxhc3RDcmVkaXRSZWZyZXNoQXQ6IHVzZXI/Lmxhc3RDcmVkaXRSZWZyZXNoQXQgPz8gbnVsbCB9IH0sIGN1cnJlbnRUaW1lKSkge1xuICAgICAgcmV0dXJuIHVzZXI/LmN1cnJlbnRDcmVkaXRzID8/IDA7XG4gICAgfVxuXG4gICAgLy8gUHJvY2VzcyBhbnkgZXhwaXJlZCBjcmVkaXRzIGZpcnN0XG4gICAgYXdhaXQgcHJvY2Vzc0V4cGlyZWRDcmVkaXRzKHNlc3Npb24udXNlcklkLCBjdXJyZW50VGltZSk7XG5cbiAgICAvLyBBZGQgZnJlZSBtb250aGx5IGNyZWRpdHMgd2l0aCAxIG1vbnRoIGV4cGlyYXRpb25cbiAgICBjb25zdCBleHBpcmF0aW9uRGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnRUaW1lKTtcbiAgICBleHBpcmF0aW9uRGF0ZS5zZXRNb250aChleHBpcmF0aW9uRGF0ZS5nZXRNb250aCgpICsgMSk7XG5cbiAgICBhd2FpdCB1cGRhdGVVc2VyQ3JlZGl0cyhzZXNzaW9uLnVzZXJJZCwgRlJFRV9NT05USExZX0NSRURJVFMpO1xuICAgIGF3YWl0IGxvZ1RyYW5zYWN0aW9uKHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VySWQsXG4gICAgICBhbW91bnQ6IEZSRUVfTU9OVEhMWV9DUkVESVRTLFxuICAgICAgZGVzY3JpcHRpb246ICdGcmVlIG1vbnRobHkgY3JlZGl0cycsXG4gICAgICB0eXBlOiBDUkVESVRfVFJBTlNBQ1RJT05fVFlQRS5NT05USExZX1JFRlJFU0gsXG4gICAgICBleHBpcmF0aW9uRGF0ZVxuICAgIH0pO1xuXG4gICAgLy8gVXBkYXRlIGxhc3QgcmVmcmVzaCBkYXRlXG4gICAgYXdhaXQgdXBkYXRlTGFzdFJlZnJlc2hEYXRlKHNlc3Npb24udXNlcklkLCBjdXJyZW50VGltZSk7XG5cbiAgICAvLyBHZXQgdGhlIHVwZGF0ZWQgY3JlZGl0IGJhbGFuY2UgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGRiLnF1ZXJ5LnVzZXJUYWJsZS5maW5kRmlyc3Qoe1xuICAgICAgd2hlcmU6IGVxKHVzZXJUYWJsZS5pZCwgc2Vzc2lvbi51c2VySWQpLFxuICAgICAgY29sdW1uczoge1xuICAgICAgICBjdXJyZW50Q3JlZGl0czogdHJ1ZSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdXBkYXRlZFVzZXI/LmN1cnJlbnRDcmVkaXRzID8/IDA7XG4gIH1cblxuICByZXR1cm4gc2Vzc2lvbi51c2VyLmN1cnJlbnRDcmVkaXRzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzRW5vdWdoQ3JlZGl0cyh7IHVzZXJJZCwgcmVxdWlyZWRDcmVkaXRzIH06IHsgdXNlcklkOiBzdHJpbmc7IHJlcXVpcmVkQ3JlZGl0czogbnVtYmVyIH0pIHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IGdldERCKCkucXVlcnkudXNlclRhYmxlLmZpbmRGaXJzdCh7XG4gICAgd2hlcmU6IGVxKHVzZXJUYWJsZS5pZCwgdXNlcklkKSxcbiAgICBjb2x1bW5zOiB7XG4gICAgICBjdXJyZW50Q3JlZGl0czogdHJ1ZSxcbiAgICB9XG4gIH0pO1xuICBpZiAoIXVzZXIpIHJldHVybiBmYWxzZTtcblxuICByZXR1cm4gdXNlci5jdXJyZW50Q3JlZGl0cyA+PSByZXF1aXJlZENyZWRpdHM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25zdW1lQ3JlZGl0cyh7IHVzZXJJZCwgYW1vdW50LCBkZXNjcmlwdGlvbiB9OiB7IHVzZXJJZDogc3RyaW5nOyBhbW91bnQ6IG51bWJlcjsgZGVzY3JpcHRpb246IHN0cmluZyB9KSB7XG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcblxuICAvLyBGaXJzdCBjaGVjayBpZiB1c2VyIGhhcyBlbm91Z2ggY3JlZGl0c1xuICBjb25zdCB1c2VyID0gYXdhaXQgZGIucXVlcnkudXNlclRhYmxlLmZpbmRGaXJzdCh7XG4gICAgd2hlcmU6IGVxKHVzZXJUYWJsZS5pZCwgdXNlcklkKSxcbiAgICBjb2x1bW5zOiB7XG4gICAgICBjdXJyZW50Q3JlZGl0czogdHJ1ZSxcbiAgICB9LFxuICB9KTtcblxuICBpZiAoIXVzZXIgfHwgdXNlci5jdXJyZW50Q3JlZGl0cyA8IGFtb3VudCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkluc3VmZmljaWVudCBjcmVkaXRzXCIpO1xuICB9XG5cbiAgLy8gR2V0IGFsbCBub24tZXhwaXJlZCB0cmFuc2FjdGlvbnMgd2l0aCByZW1haW5pbmcgY3JlZGl0cywgb3JkZXJlZCBieSBjcmVhdGlvbiBkYXRlXG4gIGNvbnN0IGFjdGl2ZVRyYW5zYWN0aW9uc1dpdGhCYWxhbmNlID0gYXdhaXQgZGIucXVlcnkuY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IGFuZChcbiAgICAgIGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkLCB1c2VySWQpLFxuICAgICAgZ3QoY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5yZW1haW5pbmdBbW91bnQsIDApLFxuICAgICAgaXNOdWxsKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdCksXG4gICAgICBvcihcbiAgICAgICAgaXNOdWxsKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuZXhwaXJhdGlvbkRhdGUpLFxuICAgICAgICBndChjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmV4cGlyYXRpb25EYXRlLCBuZXcgRGF0ZSgpKVxuICAgICAgKVxuICAgICksXG4gICAgb3JkZXJCeTogW2FzYyhjcmVkaXRUcmFuc2FjdGlvblRhYmxlLmNyZWF0ZWRBdCldLFxuICB9KTtcblxuICBsZXQgcmVtYWluaW5nVG9EZWR1Y3QgPSBhbW91bnQ7XG5cbiAgLy8gRGVkdWN0IGZyb20gZWFjaCB0cmFuc2FjdGlvbiB1bnRpbCB3ZSd2ZSBkZWR1Y3RlZCB0aGUgZnVsbCBhbW91bnRcbiAgZm9yIChjb25zdCB0cmFuc2FjdGlvbiBvZiBhY3RpdmVUcmFuc2FjdGlvbnNXaXRoQmFsYW5jZSkge1xuICAgIGlmIChyZW1haW5pbmdUb0RlZHVjdCA8PSAwKSBicmVhaztcblxuICAgIGNvbnN0IGRlZHVjdEZyb21UaGlzID0gTWF0aC5taW4odHJhbnNhY3Rpb24ucmVtYWluaW5nQW1vdW50LCByZW1haW5pbmdUb0RlZHVjdCk7XG5cbiAgICBhd2FpdCBkYlxuICAgICAgLnVwZGF0ZShjcmVkaXRUcmFuc2FjdGlvblRhYmxlKVxuICAgICAgLnNldCh7XG4gICAgICAgIHJlbWFpbmluZ0Ftb3VudDogdHJhbnNhY3Rpb24ucmVtYWluaW5nQW1vdW50IC0gZGVkdWN0RnJvbVRoaXMsXG4gICAgICB9KVxuICAgICAgLndoZXJlKGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuaWQsIHRyYW5zYWN0aW9uLmlkKSk7XG5cbiAgICByZW1haW5pbmdUb0RlZHVjdCAtPSBkZWR1Y3RGcm9tVGhpcztcbiAgfVxuXG4gIC8vIFVwZGF0ZSB0b3RhbCBjcmVkaXRzXG4gIGF3YWl0IGRiXG4gICAgLnVwZGF0ZSh1c2VyVGFibGUpXG4gICAgLnNldCh7XG4gICAgICBjdXJyZW50Q3JlZGl0czogc3FsYCR7dXNlclRhYmxlLmN1cnJlbnRDcmVkaXRzfSAtICR7YW1vdW50fWAsXG4gICAgfSlcbiAgICAud2hlcmUoZXEodXNlclRhYmxlLmlkLCB1c2VySWQpKTtcblxuICAvLyBMb2cgdGhlIHVzYWdlIHRyYW5zYWN0aW9uXG4gIGF3YWl0IGRiLmluc2VydChjcmVkaXRUcmFuc2FjdGlvblRhYmxlKS52YWx1ZXMoe1xuICAgIHVzZXJJZCxcbiAgICBhbW91bnQ6IC1hbW91bnQsXG4gICAgcmVtYWluaW5nQW1vdW50OiAwLCAvLyBVc2FnZSB0cmFuc2FjdGlvbnMgZG9uJ3QgaGF2ZSByZW1haW5pbmcgYW1vdW50XG4gICAgdHlwZTogQ1JFRElUX1RSQU5TQUNUSU9OX1RZUEUuVVNBR0UsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgfSk7XG5cbiAgLy8gR2V0IHVwZGF0ZWQgY3JlZGl0IGJhbGFuY2VcbiAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBkYi5xdWVyeS51c2VyVGFibGUuZmluZEZpcnN0KHtcbiAgICB3aGVyZTogZXEodXNlclRhYmxlLmlkLCB1c2VySWQpLFxuICAgIGNvbHVtbnM6IHtcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiB0cnVlLFxuICAgIH0sXG4gIH0pO1xuXG4gIC8vIFVwZGF0ZSBhbGwgS1Ygc2Vzc2lvbnMgdG8gcmVmbGVjdCB0aGUgbmV3IGNyZWRpdCBiYWxhbmNlXG4gIGF3YWl0IHVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyKHVzZXJJZCk7XG5cbiAgcmV0dXJuIHVwZGF0ZWRVc2VyPy5jdXJyZW50Q3JlZGl0cyA/PyAwO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3JlZGl0VHJhbnNhY3Rpb25zKHtcbiAgdXNlcklkLFxuICBwYWdlID0gMSxcbiAgbGltaXQgPSAxMFxufToge1xuICB1c2VySWQ6IHN0cmluZztcbiAgcGFnZT86IG51bWJlcjtcbiAgbGltaXQ/OiBudW1iZXI7XG59KSB7XG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcbiAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZGIucXVlcnkuY3JlZGl0VHJhbnNhY3Rpb25UYWJsZS5maW5kTWFueSh7XG4gICAgd2hlcmU6IGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkLCB1c2VySWQpLFxuICAgIG9yZGVyQnk6IFtkZXNjKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUuY3JlYXRlZEF0KV0sXG4gICAgbGltaXQsXG4gICAgb2Zmc2V0OiAocGFnZSAtIDEpICogbGltaXQsXG4gICAgY29sdW1uczoge1xuICAgICAgZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdDogZmFsc2UsXG4gICAgICByZW1haW5pbmdBbW91bnQ6IGZhbHNlLFxuICAgICAgdXNlcklkOiBmYWxzZSxcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IHRvdGFsID0gYXdhaXQgZGJcbiAgICAuc2VsZWN0KHsgY291bnQ6IHNxbDxudW1iZXI+YGNvdW50KCopYCB9KVxuICAgIC5mcm9tKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUpXG4gICAgLndoZXJlKGVxKGNyZWRpdFRyYW5zYWN0aW9uVGFibGUudXNlcklkLCB1c2VySWQpKVxuICAgIC50aGVuKChyZXN1bHQpID0+IHJlc3VsdFswXS5jb3VudCk7XG5cbiAgcmV0dXJuIHtcbiAgICB0cmFuc2FjdGlvbnMsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgdG90YWwsXG4gICAgICBwYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpLFxuICAgICAgY3VycmVudDogcGFnZSxcbiAgICB9LFxuICB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclB1cmNoYXNlZEl0ZW1zKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGRiID0gZ2V0REIoKTtcbiAgY29uc3QgcHVyY2hhc2VkSXRlbXMgPSBhd2FpdCBkYi5xdWVyeS5wdXJjaGFzZWRJdGVtc1RhYmxlLmZpbmRNYW55KHtcbiAgICB3aGVyZTogZXEocHVyY2hhc2VkSXRlbXNUYWJsZS51c2VySWQsIHVzZXJJZCksXG4gIH0pO1xuXG4gIC8vIENyZWF0ZSBhIG1hcCBvZiBwdXJjaGFzZWQgaXRlbXMgZm9yIGVhc3kgbG9va3VwXG4gIHJldHVybiBuZXcgU2V0KFxuICAgIHB1cmNoYXNlZEl0ZW1zLm1hcChpdGVtID0+IGAke2l0ZW0uaXRlbVR5cGV9OiR7aXRlbS5pdGVtSWR9YClcbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJlcSIsInNxbCIsImRlc2MiLCJhbmQiLCJsdCIsImlzTnVsbCIsImd0Iiwib3IiLCJhc2MiLCJnZXREQiIsInVzZXJUYWJsZSIsImNyZWRpdFRyYW5zYWN0aW9uVGFibGUiLCJDUkVESVRfVFJBTlNBQ1RJT05fVFlQRSIsInB1cmNoYXNlZEl0ZW1zVGFibGUiLCJ1cGRhdGVBbGxTZXNzaW9uc09mVXNlciIsIkNSRURJVF9QQUNLQUdFUyIsIkZSRUVfTU9OVEhMWV9DUkVESVRTIiwiZ2V0Q3JlZGl0UGFja2FnZSIsInBhY2thZ2VJZCIsImZpbmQiLCJwa2ciLCJpZCIsInNob3VsZFJlZnJlc2hDcmVkaXRzIiwic2Vzc2lvbiIsImN1cnJlbnRUaW1lIiwidXNlciIsImxhc3RDcmVkaXRSZWZyZXNoQXQiLCJvbmVNb250aEFmdGVyTGFzdFJlZnJlc2giLCJEYXRlIiwic2V0TW9udGgiLCJnZXRNb250aCIsInByb2Nlc3NFeHBpcmVkQ3JlZGl0cyIsInVzZXJJZCIsImRiIiwiZXhwaXJlZFRyYW5zYWN0aW9ucyIsInF1ZXJ5IiwiZmluZE1hbnkiLCJ3aGVyZSIsImV4cGlyYXRpb25EYXRlIiwiZXhwaXJhdGlvbkRhdGVQcm9jZXNzZWRBdCIsInJlbWFpbmluZ0Ftb3VudCIsIm9yZGVyQnkiLCJ0eXBlIiwiTU9OVEhMWV9SRUZSRVNIIiwiY3JlYXRlZEF0IiwidHJhbnNhY3Rpb24iLCJ1cGRhdGUiLCJzZXQiLCJjdXJyZW50Q3JlZGl0cyIsImVycm9yIiwiY29uc29sZSIsInVwZGF0ZVVzZXJDcmVkaXRzIiwiY3JlZGl0c1RvQWRkIiwidXBkYXRlTGFzdFJlZnJlc2hEYXRlIiwiZGF0ZSIsImxvZ1RyYW5zYWN0aW9uIiwiYW1vdW50IiwiZGVzY3JpcHRpb24iLCJwYXltZW50SW50ZW50SWQiLCJpbnNlcnQiLCJ2YWx1ZXMiLCJhZGRGcmVlTW9udGhseUNyZWRpdHNJZk5lZWRlZCIsImZpbmRGaXJzdCIsImNvbHVtbnMiLCJ1cGRhdGVkVXNlciIsImhhc0Vub3VnaENyZWRpdHMiLCJyZXF1aXJlZENyZWRpdHMiLCJjb25zdW1lQ3JlZGl0cyIsIkVycm9yIiwiYWN0aXZlVHJhbnNhY3Rpb25zV2l0aEJhbGFuY2UiLCJyZW1haW5pbmdUb0RlZHVjdCIsImRlZHVjdEZyb21UaGlzIiwiTWF0aCIsIm1pbiIsIlVTQUdFIiwidXBkYXRlZEF0IiwiZ2V0Q3JlZGl0VHJhbnNhY3Rpb25zIiwicGFnZSIsImxpbWl0IiwidHJhbnNhY3Rpb25zIiwib2Zmc2V0IiwidG90YWwiLCJzZWxlY3QiLCJjb3VudCIsImZyb20iLCJ0aGVuIiwicmVzdWx0IiwicGFnaW5hdGlvbiIsInBhZ2VzIiwiY2VpbCIsImN1cnJlbnQiLCJnZXRVc2VyUHVyY2hhc2VkSXRlbXMiLCJwdXJjaGFzZWRJdGVtcyIsIlNldCIsIm1hcCIsIml0ZW0iLCJpdGVtVHlwZSIsIml0ZW1JZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/credits.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/get-IP.ts":
/*!*****************************!*\
  !*** ./src/utils/get-IP.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getIP: () => (/* binding */ getIP)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nasync function getIP() {\n    const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.headers)();\n    const ip = headersList.get('cf-connecting-ip') || headersList.get('x-forwarded-for') || headersList.get('x-real-ip') || headersList.get('true-client-ip') || headersList.get('x-client-ip') || headersList.get('x-cluster-client-ip') || null;\n    if (!ip) {\n        return null;\n    }\n    return ip;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvZ2V0LUlQLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBcUI7QUFFa0I7QUFFaEMsZUFBZUM7SUFDcEIsTUFBTUMsY0FBYyxNQUFNRixxREFBT0E7SUFFakMsTUFBTUcsS0FBS0QsWUFBWUUsR0FBRyxDQUFDLHVCQUN0QkYsWUFBWUUsR0FBRyxDQUFDLHNCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLGdCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLHFCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLGtCQUNoQkYsWUFBWUUsR0FBRyxDQUFDLDBCQUNoQjtJQUVMLElBQUksQ0FBQ0QsSUFBSTtRQUNQLE9BQU87SUFDVDtJQUVBLE9BQU9BO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXHV0aWxzXFxnZXQtSVAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwic2VydmVyLW9ubHlcIjtcblxuaW1wb3J0IHsgaGVhZGVycyB9IGZyb20gXCJuZXh0L2hlYWRlcnNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldElQKCkge1xuICBjb25zdCBoZWFkZXJzTGlzdCA9IGF3YWl0IGhlYWRlcnMoKTtcblxuICBjb25zdCBpcCA9IGhlYWRlcnNMaXN0LmdldCgnY2YtY29ubmVjdGluZy1pcCcpXG4gICAgfHwgaGVhZGVyc0xpc3QuZ2V0KCd4LWZvcndhcmRlZC1mb3InKVxuICAgIHx8IGhlYWRlcnNMaXN0LmdldCgneC1yZWFsLWlwJylcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3RydWUtY2xpZW50LWlwJylcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3gtY2xpZW50LWlwJylcbiAgICB8fCBoZWFkZXJzTGlzdC5nZXQoJ3gtY2x1c3Rlci1jbGllbnQtaXAnKVxuICAgIHx8IG51bGw7XG5cbiAgaWYgKCFpcCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICByZXR1cm4gaXA7XG59XG4iXSwibmFtZXMiOlsiaGVhZGVycyIsImdldElQIiwiaGVhZGVyc0xpc3QiLCJpcCIsImdldCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/get-IP.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/is-prod.ts":
/*!******************************!*\
  !*** ./src/utils/is-prod.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"development\" === \"production\");\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvaXMtcHJvZC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWVBLGtCQUF5QixZQUFZLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXHV0aWxzXFxpcy1wcm9kLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbiJdLCJuYW1lcyI6WyJwcm9jZXNzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/is-prod.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/kv-session.ts":
/*!*********************************!*\
  !*** ./src/utils/kv-session.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CURRENT_SESSION_VERSION: () => (/* binding */ CURRENT_SESSION_VERSION),\n/* harmony export */   createKVSession: () => (/* binding */ createKVSession),\n/* harmony export */   deleteKVSession: () => (/* binding */ deleteKVSession),\n/* harmony export */   getAllSessionIdsOfUser: () => (/* binding */ getAllSessionIdsOfUser),\n/* harmony export */   getKV: () => (/* binding */ getKV),\n/* harmony export */   getKVSession: () => (/* binding */ getKVSession),\n/* harmony export */   getSessionKey: () => (/* binding */ getSessionKey),\n/* harmony export */   updateAllSessionsOfUser: () => (/* binding */ updateAllSessionsOfUser),\n/* harmony export */   updateKVSession: () => (/* binding */ updateKVSession)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @opennextjs/cloudflare */ \"(rsc)/./node_modules/@opennextjs/cloudflare/dist/api/index.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/utils/auth */ \"(rsc)/./src/utils/auth.ts\");\n/* harmony import */ var _get_IP__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./get-IP */ \"(rsc)/./src/utils/get-IP.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/constants */ \"(rsc)/./src/constants.ts\");\n\n\n\n\n\n\nconst SESSION_PREFIX = \"session:\";\nfunction getSessionKey(userId, sessionId) {\n    return `${SESSION_PREFIX}${userId}:${sessionId}`;\n}\n/**\n *  !!!!!!!!!!!!!!!!!!!!!\n *  !!!   IMPORTANT   !!!\n *  !!!!!!!!!!!!!!!!!!!!!\n *\n * IF YOU MAKE ANY CHANGES TO THE KVSESSION TYPE ABOVE, YOU NEED TO INCREMENT THIS VERSION.\n * THIS IS HOW WE TRACK WHEN WE NEED TO UPDATE THE SESSIONS IN THE KV STORE.\n */ const CURRENT_SESSION_VERSION = 2;\nasync function getKV() {\n    const { env } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__.getCloudflareContext)();\n    return env.NEXT_INC_CACHE_KV;\n}\nasync function createKVSession({ sessionId, userId, expiresAt, user, authenticationType, passkeyCredentialId, teams }) {\n    const { cf } = (0,_opennextjs_cloudflare__WEBPACK_IMPORTED_MODULE_1__.getCloudflareContext)();\n    const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.headers)();\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const session = {\n        id: sessionId,\n        userId,\n        expiresAt: expiresAt.getTime(),\n        createdAt: Date.now(),\n        country: cf?.country,\n        city: cf?.city,\n        continent: cf?.continent,\n        ip: await (0,_get_IP__WEBPACK_IMPORTED_MODULE_4__.getIP)(),\n        userAgent: headersList.get('user-agent'),\n        user,\n        authenticationType,\n        passkeyCredentialId,\n        teams,\n        version: CURRENT_SESSION_VERSION\n    };\n    // Check if user has reached the session limit\n    const existingSessions = await getAllSessionIdsOfUser(userId);\n    // If user has MAX_SESSIONS_PER_USER or more sessions, delete the oldest one\n    if (existingSessions.length >= _constants__WEBPACK_IMPORTED_MODULE_5__.MAX_SESSIONS_PER_USER) {\n        // Sort sessions by expiration time (oldest first)\n        const sortedSessions = [\n            ...existingSessions\n        ].sort((a, b)=>{\n            // If a session has no expiration, treat it as oldest\n            if (!a.absoluteExpiration) return -1;\n            if (!b.absoluteExpiration) return 1;\n            return a.absoluteExpiration.getTime() - b.absoluteExpiration.getTime();\n        });\n        // Delete the oldest session\n        const oldestSessionKey = sortedSessions?.[0]?.key;\n        const oldestSessionId = oldestSessionKey?.split(':')?.[2]; // Extract sessionId from key\n        await deleteKVSession(oldestSessionId, userId);\n    }\n    await kv.put(getSessionKey(userId, sessionId), JSON.stringify(session), {\n        expirationTtl: Math.floor((expiresAt.getTime() - Date.now()) / 1000)\n    });\n    return session;\n}\nasync function getKVSession(sessionId, userId) {\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const sessionStr = await kv.get(getSessionKey(userId, sessionId));\n    if (!sessionStr) return null;\n    const session = JSON.parse(sessionStr);\n    if (session?.user?.createdAt) {\n        session.user.createdAt = new Date(session.user.createdAt);\n    }\n    if (session?.user?.updatedAt) {\n        session.user.updatedAt = new Date(session.user.updatedAt);\n    }\n    if (session?.user?.lastCreditRefreshAt) {\n        session.user.lastCreditRefreshAt = new Date(session.user.lastCreditRefreshAt);\n    }\n    if (session?.user?.emailVerified) {\n        session.user.emailVerified = new Date(session.user.emailVerified);\n    }\n    return session;\n}\nasync function updateKVSession(sessionId, userId, expiresAt) {\n    const session = await getKVSession(sessionId, userId);\n    if (!session) return null;\n    const updatedUser = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserFromDB)(userId);\n    if (!updatedUser) {\n        throw new Error(\"User not found\");\n    }\n    // Get updated teams data with permissions\n    const teamsWithPermissions = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserTeamsWithPermissions)(userId);\n    const updatedSession = {\n        ...session,\n        version: CURRENT_SESSION_VERSION,\n        expiresAt: expiresAt.getTime(),\n        user: updatedUser,\n        teams: teamsWithPermissions\n    };\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    await kv.put(getSessionKey(userId, sessionId), JSON.stringify(updatedSession), {\n        expirationTtl: Math.floor((expiresAt.getTime() - Date.now()) / 1000)\n    });\n    return updatedSession;\n}\nasync function deleteKVSession(sessionId, userId) {\n    const session = await getKVSession(sessionId, userId);\n    if (!session) return;\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    await kv.delete(getSessionKey(userId, sessionId));\n}\nasync function getAllSessionIdsOfUser(userId) {\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const sessions = await kv.list({\n        prefix: getSessionKey(userId, \"\")\n    });\n    return sessions.keys.map((session)=>({\n            key: session.name,\n            absoluteExpiration: session.expiration ? new Date(session.expiration * 1000) : undefined\n        }));\n}\n/**\n * Update all sessions of a user. It can only be called in a server actions and api routes.\n * @param userId\n */ async function updateAllSessionsOfUser(userId) {\n    const sessions = await getAllSessionIdsOfUser(userId);\n    const kv = await getKV();\n    if (!kv) {\n        throw new Error(\"Can't connect to KV store\");\n    }\n    const newUserData = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserFromDB)(userId);\n    if (!newUserData) return;\n    // Get updated teams data with permissions\n    const teamsWithPermissions = await (0,_utils_auth__WEBPACK_IMPORTED_MODULE_3__.getUserTeamsWithPermissions)(userId);\n    for (const sessionObj of sessions){\n        const session = await kv.get(sessionObj.key);\n        if (!session) continue;\n        const sessionData = JSON.parse(session);\n        // Only update non-expired sessions\n        if (sessionObj.absoluteExpiration && sessionObj.absoluteExpiration.getTime() > Date.now()) {\n            const ttlInSeconds = Math.floor((sessionObj.absoluteExpiration.getTime() - Date.now()) / 1000);\n            await kv.put(sessionObj.key, JSON.stringify({\n                ...sessionData,\n                user: newUserData,\n                teams: teamsWithPermissions\n            }), {\n                expirationTtl: ttlInSeconds\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMva3Ytc2Vzc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFCO0FBRXlDO0FBQ3ZCO0FBRW1DO0FBQ3pDO0FBQ21CO0FBQ3BELE1BQU1NLGlCQUFpQjtBQUVoQixTQUFTQyxjQUFjQyxNQUFjLEVBQUVDLFNBQWlCO0lBQzdELE9BQU8sR0FBR0gsaUJBQWlCRSxPQUFPLENBQUMsRUFBRUMsV0FBVztBQUNsRDtBQTZDQTs7Ozs7OztDQU9DLEdBQ00sTUFBTUMsMEJBQTBCLEVBQUU7QUFFbEMsZUFBZUM7SUFDcEIsTUFBTSxFQUFFQyxHQUFHLEVBQUUsR0FBR1osNEVBQW9CQTtJQUNwQyxPQUFPWSxJQUFJQyxpQkFBaUI7QUFDOUI7QUFPTyxlQUFlQyxnQkFBZ0IsRUFDcENMLFNBQVMsRUFDVEQsTUFBTSxFQUNOTyxTQUFTLEVBQ1RDLElBQUksRUFDSkMsa0JBQWtCLEVBQ2xCQyxtQkFBbUIsRUFDbkJDLEtBQUssRUFDaUI7SUFDdEIsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBR3BCLDRFQUFvQkE7SUFDbkMsTUFBTXFCLGNBQWMsTUFBTXBCLHFEQUFPQTtJQUNqQyxNQUFNcUIsS0FBSyxNQUFNWDtJQUVqQixJQUFJLENBQUNXLElBQUk7UUFDUCxNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFFQSxNQUFNQyxVQUFxQjtRQUN6QkMsSUFBSWhCO1FBQ0pEO1FBQ0FPLFdBQVdBLFVBQVVXLE9BQU87UUFDNUJDLFdBQVdDLEtBQUtDLEdBQUc7UUFDbkJDLFNBQVNWLElBQUlVO1FBQ2JDLE1BQU1YLElBQUlXO1FBQ1ZDLFdBQVdaLElBQUlZO1FBQ2ZDLElBQUksTUFBTTdCLDhDQUFLQTtRQUNmOEIsV0FBV2IsWUFBWWMsR0FBRyxDQUFDO1FBQzNCbkI7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQWlCLFNBQVMxQjtJQUNYO0lBRUEsOENBQThDO0lBQzlDLE1BQU0yQixtQkFBbUIsTUFBTUMsdUJBQXVCOUI7SUFFdEQsNEVBQTRFO0lBQzVFLElBQUk2QixpQkFBaUJFLE1BQU0sSUFBSWxDLDZEQUFxQkEsRUFBRTtRQUNwRCxrREFBa0Q7UUFDbEQsTUFBTW1DLGlCQUFpQjtlQUFJSDtTQUFpQixDQUFDSSxJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7WUFDcEQscURBQXFEO1lBQ3JELElBQUksQ0FBQ0QsRUFBRUUsa0JBQWtCLEVBQUUsT0FBTyxDQUFDO1lBQ25DLElBQUksQ0FBQ0QsRUFBRUMsa0JBQWtCLEVBQUUsT0FBTztZQUNsQyxPQUFPRixFQUFFRSxrQkFBa0IsQ0FBQ2xCLE9BQU8sS0FBS2lCLEVBQUVDLGtCQUFrQixDQUFDbEIsT0FBTztRQUN0RTtRQUVBLDRCQUE0QjtRQUM1QixNQUFNbUIsbUJBQW1CTCxnQkFBZ0IsQ0FBQyxFQUFFLEVBQUVNO1FBQzlDLE1BQU1DLGtCQUFrQkYsa0JBQWtCRyxNQUFNLE1BQU0sQ0FBQyxFQUFFLEVBQUUsNkJBQTZCO1FBRXhGLE1BQU1DLGdCQUFnQkYsaUJBQWlCdkM7SUFDekM7SUFFQSxNQUFNYyxHQUFHNEIsR0FBRyxDQUNWM0MsY0FBY0MsUUFBUUMsWUFDdEIwQyxLQUFLQyxTQUFTLENBQUM1QixVQUNmO1FBQ0U2QixlQUFlQyxLQUFLQyxLQUFLLENBQUMsQ0FBQ3hDLFVBQVVXLE9BQU8sS0FBS0UsS0FBS0MsR0FBRyxFQUFDLElBQUs7SUFDakU7SUFHRixPQUFPTDtBQUNUO0FBRU8sZUFBZWdDLGFBQWEvQyxTQUFpQixFQUFFRCxNQUFjO0lBQ2xFLE1BQU1jLEtBQUssTUFBTVg7SUFFakIsSUFBSSxDQUFDVyxJQUFJO1FBQ1AsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTWtDLGFBQWEsTUFBTW5DLEdBQUdhLEdBQUcsQ0FBQzVCLGNBQWNDLFFBQVFDO0lBQ3RELElBQUksQ0FBQ2dELFlBQVksT0FBTztJQUV4QixNQUFNakMsVUFBVTJCLEtBQUtPLEtBQUssQ0FBQ0Q7SUFFM0IsSUFBSWpDLFNBQVNSLE1BQU1XLFdBQVc7UUFDNUJILFFBQVFSLElBQUksQ0FBQ1csU0FBUyxHQUFHLElBQUlDLEtBQUtKLFFBQVFSLElBQUksQ0FBQ1csU0FBUztJQUMxRDtJQUVBLElBQUlILFNBQVNSLE1BQU0yQyxXQUFXO1FBQzVCbkMsUUFBUVIsSUFBSSxDQUFDMkMsU0FBUyxHQUFHLElBQUkvQixLQUFLSixRQUFRUixJQUFJLENBQUMyQyxTQUFTO0lBQzFEO0lBRUEsSUFBSW5DLFNBQVNSLE1BQU00QyxxQkFBcUI7UUFDdENwQyxRQUFRUixJQUFJLENBQUM0QyxtQkFBbUIsR0FBRyxJQUFJaEMsS0FBS0osUUFBUVIsSUFBSSxDQUFDNEMsbUJBQW1CO0lBQzlFO0lBRUEsSUFBSXBDLFNBQVNSLE1BQU02QyxlQUFlO1FBQ2hDckMsUUFBUVIsSUFBSSxDQUFDNkMsYUFBYSxHQUFHLElBQUlqQyxLQUFLSixRQUFRUixJQUFJLENBQUM2QyxhQUFhO0lBQ2xFO0lBRUEsT0FBT3JDO0FBQ1Q7QUFFTyxlQUFlc0MsZ0JBQWdCckQsU0FBaUIsRUFBRUQsTUFBYyxFQUFFTyxTQUFlO0lBQ3RGLE1BQU1TLFVBQVUsTUFBTWdDLGFBQWEvQyxXQUFXRDtJQUM5QyxJQUFJLENBQUNnQixTQUFTLE9BQU87SUFFckIsTUFBTXVDLGNBQWMsTUFBTTdELDBEQUFhQSxDQUFDTTtJQUV4QyxJQUFJLENBQUN1RCxhQUFhO1FBQ2hCLE1BQU0sSUFBSXhDLE1BQU07SUFDbEI7SUFFQSwwQ0FBMEM7SUFDMUMsTUFBTXlDLHVCQUF1QixNQUFNN0Qsd0VBQTJCQSxDQUFDSztJQUUvRCxNQUFNeUQsaUJBQTRCO1FBQ2hDLEdBQUd6QyxPQUFPO1FBQ1ZZLFNBQVMxQjtRQUNUSyxXQUFXQSxVQUFVVyxPQUFPO1FBQzVCVixNQUFNK0M7UUFDTjVDLE9BQU82QztJQUNUO0lBRUEsTUFBTTFDLEtBQUssTUFBTVg7SUFFakIsSUFBSSxDQUFDVyxJQUFJO1FBQ1AsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTUQsR0FBRzRCLEdBQUcsQ0FDVjNDLGNBQWNDLFFBQVFDLFlBQ3RCMEMsS0FBS0MsU0FBUyxDQUFDYSxpQkFDZjtRQUNFWixlQUFlQyxLQUFLQyxLQUFLLENBQUMsQ0FBQ3hDLFVBQVVXLE9BQU8sS0FBS0UsS0FBS0MsR0FBRyxFQUFDLElBQUs7SUFDakU7SUFHRixPQUFPb0M7QUFDVDtBQUVPLGVBQWVoQixnQkFBZ0J4QyxTQUFpQixFQUFFRCxNQUFjO0lBQ3JFLE1BQU1nQixVQUFVLE1BQU1nQyxhQUFhL0MsV0FBV0Q7SUFDOUMsSUFBSSxDQUFDZ0IsU0FBUztJQUVkLE1BQU1GLEtBQUssTUFBTVg7SUFFakIsSUFBSSxDQUFDVyxJQUFJO1FBQ1AsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTUQsR0FBRzRDLE1BQU0sQ0FBQzNELGNBQWNDLFFBQVFDO0FBQ3hDO0FBRU8sZUFBZTZCLHVCQUF1QjlCLE1BQWM7SUFDekQsTUFBTWMsS0FBSyxNQUFNWDtJQUVqQixJQUFJLENBQUNXLElBQUk7UUFDUCxNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFFQSxNQUFNNEMsV0FBVyxNQUFNN0MsR0FBRzhDLElBQUksQ0FBQztRQUFFQyxRQUFROUQsY0FBY0MsUUFBUTtJQUFJO0lBRW5FLE9BQU8yRCxTQUFTRyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDL0MsVUFBYTtZQUNyQ3NCLEtBQUt0QixRQUFRZ0QsSUFBSTtZQUNqQjVCLG9CQUFvQnBCLFFBQVFpRCxVQUFVLEdBQUcsSUFBSTdDLEtBQUtKLFFBQVFpRCxVQUFVLEdBQUcsUUFBUUM7UUFDakY7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLGVBQWVDLHdCQUF3Qm5FLE1BQWM7SUFDMUQsTUFBTTJELFdBQVcsTUFBTTdCLHVCQUF1QjlCO0lBQzlDLE1BQU1jLEtBQUssTUFBTVg7SUFFakIsSUFBSSxDQUFDVyxJQUFJO1FBQ1AsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTXFELGNBQWMsTUFBTTFFLDBEQUFhQSxDQUFDTTtJQUV4QyxJQUFJLENBQUNvRSxhQUFhO0lBRWxCLDBDQUEwQztJQUMxQyxNQUFNWix1QkFBdUIsTUFBTTdELHdFQUEyQkEsQ0FBQ0s7SUFFL0QsS0FBSyxNQUFNcUUsY0FBY1YsU0FBVTtRQUNqQyxNQUFNM0MsVUFBVSxNQUFNRixHQUFHYSxHQUFHLENBQUMwQyxXQUFXL0IsR0FBRztRQUMzQyxJQUFJLENBQUN0QixTQUFTO1FBRWQsTUFBTXNELGNBQWMzQixLQUFLTyxLQUFLLENBQUNsQztRQUUvQixtQ0FBbUM7UUFDbkMsSUFBSXFELFdBQVdqQyxrQkFBa0IsSUFBSWlDLFdBQVdqQyxrQkFBa0IsQ0FBQ2xCLE9BQU8sS0FBS0UsS0FBS0MsR0FBRyxJQUFJO1lBQ3pGLE1BQU1rRCxlQUFlekIsS0FBS0MsS0FBSyxDQUFDLENBQUNzQixXQUFXakMsa0JBQWtCLENBQUNsQixPQUFPLEtBQUtFLEtBQUtDLEdBQUcsRUFBQyxJQUFLO1lBRXpGLE1BQU1QLEdBQUc0QixHQUFHLENBQ1YyQixXQUFXL0IsR0FBRyxFQUNkSyxLQUFLQyxTQUFTLENBQUM7Z0JBQ2IsR0FBRzBCLFdBQVc7Z0JBQ2Q5RCxNQUFNNEQ7Z0JBQ056RCxPQUFPNkM7WUFDVCxJQUNBO2dCQUFFWCxlQUFlMEI7WUFBYTtRQUVsQztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXHV0aWxzXFxrdi1zZXNzaW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcInNlcnZlci1vbmx5XCI7XG5cbmltcG9ydCB7IGdldENsb3VkZmxhcmVDb250ZXh0IH0gZnJvbSBcIkBvcGVubmV4dGpzL2Nsb3VkZmxhcmVcIjtcbmltcG9ydCB7IGhlYWRlcnMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XG5cbmltcG9ydCB7IGdldFVzZXJGcm9tREIsIGdldFVzZXJUZWFtc1dpdGhQZXJtaXNzaW9ucyB9IGZyb20gXCJAL3V0aWxzL2F1dGhcIjtcbmltcG9ydCB7IGdldElQIH0gZnJvbSBcIi4vZ2V0LUlQXCI7XG5pbXBvcnQgeyBNQVhfU0VTU0lPTlNfUEVSX1VTRVIgfSBmcm9tIFwiQC9jb25zdGFudHNcIjtcbmNvbnN0IFNFU1NJT05fUFJFRklYID0gXCJzZXNzaW9uOlwiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvbktleSh1c2VySWQ6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gYCR7U0VTU0lPTl9QUkVGSVh9JHt1c2VySWR9OiR7c2Vzc2lvbklkfWA7XG59XG5cbnR5cGUgS1ZTZXNzaW9uVXNlciA9IEV4Y2x1ZGU8QXdhaXRlZDxSZXR1cm5UeXBlPHR5cGVvZiBnZXRVc2VyRnJvbURCPj4sIHVuZGVmaW5lZD47XG5cbmV4cG9ydCBpbnRlcmZhY2UgS1ZTZXNzaW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIGV4cGlyZXNBdDogbnVtYmVyO1xuICBjcmVhdGVkQXQ6IG51bWJlcjtcbiAgdXNlcjogS1ZTZXNzaW9uVXNlciAmIHtcbiAgICBpbml0aWFscz86IHN0cmluZztcbiAgfTtcbiAgY291bnRyeT86IHN0cmluZztcbiAgY2l0eT86IHN0cmluZztcbiAgY29udGluZW50Pzogc3RyaW5nO1xuICBpcD86IHN0cmluZyB8IG51bGw7XG4gIHVzZXJBZ2VudD86IHN0cmluZyB8IG51bGw7XG4gIGF1dGhlbnRpY2F0aW9uVHlwZT86IFwicGFzc2tleVwiIHwgXCJwYXNzd29yZFwiIHwgXCJnb29nbGUtb2F1dGhcIjtcbiAgcGFzc2tleUNyZWRlbnRpYWxJZD86IHN0cmluZztcbiAgLyoqXG4gICAqIFRlYW1zIGRhdGEgLSBjb250YWlucyBsaXN0IG9mIHRlYW1zIHRoZSB1c2VyIGlzIGEgbWVtYmVyIG9mXG4gICAqIGFsb25nIHdpdGggcm9sZSBhbmQgcGVybWlzc2lvbnMgZGF0YVxuICAgKi9cbiAgdGVhbXM/OiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgc2x1Zzogc3RyaW5nO1xuICAgIHJvbGU6IHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICBpc1N5c3RlbVJvbGU6IGJvb2xlYW47XG4gICAgfTtcbiAgICBwZXJtaXNzaW9uczogc3RyaW5nW107XG4gIH1bXTtcbiAgLyoqXG4gICAqICAhISEhISEhISEhISEhISEhISEhISFcbiAgICogICEhISAgIElNUE9SVEFOVCAgICEhIVxuICAgKiAgISEhISEhISEhISEhISEhISEhISEhXG4gICAqXG4gICAqICBJRiBZT1UgTUFLRSBBTlkgQ0hBTkdFUyBUTyBUSElTIE9CSkVDVCBET04nVCBGT1JHRVQgVE8gSU5DUkVNRU5UIFwiQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT05cIiBCRUxPV1xuICAgKiAgSUYgWU9VIEZPUkdFVCwgVEhFIFNFU1NJT04gV0lMTCBOT1QgQkUgVVBEQVRFRCBJTiBUSEUgREFUQUJBU0VcbiAgICovXG4gIHZlcnNpb24/OiBudW1iZXI7XG59XG5cbi8qKlxuICogICEhISEhISEhISEhISEhISEhISEhIVxuICogICEhISAgIElNUE9SVEFOVCAgICEhIVxuICogICEhISEhISEhISEhISEhISEhISEhIVxuICpcbiAqIElGIFlPVSBNQUtFIEFOWSBDSEFOR0VTIFRPIFRIRSBLVlNFU1NJT04gVFlQRSBBQk9WRSwgWU9VIE5FRUQgVE8gSU5DUkVNRU5UIFRISVMgVkVSU0lPTi5cbiAqIFRISVMgSVMgSE9XIFdFIFRSQUNLIFdIRU4gV0UgTkVFRCBUTyBVUERBVEUgVEhFIFNFU1NJT05TIElOIFRIRSBLViBTVE9SRS5cbiAqL1xuZXhwb3J0IGNvbnN0IENVUlJFTlRfU0VTU0lPTl9WRVJTSU9OID0gMjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEtWKCkge1xuICBjb25zdCB7IGVudiB9ID0gZ2V0Q2xvdWRmbGFyZUNvbnRleHQoKTtcbiAgcmV0dXJuIGVudi5ORVhUX0lOQ19DQUNIRV9LVjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVLVlNlc3Npb25QYXJhbXMgZXh0ZW5kcyBPbWl0PEtWU2Vzc2lvbiwgXCJpZFwiIHwgXCJjcmVhdGVkQXRcIiB8IFwiZXhwaXJlc0F0XCI+IHtcbiAgc2Vzc2lvbklkOiBzdHJpbmc7XG4gIGV4cGlyZXNBdDogRGF0ZTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUtWU2Vzc2lvbih7XG4gIHNlc3Npb25JZCxcbiAgdXNlcklkLFxuICBleHBpcmVzQXQsXG4gIHVzZXIsXG4gIGF1dGhlbnRpY2F0aW9uVHlwZSxcbiAgcGFzc2tleUNyZWRlbnRpYWxJZCxcbiAgdGVhbXNcbn06IENyZWF0ZUtWU2Vzc2lvblBhcmFtcyk6IFByb21pc2U8S1ZTZXNzaW9uPiB7XG4gIGNvbnN0IHsgY2YgfSA9IGdldENsb3VkZmxhcmVDb250ZXh0KCk7XG4gIGNvbnN0IGhlYWRlcnNMaXN0ID0gYXdhaXQgaGVhZGVycygpO1xuICBjb25zdCBrdiA9IGF3YWl0IGdldEtWKCk7XG5cbiAgaWYgKCFrdikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGNvbm5lY3QgdG8gS1Ygc3RvcmVcIik7XG4gIH1cblxuICBjb25zdCBzZXNzaW9uOiBLVlNlc3Npb24gPSB7XG4gICAgaWQ6IHNlc3Npb25JZCxcbiAgICB1c2VySWQsXG4gICAgZXhwaXJlc0F0OiBleHBpcmVzQXQuZ2V0VGltZSgpLFxuICAgIGNyZWF0ZWRBdDogRGF0ZS5ub3coKSxcbiAgICBjb3VudHJ5OiBjZj8uY291bnRyeSxcbiAgICBjaXR5OiBjZj8uY2l0eSxcbiAgICBjb250aW5lbnQ6IGNmPy5jb250aW5lbnQsXG4gICAgaXA6IGF3YWl0IGdldElQKCksXG4gICAgdXNlckFnZW50OiBoZWFkZXJzTGlzdC5nZXQoJ3VzZXItYWdlbnQnKSxcbiAgICB1c2VyLFxuICAgIGF1dGhlbnRpY2F0aW9uVHlwZSxcbiAgICBwYXNza2V5Q3JlZGVudGlhbElkLFxuICAgIHRlYW1zLFxuICAgIHZlcnNpb246IENVUlJFTlRfU0VTU0lPTl9WRVJTSU9OXG4gIH07XG5cbiAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgcmVhY2hlZCB0aGUgc2Vzc2lvbiBsaW1pdFxuICBjb25zdCBleGlzdGluZ1Nlc3Npb25zID0gYXdhaXQgZ2V0QWxsU2Vzc2lvbklkc09mVXNlcih1c2VySWQpO1xuXG4gIC8vIElmIHVzZXIgaGFzIE1BWF9TRVNTSU9OU19QRVJfVVNFUiBvciBtb3JlIHNlc3Npb25zLCBkZWxldGUgdGhlIG9sZGVzdCBvbmVcbiAgaWYgKGV4aXN0aW5nU2Vzc2lvbnMubGVuZ3RoID49IE1BWF9TRVNTSU9OU19QRVJfVVNFUikge1xuICAgIC8vIFNvcnQgc2Vzc2lvbnMgYnkgZXhwaXJhdGlvbiB0aW1lIChvbGRlc3QgZmlyc3QpXG4gICAgY29uc3Qgc29ydGVkU2Vzc2lvbnMgPSBbLi4uZXhpc3RpbmdTZXNzaW9uc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgLy8gSWYgYSBzZXNzaW9uIGhhcyBubyBleHBpcmF0aW9uLCB0cmVhdCBpdCBhcyBvbGRlc3RcbiAgICAgIGlmICghYS5hYnNvbHV0ZUV4cGlyYXRpb24pIHJldHVybiAtMTtcbiAgICAgIGlmICghYi5hYnNvbHV0ZUV4cGlyYXRpb24pIHJldHVybiAxO1xuICAgICAgcmV0dXJuIGEuYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKSAtIGIuYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKTtcbiAgICB9KTtcblxuICAgIC8vIERlbGV0ZSB0aGUgb2xkZXN0IHNlc3Npb25cbiAgICBjb25zdCBvbGRlc3RTZXNzaW9uS2V5ID0gc29ydGVkU2Vzc2lvbnM/LlswXT8ua2V5O1xuICAgIGNvbnN0IG9sZGVzdFNlc3Npb25JZCA9IG9sZGVzdFNlc3Npb25LZXk/LnNwbGl0KCc6Jyk/LlsyXTsgLy8gRXh0cmFjdCBzZXNzaW9uSWQgZnJvbSBrZXlcblxuICAgIGF3YWl0IGRlbGV0ZUtWU2Vzc2lvbihvbGRlc3RTZXNzaW9uSWQsIHVzZXJJZCk7XG4gIH1cblxuICBhd2FpdCBrdi5wdXQoXG4gICAgZ2V0U2Vzc2lvbktleSh1c2VySWQsIHNlc3Npb25JZCksXG4gICAgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbiksXG4gICAge1xuICAgICAgZXhwaXJhdGlvblR0bDogTWF0aC5mbG9vcigoZXhwaXJlc0F0LmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMTAwMClcbiAgICB9XG4gICk7XG5cbiAgcmV0dXJuIHNlc3Npb247XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRLVlNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxLVlNlc3Npb24gfCBudWxsPiB7XG4gIGNvbnN0IGt2ID0gYXdhaXQgZ2V0S1YoKTtcblxuICBpZiAoIWt2KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY29ubmVjdCB0byBLViBzdG9yZVwiKTtcbiAgfVxuXG4gIGNvbnN0IHNlc3Npb25TdHIgPSBhd2FpdCBrdi5nZXQoZ2V0U2Vzc2lvbktleSh1c2VySWQsIHNlc3Npb25JZCkpO1xuICBpZiAoIXNlc3Npb25TdHIpIHJldHVybiBudWxsO1xuXG4gIGNvbnN0IHNlc3Npb24gPSBKU09OLnBhcnNlKHNlc3Npb25TdHIpIGFzIEtWU2Vzc2lvblxuXG4gIGlmIChzZXNzaW9uPy51c2VyPy5jcmVhdGVkQXQpIHtcbiAgICBzZXNzaW9uLnVzZXIuY3JlYXRlZEF0ID0gbmV3IERhdGUoc2Vzc2lvbi51c2VyLmNyZWF0ZWRBdCk7XG4gIH1cblxuICBpZiAoc2Vzc2lvbj8udXNlcj8udXBkYXRlZEF0KSB7XG4gICAgc2Vzc2lvbi51c2VyLnVwZGF0ZWRBdCA9IG5ldyBEYXRlKHNlc3Npb24udXNlci51cGRhdGVkQXQpO1xuICB9XG5cbiAgaWYgKHNlc3Npb24/LnVzZXI/Lmxhc3RDcmVkaXRSZWZyZXNoQXQpIHtcbiAgICBzZXNzaW9uLnVzZXIubGFzdENyZWRpdFJlZnJlc2hBdCA9IG5ldyBEYXRlKHNlc3Npb24udXNlci5sYXN0Q3JlZGl0UmVmcmVzaEF0KTtcbiAgfVxuXG4gIGlmIChzZXNzaW9uPy51c2VyPy5lbWFpbFZlcmlmaWVkKSB7XG4gICAgc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQgPSBuZXcgRGF0ZShzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCk7XG4gIH1cblxuICByZXR1cm4gc2Vzc2lvbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUtWU2Vzc2lvbihzZXNzaW9uSWQ6IHN0cmluZywgdXNlcklkOiBzdHJpbmcsIGV4cGlyZXNBdDogRGF0ZSk6IFByb21pc2U8S1ZTZXNzaW9uIHwgbnVsbD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0S1ZTZXNzaW9uKHNlc3Npb25JZCwgdXNlcklkKTtcbiAgaWYgKCFzZXNzaW9uKSByZXR1cm4gbnVsbDtcblxuICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGdldFVzZXJGcm9tREIodXNlcklkKTtcblxuICBpZiAoIXVwZGF0ZWRVc2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBub3QgZm91bmRcIik7XG4gIH1cblxuICAvLyBHZXQgdXBkYXRlZCB0ZWFtcyBkYXRhIHdpdGggcGVybWlzc2lvbnNcbiAgY29uc3QgdGVhbXNXaXRoUGVybWlzc2lvbnMgPSBhd2FpdCBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkKTtcblxuICBjb25zdCB1cGRhdGVkU2Vzc2lvbjogS1ZTZXNzaW9uID0ge1xuICAgIC4uLnNlc3Npb24sXG4gICAgdmVyc2lvbjogQ1VSUkVOVF9TRVNTSU9OX1ZFUlNJT04sXG4gICAgZXhwaXJlc0F0OiBleHBpcmVzQXQuZ2V0VGltZSgpLFxuICAgIHVzZXI6IHVwZGF0ZWRVc2VyLFxuICAgIHRlYW1zOiB0ZWFtc1dpdGhQZXJtaXNzaW9uc1xuICB9O1xuXG4gIGNvbnN0IGt2ID0gYXdhaXQgZ2V0S1YoKTtcblxuICBpZiAoIWt2KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY29ubmVjdCB0byBLViBzdG9yZVwiKTtcbiAgfVxuXG4gIGF3YWl0IGt2LnB1dChcbiAgICBnZXRTZXNzaW9uS2V5KHVzZXJJZCwgc2Vzc2lvbklkKSxcbiAgICBKU09OLnN0cmluZ2lmeSh1cGRhdGVkU2Vzc2lvbiksXG4gICAge1xuICAgICAgZXhwaXJhdGlvblR0bDogTWF0aC5mbG9vcigoZXhwaXJlc0F0LmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMTAwMClcbiAgICB9XG4gICk7XG5cbiAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlS1ZTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0S1ZTZXNzaW9uKHNlc3Npb25JZCwgdXNlcklkKTtcbiAgaWYgKCFzZXNzaW9uKSByZXR1cm47XG5cbiAgY29uc3Qga3YgPSBhd2FpdCBnZXRLVigpO1xuXG4gIGlmICgha3YpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjb25uZWN0IHRvIEtWIHN0b3JlXCIpO1xuICB9XG5cbiAgYXdhaXQga3YuZGVsZXRlKGdldFNlc3Npb25LZXkodXNlcklkLCBzZXNzaW9uSWQpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFNlc3Npb25JZHNPZlVzZXIodXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3Qga3YgPSBhd2FpdCBnZXRLVigpO1xuXG4gIGlmICgha3YpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBjb25uZWN0IHRvIEtWIHN0b3JlXCIpO1xuICB9XG5cbiAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBrdi5saXN0KHsgcHJlZml4OiBnZXRTZXNzaW9uS2V5KHVzZXJJZCwgXCJcIikgfSk7XG5cbiAgcmV0dXJuIHNlc3Npb25zLmtleXMubWFwKChzZXNzaW9uKSA9PiAoe1xuICAgIGtleTogc2Vzc2lvbi5uYW1lLFxuICAgIGFic29sdXRlRXhwaXJhdGlvbjogc2Vzc2lvbi5leHBpcmF0aW9uID8gbmV3IERhdGUoc2Vzc2lvbi5leHBpcmF0aW9uICogMTAwMCkgOiB1bmRlZmluZWRcbiAgfSkpXG59XG5cbi8qKlxuICogVXBkYXRlIGFsbCBzZXNzaW9ucyBvZiBhIHVzZXIuIEl0IGNhbiBvbmx5IGJlIGNhbGxlZCBpbiBhIHNlcnZlciBhY3Rpb25zIGFuZCBhcGkgcm91dGVzLlxuICogQHBhcmFtIHVzZXJJZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQWxsU2Vzc2lvbnNPZlVzZXIodXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBnZXRBbGxTZXNzaW9uSWRzT2ZVc2VyKHVzZXJJZCk7XG4gIGNvbnN0IGt2ID0gYXdhaXQgZ2V0S1YoKTtcblxuICBpZiAoIWt2KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY29ubmVjdCB0byBLViBzdG9yZVwiKTtcbiAgfVxuXG4gIGNvbnN0IG5ld1VzZXJEYXRhID0gYXdhaXQgZ2V0VXNlckZyb21EQih1c2VySWQpO1xuXG4gIGlmICghbmV3VXNlckRhdGEpIHJldHVybjtcblxuICAvLyBHZXQgdXBkYXRlZCB0ZWFtcyBkYXRhIHdpdGggcGVybWlzc2lvbnNcbiAgY29uc3QgdGVhbXNXaXRoUGVybWlzc2lvbnMgPSBhd2FpdCBnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnModXNlcklkKTtcblxuICBmb3IgKGNvbnN0IHNlc3Npb25PYmogb2Ygc2Vzc2lvbnMpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQga3YuZ2V0KHNlc3Npb25PYmoua2V5KTtcbiAgICBpZiAoIXNlc3Npb24pIGNvbnRpbnVlO1xuXG4gICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb24pIGFzIEtWU2Vzc2lvbjtcblxuICAgIC8vIE9ubHkgdXBkYXRlIG5vbi1leHBpcmVkIHNlc3Npb25zXG4gICAgaWYgKHNlc3Npb25PYmouYWJzb2x1dGVFeHBpcmF0aW9uICYmIHNlc3Npb25PYmouYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKSA+IERhdGUubm93KCkpIHtcbiAgICAgIGNvbnN0IHR0bEluU2Vjb25kcyA9IE1hdGguZmxvb3IoKHNlc3Npb25PYmouYWJzb2x1dGVFeHBpcmF0aW9uLmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMTAwMCk7XG5cbiAgICAgIGF3YWl0IGt2LnB1dChcbiAgICAgICAgc2Vzc2lvbk9iai5rZXksXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAuLi5zZXNzaW9uRGF0YSxcbiAgICAgICAgICB1c2VyOiBuZXdVc2VyRGF0YSxcbiAgICAgICAgICB0ZWFtczogdGVhbXNXaXRoUGVybWlzc2lvbnMsXG4gICAgICAgIH0pLFxuICAgICAgICB7IGV4cGlyYXRpb25UdGw6IHR0bEluU2Vjb25kcyB9XG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbImdldENsb3VkZmxhcmVDb250ZXh0IiwiaGVhZGVycyIsImdldFVzZXJGcm9tREIiLCJnZXRVc2VyVGVhbXNXaXRoUGVybWlzc2lvbnMiLCJnZXRJUCIsIk1BWF9TRVNTSU9OU19QRVJfVVNFUiIsIlNFU1NJT05fUFJFRklYIiwiZ2V0U2Vzc2lvbktleSIsInVzZXJJZCIsInNlc3Npb25JZCIsIkNVUlJFTlRfU0VTU0lPTl9WRVJTSU9OIiwiZ2V0S1YiLCJlbnYiLCJORVhUX0lOQ19DQUNIRV9LViIsImNyZWF0ZUtWU2Vzc2lvbiIsImV4cGlyZXNBdCIsInVzZXIiLCJhdXRoZW50aWNhdGlvblR5cGUiLCJwYXNza2V5Q3JlZGVudGlhbElkIiwidGVhbXMiLCJjZiIsImhlYWRlcnNMaXN0Iiwia3YiLCJFcnJvciIsInNlc3Npb24iLCJpZCIsImdldFRpbWUiLCJjcmVhdGVkQXQiLCJEYXRlIiwibm93IiwiY291bnRyeSIsImNpdHkiLCJjb250aW5lbnQiLCJpcCIsInVzZXJBZ2VudCIsImdldCIsInZlcnNpb24iLCJleGlzdGluZ1Nlc3Npb25zIiwiZ2V0QWxsU2Vzc2lvbklkc09mVXNlciIsImxlbmd0aCIsInNvcnRlZFNlc3Npb25zIiwic29ydCIsImEiLCJiIiwiYWJzb2x1dGVFeHBpcmF0aW9uIiwib2xkZXN0U2Vzc2lvbktleSIsImtleSIsIm9sZGVzdFNlc3Npb25JZCIsInNwbGl0IiwiZGVsZXRlS1ZTZXNzaW9uIiwicHV0IiwiSlNPTiIsInN0cmluZ2lmeSIsImV4cGlyYXRpb25UdGwiLCJNYXRoIiwiZmxvb3IiLCJnZXRLVlNlc3Npb24iLCJzZXNzaW9uU3RyIiwicGFyc2UiLCJ1cGRhdGVkQXQiLCJsYXN0Q3JlZGl0UmVmcmVzaEF0IiwiZW1haWxWZXJpZmllZCIsInVwZGF0ZUtWU2Vzc2lvbiIsInVwZGF0ZWRVc2VyIiwidGVhbXNXaXRoUGVybWlzc2lvbnMiLCJ1cGRhdGVkU2Vzc2lvbiIsImRlbGV0ZSIsInNlc3Npb25zIiwibGlzdCIsInByZWZpeCIsImtleXMiLCJtYXAiLCJuYW1lIiwiZXhwaXJhdGlvbiIsInVuZGVmaW5lZCIsInVwZGF0ZUFsbFNlc3Npb25zT2ZVc2VyIiwibmV3VXNlckRhdGEiLCJzZXNzaW9uT2JqIiwic2Vzc2lvbkRhdGEiLCJ0dGxJblNlY29uZHMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/kv-session.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/name-initials.ts":
/*!************************************!*\
  !*** ./src/utils/name-initials.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getInitials: () => (/* binding */ getInitials)\n/* harmony export */ });\n/**\n * Generates initials from a name string\n * @param name - The full name to generate initials from\n * @param maxLength - Maximum number of initials to return (default: 2)\n * @returns The initials as a string\n */ function getInitials(name, maxLength = 2) {\n    if (!name) return \"\";\n    // Split the name into parts and filter out empty strings\n    const parts = name.split(/\\s+/).filter(Boolean);\n    // If we have no parts, return empty string\n    if (parts.length === 0) return \"\";\n    // Take the first letter of each part up to maxLength\n    const initials = parts.slice(0, maxLength).map((part)=>part[0].toUpperCase()).join(\"\");\n    return initials;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvbmFtZS1pbml0aWFscy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7O0NBS0MsR0FDTSxTQUFTQSxZQUFZQyxJQUFZLEVBQUVDLFlBQVksQ0FBQztJQUNyRCxJQUFJLENBQUNELE1BQU0sT0FBTztJQUVsQix5REFBeUQ7SUFDekQsTUFBTUUsUUFBUUYsS0FBS0csS0FBSyxDQUFDLE9BQU9DLE1BQU0sQ0FBQ0M7SUFFdkMsMkNBQTJDO0lBQzNDLElBQUlILE1BQU1JLE1BQU0sS0FBSyxHQUFHLE9BQU87SUFFL0IscURBQXFEO0lBQ3JELE1BQU1DLFdBQVdMLE1BQ2RNLEtBQUssQ0FBQyxHQUFHUCxXQUNUUSxHQUFHLENBQUNDLENBQUFBLE9BQVFBLElBQUksQ0FBQyxFQUFFLENBQUNDLFdBQVcsSUFDL0JDLElBQUksQ0FBQztJQUVSLE9BQU9MO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcemFpbnVsYWFiYWlkaW5cXERvd25sb2Fkc1xcRmluYWxQcm9qZWN0LW1haW5cXEZpbmFsUHJvamVjdC1tYWluXFxzcmNcXHV0aWxzXFxuYW1lLWluaXRpYWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2VuZXJhdGVzIGluaXRpYWxzIGZyb20gYSBuYW1lIHN0cmluZ1xuICogQHBhcmFtIG5hbWUgLSBUaGUgZnVsbCBuYW1lIHRvIGdlbmVyYXRlIGluaXRpYWxzIGZyb21cbiAqIEBwYXJhbSBtYXhMZW5ndGggLSBNYXhpbXVtIG51bWJlciBvZiBpbml0aWFscyB0byByZXR1cm4gKGRlZmF1bHQ6IDIpXG4gKiBAcmV0dXJucyBUaGUgaW5pdGlhbHMgYXMgYSBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEluaXRpYWxzKG5hbWU6IHN0cmluZywgbWF4TGVuZ3RoID0gMik6IHN0cmluZyB7XG4gIGlmICghbmFtZSkgcmV0dXJuIFwiXCJcblxuICAvLyBTcGxpdCB0aGUgbmFtZSBpbnRvIHBhcnRzIGFuZCBmaWx0ZXIgb3V0IGVtcHR5IHN0cmluZ3NcbiAgY29uc3QgcGFydHMgPSBuYW1lLnNwbGl0KC9cXHMrLykuZmlsdGVyKEJvb2xlYW4pXG5cbiAgLy8gSWYgd2UgaGF2ZSBubyBwYXJ0cywgcmV0dXJuIGVtcHR5IHN0cmluZ1xuICBpZiAocGFydHMubGVuZ3RoID09PSAwKSByZXR1cm4gXCJcIlxuXG4gIC8vIFRha2UgdGhlIGZpcnN0IGxldHRlciBvZiBlYWNoIHBhcnQgdXAgdG8gbWF4TGVuZ3RoXG4gIGNvbnN0IGluaXRpYWxzID0gcGFydHNcbiAgICAuc2xpY2UoMCwgbWF4TGVuZ3RoKVxuICAgIC5tYXAocGFydCA9PiBwYXJ0WzBdLnRvVXBwZXJDYXNlKCkpXG4gICAgLmpvaW4oXCJcIilcblxuICByZXR1cm4gaW5pdGlhbHNcbn1cbiJdLCJuYW1lcyI6WyJnZXRJbml0aWFscyIsIm5hbWUiLCJtYXhMZW5ndGgiLCJwYXJ0cyIsInNwbGl0IiwiZmlsdGVyIiwiQm9vbGVhbiIsImxlbmd0aCIsImluaXRpYWxzIiwic2xpY2UiLCJtYXAiLCJwYXJ0IiwidG9VcHBlckNhc2UiLCJqb2luIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/name-initials.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod","vendor-chunks/drizzle-orm","vendor-chunks/zsa","vendor-chunks/@noble","vendor-chunks/@opennextjs","vendor-chunks/@oslojs","vendor-chunks/@paralleldrive","vendor-chunks/ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fget-session%2Froute&page=%2Fapi%2Fget-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fget-session%2Froute.ts&appDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Czainulaabaidin%5CDownloads%5CFinalProject-main%5CFinalProject-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();